/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Component, EventEmitter, Input, Output } from '@angular/core';
import { Transition, TransitionController, TransitionDirection } from '../../../modules/transition/internal';
import { MessageConfig } from '../classes/message-config';
/**
 * @record
 */
export function IMessage() { }
if (false) {
    /**
     * @return {?}
     */
    IMessage.prototype.dismiss = function () { };
}
export class FuiMessage {
    constructor() {
        /** @type {?} */
        const config = new MessageConfig('');
        this.loadConfig(config);
        this.isDynamic = false;
        this.transitionOutDuration = 300;
        this.timeoutProgress = 100;
        this.transitionController = new TransitionController(false);
        this.show();
    }
    /**
     * @return {?}
     */
    get dynamicClasses() {
        /** @type {?} */
        const classes = {};
        classes[this.state] = true;
        if (this.isDynamic && this.hasProgress) {
            classes.attached = true;
        }
        (this.classes || '')
            .split(' ')
            .forEach((/**
         * @param {?} c
         * @return {?}
         */
        c => classes[c] = true));
        return classes;
    }
    /**
     * @param {?} config
     * @return {?}
     */
    loadConfig(config) {
        this.isDynamic = true;
        this.text = config.text;
        this.header = config.header;
        this.state = config.state;
        this.timeout = config.timeout;
        this.extendedTimeout = config.extendedTimeout;
        this.hasDismissButton = config.hasDismissButton;
        this.hasProgress = config.hasProgress;
        this.transition = config.transition;
        this.transitionInDuration = config.transitionInDuration;
        this.transitionOutDuration = config.transitionOutDuration;
        this.onClick = config.onClick;
        this.onDismiss = config.onDismiss;
    }
    /**
     * @return {?}
     */
    show() {
        this.transitionController.stopAll();
        this.transitionController.animate(new Transition(this.transition, this.isDynamic ? this.transitionInDuration : 0, TransitionDirection.In, (/**
         * @return {?}
         */
        () => {
            if (this.isDynamic) {
                this.beginTimer(this.timeout);
            }
        })));
    }
    /**
     * @return {?}
     */
    dismiss() {
        this.isDismissing = true;
        this.transitionOutDuration = this.transitionInDuration;
        this.hide();
    }
    /**
     * @return {?}
     */
    hide() {
        this.isClosing = true;
        this.transitionController.stopAll();
        this.transitionController.animate(new Transition(this.transition, this.transitionOutDuration, TransitionDirection.Out, (/**
         * @return {?}
         */
        () => {
            this.isClosing = false;
            this.onDismiss.emit();
        })));
    }
    /**
     * @param {?} timeout
     * @return {?}
     */
    beginTimer(timeout) {
        if (this.isDynamic && !this.isDismissing) {
            this.timeoutProgress = 0;
            this.currentTimeout = timeout;
            this._displayTimeout = window.setTimeout((/**
             * @return {?}
             */
            () => this.onTimedOut()), timeout);
        }
    }
    /**
     * @return {?}
     */
    cancelTimer() {
        if (this.isDynamic && !this.isDismissing) {
            this.timeoutProgress = 100;
            this.currentTimeout = 0;
            clearTimeout(this._displayTimeout);
            if (this.isClosing) {
                this.isClosing = false;
                this.transitionController.cancel();
            }
        }
    }
    /**
     * @param {?} e
     * @return {?}
     */
    onClicked(e) {
        if (!e.eventHandled) {
            this.cancelTimer();
            this.onClick.emit();
        }
    }
    /**
     * @param {?} e
     * @return {?}
     */
    onDismissClicked(e) {
        e.eventHandled = true;
        this.dismiss();
    }
    /**
     * @private
     * @return {?}
     */
    onTimedOut() {
        this.hide();
    }
}
FuiMessage.decorators = [
    { type: Component, args: [{
                selector: 'fui-message',
                template: `
<div [fuiTransition]="transitionController">
    <div class="ui message"
         [ngClass]="dynamicClasses"
         (mousemove)="cancelTimer()"
         (mouseleave)="beginTimer(extendedTimeout)"
         (click)="onClicked($event)">
        <i class="close icon" *ngIf="hasDismissButton" (click)="onDismissClicked($event)"></i>
        <ng-content></ng-content>
        <ng-container *ngIf="isDynamic">
            <div class="header" *ngIf="header">{{ header }}</div>
            <p>{{ text }}</p>
        </ng-container>
    </div>
    <fui-progress *ngIf="isDynamic && hasProgress"
                  class="bottom attached"
                  [value]="timeoutProgress"
                  [autoSuccess]="false"
                  transition="linear"
                  [transitionDuration]="currentTimeout"
                  [canCompletelyEmpty]="true"></fui-progress>
</div>
`
            }] }
];
/** @nocollapse */
FuiMessage.ctorParameters = () => [];
FuiMessage.propDecorators = {
    hasDismissButton: [{ type: Input }],
    transition: [{ type: Input }],
    transitionOutDuration: [{ type: Input, args: ['transitionDuration',] }],
    onClick: [{ type: Output, args: ['click',] }],
    onDismiss: [{ type: Output, args: ['dismiss',] }],
    classes: [{ type: Input, args: ['class',] }]
};
if (false) {
    /** @type {?} */
    FuiMessage.prototype.isDynamic;
    /** @type {?} */
    FuiMessage.prototype.isClosing;
    /** @type {?} */
    FuiMessage.prototype.isDismissing;
    /** @type {?} */
    FuiMessage.prototype.text;
    /** @type {?} */
    FuiMessage.prototype.header;
    /** @type {?} */
    FuiMessage.prototype.state;
    /** @type {?} */
    FuiMessage.prototype.timeout;
    /** @type {?} */
    FuiMessage.prototype.extendedTimeout;
    /** @type {?} */
    FuiMessage.prototype.currentTimeout;
    /** @type {?} */
    FuiMessage.prototype.hasDismissButton;
    /** @type {?} */
    FuiMessage.prototype.hasProgress;
    /** @type {?} */
    FuiMessage.prototype.timeoutProgress;
    /** @type {?} */
    FuiMessage.prototype.transitionController;
    /** @type {?} */
    FuiMessage.prototype.transition;
    /** @type {?} */
    FuiMessage.prototype.transitionInDuration;
    /** @type {?} */
    FuiMessage.prototype.transitionOutDuration;
    /** @type {?} */
    FuiMessage.prototype.onClick;
    /** @type {?} */
    FuiMessage.prototype.onDismiss;
    /** @type {?} */
    FuiMessage.prototype.classes;
    /**
     * @type {?}
     * @private
     */
    FuiMessage.prototype._displayTimeout;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWVzc2FnZS5qcyIsInNvdXJjZVJvb3QiOiJuZzovL25neC1mb21hbnRpYy11aS8iLCJzb3VyY2VzIjpbImNvbGxlY3Rpb25zL21lc3NhZ2UvY29tcG9uZW50cy9tZXNzYWdlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7QUFBQSxPQUFPLEVBQUMsU0FBUyxFQUFFLFlBQVksRUFBRSxLQUFLLEVBQUUsTUFBTSxFQUFDLE1BQU0sZUFBZSxDQUFDO0FBQ3JFLE9BQU8sRUFBQyxVQUFVLEVBQUUsb0JBQW9CLEVBQUUsbUJBQW1CLEVBQUMsTUFBTSxzQ0FBc0MsQ0FBQztBQUUzRyxPQUFPLEVBQUMsYUFBYSxFQUFlLE1BQU0sMkJBQTJCLENBQUM7Ozs7QUFFdEUsOEJBRUM7Ozs7O0lBREMsNkNBQWdCOztBQTZCbEIsTUFBTSxPQUFPLFVBQVU7SUFvQ3JCOztjQUNRLE1BQU0sR0FBRyxJQUFJLGFBQWEsQ0FBQyxFQUFFLENBQUM7UUFDcEMsSUFBSSxDQUFDLFVBQVUsQ0FBQyxNQUFNLENBQUMsQ0FBQztRQUV4QixJQUFJLENBQUMsU0FBUyxHQUFHLEtBQUssQ0FBQztRQUN2QixJQUFJLENBQUMscUJBQXFCLEdBQUcsR0FBRyxDQUFDO1FBQ2pDLElBQUksQ0FBQyxlQUFlLEdBQUcsR0FBRyxDQUFDO1FBRTNCLElBQUksQ0FBQyxvQkFBb0IsR0FBRyxJQUFJLG9CQUFvQixDQUFDLEtBQUssQ0FBQyxDQUFDO1FBRTVELElBQUksQ0FBQyxJQUFJLEVBQUUsQ0FBQztJQUNkLENBQUM7Ozs7SUFFRCxJQUFXLGNBQWM7O2NBQ2pCLE9BQU8sR0FBb0IsRUFBRTtRQUNuQyxPQUFPLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxHQUFHLElBQUksQ0FBQztRQUUzQixJQUFJLElBQUksQ0FBQyxTQUFTLElBQUksSUFBSSxDQUFDLFdBQVcsRUFBRTtZQUN0QyxPQUFPLENBQUMsUUFBUSxHQUFHLElBQUksQ0FBQztTQUN6QjtRQUVELENBQUMsSUFBSSxDQUFDLE9BQU8sSUFB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QUssU0FBQyxPQUFPOzs7O0lBL0JkLCtCQUEwQjs7SUFDMUIsK0JBQTBCOztJQUMxQixrQ0FBNkI7O0lBRTdCLDBCQUFvQjs7SUFDcEIsNEJBQXVCOztJQUN2QiwyQkFBMkI7O0lBRTNCLDZCQUF1Qjs7SUFDdkIscUNBQStCOztJQUMvQixvQ0FBOEI7O0lBRTlCLHNDQUNpQzs7SUFFakMsaUNBQTRCOztJQUU1QixxQ0FBK0I7O0lBRS9CLDBDQUFrRDs7SUFFbEQsZ0NBQzBCOztJQUMxQiwwQ0FBb0M7O0lBRXBDLDJDQUNxQzs7SUFDckMsNkJBQ21DOztJQUNuQywrQkFDcUM7O0lBQ3JDLDZCQUN1Qjs7Ozs7SUFDdkIscUNBQWdDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtDb21wb25lbnQsIEV2ZW50RW1pdHRlciwgSW5wdXQsIE91dHB1dH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XHJcbmltcG9ydCB7VHJhbnNpdGlvbiwgVHJhbnNpdGlvbkNvbnRyb2xsZXIsIFRyYW5zaXRpb25EaXJlY3Rpb259IGZyb20gJy4uLy4uLy4uL21vZHVsZXMvdHJhbnNpdGlvbi9pbnRlcm5hbCc7XHJcbmltcG9ydCB7SGFuZGxlZEV2ZW50LCBJRHluYW1pY0NsYXNzZXN9IGZyb20gJy4uLy4uLy4uL21pc2MvdXRpbC9pbnRlcm5hbCc7XHJcbmltcG9ydCB7TWVzc2FnZUNvbmZpZywgTWVzc2FnZVN0YXRlfSBmcm9tICcuLi9jbGFzc2VzL21lc3NhZ2UtY29uZmlnJztcclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgSU1lc3NhZ2Uge1xyXG4gIGRpc21pc3MoKTogdm9pZDtcclxufVxyXG5cclxuQENvbXBvbmVudCh7XHJcbiAgc2VsZWN0b3I6ICdmdWktbWVzc2FnZScsXHJcbiAgdGVtcGxhdGU6IGBcclxuPGRpdiBbZnVpVHJhbnNpdGlvbl09XCJ0cmFuc2l0aW9uQ29udHJvbGxlclwiPlxyXG4gICAgPGRpdiBjbGFzcz1cInVpIG1lc3NhZ2VcIlxyXG4gICAgICAgICBbbmdDbGFzc109XCJkeW5hbWljQ2xhc3Nlc1wiXHJcbiAgICAgICAgIChtb3VzZW1vdmUpPVwiY2FuY2VsVGltZXIoKVwiXHJcbiAgICAgICAgIChtb3VzZWxlYXZlKT1cImJlZ2luVGltZXIoZXh0ZW5kZWRUaW1lb3V0KVwiXHJcbiAgICAgICAgIChjbGljayk9XCJvbkNsaWNrZWQoJGV2ZW50KVwiPlxyXG4gICAgICAgIDxpIGNsYXNzPVwiY2xvc2UgaWNvblwiICpuZ0lmPVwiaGFzRGlzbWlzc0J1dHRvblwiIChjbGljayk9XCJvbkRpc21pc3NDbGlja2VkKCRldmVudClcIj48L2k+XHJcbiAgICAgICAgPG5nLWNvbnRlbnQ+PC9uZy1jb250ZW50PlxyXG4gICAgICAgIDxuZy1jb250YWluZXIgKm5nSWY9XCJpc0R5bmFtaWNcIj5cclxuICAgICAgICAgICAgPGRpdiBjbGFzcz1cImhlYWRlclwiICpuZ0lmPVwiaGVhZGVyXCI+e3sgaGVhZGVyIH19PC9kaXY+XHJcbiAgICAgICAgICAgIDxwPnt7IHRleHQgfX08L3A+XHJcbiAgICAgICAgPC9uZy1jb250YWluZXI+XHJcbiAgICA8L2Rpdj5cclxuICAgIDxmdWktcHJvZ3Jlc3MgKm5nSWY9XCJpc0R5bmFtaWMgJiYgaGFzUHJvZ3Jlc3NcIlxyXG4gICAgICAgICAgICAgICAgICBjbGFzcz1cImJvdHRvbSBhdHRhY2hlZFwiXHJcbiAgICAgICAgICAgICAgICAgIFt2YWx1ZV09XCJ0aW1lb3V0UHJvZ3Jlc3NcIlxyXG4gICAgICAgICAgICAgICAgICBbYXV0b1N1Y2Nlc3NdPVwiZmFsc2VcIlxyXG4gICAgICAgICAgICAgICAgICB0cmFuc2l0aW9uPVwibGluZWFyXCJcclxuICAgICAgICAgICAgICAgICAgW3RyYW5zaXRpb25EdXJhdGlvbl09XCJjdXJyZW50VGltZW91dFwiXHJcbiAgICAgICAgICAgICAgICAgIFtjYW5Db21wbGV0ZWx5RW1wdHldPVwidHJ1ZVwiPjwvZnVpLXByb2dyZXNzPlxyXG48L2Rpdj5cclxuYFxyXG59KVxyXG5leHBvcnQgY2xhc3MgRnVpTWVzc2FnZSBpbXBsZW1lbnRzIElNZXNzYWdlIHtcclxuICBwdWJsaWMgaXNEeW5hbWljOiBib29sZWFuO1xyXG4gIHB1YmxpYyBpc0Nsb3Npbmc6IGJvb2xlYW47XHJcbiAgcHVibGljIGlzRGlzbWlzc2luZzogYm9vbGVhbjtcclxuXHJcbiAgcHVibGljIHRleHQ6IHN0cmluZztcclxuICBwdWJsaWMgaGVhZGVyPzogc3RyaW5nO1xyXG4gIHB1YmxpYyBzdGF0ZTogTWVzc2FnZVN0YXRlO1xyXG5cclxuICBwdWJsaWMgdGltZW91dDogbnVtYmVyO1xyXG4gIHB1YmxpYyBleHRlbmRlZFRpbWVvdXQ6IG51bWJlcjtcclxuICBwdWJsaWMgY3VycmVudFRpbWVvdXQ6IG51bWJlcjtcclxuXHJcbiAgQElucHV0KClcclxuICBwdWJsaWMgaGFzRGlzbWlzc0J1dHRvbjogYm9vbGVhbjtcclxuXHJcbiAgcHVibGljIGhhc1Byb2dyZXNzOiBib29sZWFuO1xyXG5cclxuICBwdWJsaWMgdGltZW91dFByb2dyZXNzOiBudW1iZXI7XHJcblxyXG4gIHB1YmxpYyB0cmFuc2l0aW9uQ29udHJvbGxlcjogVHJhbnNpdGlvbkNvbnRyb2xsZXI7XHJcblxyXG4gIEBJbnB1dCgpXHJcbiAgcHVibGljIHRyYW5zaXRpb246IHN0cmluZztcclxuICBwdWJsaWMgdHJhbnNpdGlvbkluRHVyYXRpb246IG51bWJlcjtcclxuXHJcbiAgQElucHV0KCd0cmFuc2l0aW9uRHVyYXRpb24nKVxyXG4gIHB1YmxpYyB0cmFuc2l0aW9uT3V0RHVyYXRpb246IG51bWJlcjtcclxuICBAT3V0cHV0KCdjbGljaycpXHJcbiAgcHVibGljIG9uQ2xpY2s6IEV2ZW50RW1pdHRlcjx2b2lkPjtcclxuICBAT3V0cHV0KCdkaXNtaXNzJylcclxuICBwdWJsaWMgb25EaXNtaXNzOiBFdmVudEVtaXR0ZXI8dm9pZD47XHJcbiAgQElucHV0KCdjbGFzcycpXHJcbiAgcHVibGljIGNsYXNzZXM6IHN0cmluZztcclxuICBwcml2YXRlIF9kaXNwbGF5VGltZW91dDogbnVtYmVyO1xyXG5cclxuICBjb25zdHJ1Y3RvcigpIHtcclxuICAgIGNvbnN0IGNvbmZpZyA9IG5ldyBNZXNzYWdlQ29uZmlnKCcnKTtcclxuICAgIHRoaXMubG9hZENvbmZpZyhjb25maWcpO1xyXG5cclxuICAgIHRoaXMuaXNEeW5hbWljID0gZmFsc2U7XHJcbiAgICB0aGlzLnRyYW5zaXRpb25PdXREdXJhdGlvbiA9IDMwMDtcclxuICAgIHRoaXMudGltZW91dFByb2dyZXNzID0gMTAwO1xyXG5cclxuICAgIHRoaXMudHJhbnNpdGlvbkNvbnRyb2xsZXIgPSBuZXcgVHJhbnNpdGlvbkNvbnRyb2xsZXIoZmFsc2UpO1xyXG5cclxuICAgIHRoaXMuc2hvdygpO1xyXG4gIH1cclxuXHJcbiAgcHVibGljIGdldCBkeW5hbWljQ2xhc3NlcygpOiBJRHluYW1pY0NsYXNzZXMge1xyXG4gICAgY29uc3QgY2xhc3NlczogSUR5bmFtaWNDbGFzc2VzID0ge307XHJcbiAgICBjbGFzc2VzW3RoaXMuc3RhdGVdID0gdHJ1ZTtcclxuXHJcbiAgICBpZiAodGhpcy5pc0R5bmFtaWMgJiYgdGhpcy5oYXNQcm9ncmVzcykge1xyXG4gICAgICBjbGFzc2VzLmF0dGFjaGVkID0gdHJ1ZTtcclxuICAgIH1cclxuXHJcbiAgICAodGhpcy5jbGFzc2VzIHx8ICcnKVxyXG4gICAgICAuc3BsaXQoJyAnKVxyXG4gICAgICAuZm9yRWFjaChjID0+IGNsYXNzZXNbY10gPSB0cnVlKTtcclxuXHJcbiAgICByZXR1cm4gY2xhc3NlcztcclxuICB9XHJcblxyXG4gIHB1YmxpYyBsb2FkQ29uZmlnKGNvbmZpZzogTWVzc2FnZUNvbmZpZyk6IHZvaWQge1xyXG4gICAgdGhpcy5pc0R5bmFtaWMgPSB0cnVlO1xyXG5cclxuICAgIHRoaXMudGV4dCA9IGNvbmZpZy50ZXh0O1xyXG4gICAgdGhpcy5oZWFkZXIgPSBjb25maWcuaGVhZGVyO1xyXG4gICAgdGhpcy5zdGF0ZSA9IGNvbmZpZy5zdGF0ZTtcclxuXHJcbiAgICB0aGlzLnRpbWVvdXQgPSBjb25maWcudGltZW91dDtcclxuICAgIHRoaXMuZXh0ZW5kZWRUaW1lb3V0ID0gY29uZmlnLmV4dGVuZGVkVGltZW91dDtcclxuXHJcbiAgICB0aGlzLmhhc0Rpc21pc3NCdXR0b24gPSBjb25maWcuaGFzRGlzbWlzc0J1dHRvbjtcclxuICAgIHRoaXMuaGFzUHJvZ3Jlc3MgPSBjb25maWcuaGFzUHJvZ3Jlc3M7XHJcblxyXG4gICAgdGhpcy50cmFuc2l0aW9uID0gY29uZmlnLnRyYW5zaXRpb247XHJcbiAgICB0aGlzLnRyYW5zaXRpb25JbkR1cmF0aW9uID0gY29uZmlnLnRyYW5zaXRpb25JbkR1cmF0aW9uO1xyXG4gICAgdGhpcy50cmFuc2l0aW9uT3V0RHVyYXRpb24gPSBjb25maWcudHJhbnNpdGlvbk91dER1cmF0aW9uO1xyXG5cclxuICAgIHRoaXMub25DbGljayA9IGNvbmZpZy5vbkNsaWNrO1xyXG4gICAgdGhpcy5vbkRpc21pc3MgPSBjb25maWcub25EaXNtaXNzO1xyXG4gIH1cclxuXHJcbiAgcHVibGljIHNob3coKTogdm9pZCB7XHJcbiAgICB0aGlzLnRyYW5zaXRpb25Db250cm9sbGVyLnN0b3BBbGwoKTtcclxuICAgIHRoaXMudHJhbnNpdGlvbkNvbnRyb2xsZXIuYW5pbWF0ZShcclxuICAgICAgbmV3IFRyYW5zaXRpb24oXHJcbiAgICAgICAgdGhpcy50cmFuc2l0aW9uLFxyXG4gICAgICAgIHRoaXMuaXNEeW5hbWljID8gdGhpcy50cmFuc2l0aW9uSW5EdXJhdGlvbiA6IDAsXHJcbiAgICAgICAgVHJhbnNpdGlvbkRpcmVjdGlvbi5JbixcclxuICAgICAgICAoKSA9PiB7XHJcbiAgICAgICAgICBpZiAodGhpcy5pc0R5bmFtaWMpIHtcclxuICAgICAgICAgICAgdGhpcy5iZWdpblRpbWVyKHRoaXMudGltZW91dCk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSkpO1xyXG4gIH1cclxuXHJcbiAgcHVibGljIGRpc21pc3MoKTogdm9pZCB7XHJcbiAgICB0aGlzLmlzRGlzbWlzc2luZyA9IHRydWU7XHJcbiAgICB0aGlzLnRyYW5zaXRpb25PdXREdXJhdGlvbiA9IHRoaXMudHJhbnNpdGlvbkluRHVyYXRpb247XHJcblxyXG4gICAgdGhpcy5oaWRlKCk7XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgaGlkZSgpOiB2b2lkIHtcclxuICAgIHRoaXMuaXNDbG9zaW5nID0gdHJ1ZTtcclxuXHJcbiAgICB0aGlzLnRyYW5zaXRpb25Db250cm9sbGVyLnN0b3BBbGwoKTtcclxuICAgIHRoaXMudHJhbnNpdGlvbkNvbnRyb2xsZXIuYW5pbWF0ZShcclxuICAgICAgbmV3IFRyYW5zaXRpb24oXHJcbiAgICAgICAgdGhpcy50cmFuc2l0aW9uLFxyXG4gICAgICAgIHRoaXMudHJhbnNpdGlvbk91dER1cmF0aW9uLFxyXG4gICAgICAgIFRyYW5zaXRpb25EaXJlY3Rpb24uT3V0LFxyXG4gICAgICAgICgpID0+IHtcclxuICAgICAgICAgIHRoaXMuaXNDbG9zaW5nID0gZmFsc2U7XHJcbiAgICAgICAgICB0aGlzLm9uRGlzbWlzcy5lbWl0KCk7XHJcbiAgICAgICAgfSkpO1xyXG4gIH1cclxuXHJcbiAgcHVibGljIGJlZ2luVGltZXIodGltZW91dDogbnVtYmVyKTogdm9pZCB7XHJcbiAgICBpZiAodGhpcy5pc0R5bmFtaWMgJiYgIXRoaXMuaXNEaXNtaXNzaW5nKSB7XHJcbiAgICAgIHRoaXMudGltZW91dFByb2dyZXNzID0gMDtcclxuICAgICAgdGhpcy5jdXJyZW50VGltZW91dCA9IHRpbWVvdXQ7XHJcbiAgICAgIHRoaXMuX2Rpc3BsYXlUaW1lb3V0ID0gd2luZG93LnNldFRpbWVvdXQoKCkgPT4gdGhpcy5vblRpbWVkT3V0KCksIHRpbWVvdXQpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcHVibGljIGNhbmNlbFRpbWVyKCk6IHZvaWQge1xyXG4gICAgaWYgKHRoaXMuaXNEeW5hbWljICYmICF0aGlzLmlzRGlzbWlzc2luZykge1xyXG4gICAgICB0aGlzLnRpbWVvdXRQcm9ncmVzcyA9IDEwMDtcclxuICAgICAgdGhpcy5jdXJyZW50VGltZW91dCA9IDA7XHJcbiAgICAgIGNsZWFyVGltZW91dCh0aGlzLl9kaXNwbGF5VGltZW91dCk7XHJcblxyXG4gICAgICBpZiAodGhpcy5pc0Nsb3NpbmcpIHtcclxuICAgICAgICB0aGlzLmlzQ2xvc2luZyA9IGZhbHNlO1xyXG5cclxuICAgICAgICB0aGlzLnRyYW5zaXRpb25Db250cm9sbGVyLmNhbmNlbCgpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgb25DbGlja2VkKGU6IEhhbmRsZWRFdmVudCk6IHZvaWQge1xyXG4gICAgaWYgKCFlLmV2ZW50SGFuZGxlZCkge1xyXG4gICAgICB0aGlzLmNhbmNlbFRpbWVyKCk7XHJcbiAgICAgIHRoaXMub25DbGljay5lbWl0KCk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgb25EaXNtaXNzQ2xpY2tlZChlOiBIYW5kbGVkRXZlbnQpOiB2b2lkIHtcclxuICAgIGUuZXZlbnRIYW5kbGVkID0gdHJ1ZTtcclxuICAgIHRoaXMuZGlzbWlzcygpO1xyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBvblRpbWVkT3V0KCk6IHZvaWQge1xyXG4gICAgdGhpcy5oaWRlKCk7XHJcbiAgfVxyXG59XHJcbiJdfQ==