{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{lKKO:function(module,__webpack_exports__,__webpack_require__){\"use strict\";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,\"AccountModule\",(function(){return account_module_AccountModule}));var common=__webpack_require__(\"ofXK\"),fesm2015_router=__webpack_require__(\"tyNb\"),scavenger=__webpack_require__(\"+0XT\"),differenceInHours=__webpack_require__(\"moCM\"),parseISO=__webpack_require__(\"4+6U\"),isAfter=__webpack_require__(\"EhJz\"),moment=__webpack_require__(\"wd/R\"),fesm2015_dialog=__webpack_require__(\"0IaG\"),Country_json=__webpack_require__(\"MsxN\"),index_es6=__webpack_require__(\"PoRY\"),sweetalert2_all=__webpack_require__(\"PSD3\"),sweetalert2_all_default=__webpack_require__.n(sweetalert2_all),retry=__webpack_require__(\"un/a\"),humanize=__webpack_require__(\"MlvY\"),core=__webpack_require__(\"fXoL\"),event_service=__webpack_require__(\"gcxx\"),url_config=__webpack_require__(\"QnqH\"),cookies_service=__webpack_require__(\"jzuh\"),fesm2015_http=__webpack_require__(\"tk/3\");let sharing_service_SharingService=(()=>{class SharingService{constructor(cookieService,http){this.cookieService=cookieService,this.http=http,this.url=new url_config.a}doSharing(item,type,dialCode){return this.http.post(`${this.url.mainHost}/tickets/${type}/sharing`,item,{params:{username:this.getUsername(),dial:dialCode},observe:\"response\"})}getSharing(id,type){return this.http.get(`${this.url.mainHost}/tickets/${type}/sharing/${id}`,{params:{username:this.getUsername()}})}revokeTicket(id,type){return this.http.get(`${this.url.mainHost}/tickets/${type}/sharing/${id}/revoke`,{params:{username:this.getUsername()},observe:\"response\"})}attributeTicket(type,id){return this.http.post(`${this.url.mainHost}/tickets/${type}/sharing/${id}/attribute`,null,{params:{username:this.getUsername()},observe:\"response\"})}getUsername(){return this.cookieService.getCookie(\"last_email\")}}return SharingService.ɵfac=function(t){return new(t||SharingService)(core.mc(cookies_service.a),core.mc(fesm2015_http.b))},SharingService.ɵprov=core.Ub({token:SharingService,factory:SharingService.ɵfac,providedIn:\"root\"}),SharingService})();var global_error_handler_service=__webpack_require__(\"AXpb\"),fesm2015_forms=__webpack_require__(\"3Pt+\");function DetailsTicketComponent_div_7_tr_8_Template(rf,ctx){if(1&rf&&(core.ec(0,\"tr\"),core.ec(1,\"td\",14),core.cd(2,\"Prénom:\"),core.dc(),core.ec(3,\"td\"),core.cd(4),core.uc(5,\"titlecase\"),core.dc(),core.dc()),2&rf){const ctx_r8=core.tc(2);core.Kb(4),core.dd(core.vc(5,1,ctx_r8.sharedTo.firstName))}}function DetailsTicketComponent_div_7_tr_9_Template(rf,ctx){if(1&rf&&(core.ec(0,\"tr\"),core.ec(1,\"td\",14),core.cd(2,\"Nom:\"),core.dc(),core.ec(3,\"td\"),core.cd(4),core.uc(5,\"titlecase\"),core.dc(),core.dc()),2&rf){const ctx_r9=core.tc(2);core.Kb(4),core.dd(core.vc(5,1,ctx_r9.sharedTo.lastName))}}function DetailsTicketComponent_div_7_tr_10_Template(rf,ctx){if(1&rf&&(core.ec(0,\"tr\"),core.ec(1,\"td\",14),core.cd(2,\"Téléphone:\"),core.dc(),core.ec(3,\"td\"),core.cd(4),core.dc(),core.dc()),2&rf){const ctx_r10=core.tc(2);core.Kb(4),core.dd(ctx_r10.sharedTo.telephone)}}function DetailsTicketComponent_div_7_tr_11_Template(rf,ctx){if(1&rf&&(core.ec(0,\"tr\"),core.ec(1,\"td\",14),core.cd(2,\"Classe:\"),core.dc(),core.ec(3,\"td\"),core.cd(4),core.dc(),core.dc()),2&rf){const ctx_r11=core.tc(2);core.Kb(4),core.dd(ctx_r11.item.type)}}function DetailsTicketComponent_div_7_tr_12_Template(rf,ctx){if(1&rf&&(core.ec(0,\"tr\"),core.ec(1,\"td\",14),core.cd(2,\"Type d'événement:\"),core.dc(),core.ec(3,\"td\"),core.cd(4),core.uc(5,\"titlecase\"),core.dc(),core.dc()),2&rf){const ctx_r12=core.tc(2);core.Kb(4),core.dd(core.vc(5,1,ctx_r12.event.eventType))}}function DetailsTicketComponent_div_7_tr_13_Template(rf,ctx){if(1&rf&&(core.ec(0,\"tr\"),core.ec(1,\"td\",14),core.cd(2,\"Désignation:\"),core.dc(),core.ec(3,\"td\"),core.cd(4),core.dc(),core.dc()),2&rf){const ctx_r13=core.tc(2);core.Kb(4),core.dd(ctx_r13.event.designation)}}function DetailsTicketComponent_div_7_tr_14_Template(rf,ctx){if(1&rf&&(core.ec(0,\"tr\"),core.ec(1,\"td\",14),core.cd(2,\"Début:\"),core.dc(),core.ec(3,\"td\"),core.cd(4),core.uc(5,\"date\"),core.dc(),core.dc()),2&rf){const ctx_r14=core.tc(2);core.Kb(4),core.fd(\"\",core.xc(5,2,ctx_r14.item.startingDate,\"dd MMMM yyyy\",\"UTC\"),\" á \",ctx_r14.event.startingTime,\"\")}}function DetailsTicketComponent_div_7_tr_15_Template(rf,ctx){if(1&rf&&(core.ec(0,\"tr\"),core.ec(1,\"td\",14),core.cd(2,\"Fin:\"),core.dc(),core.ec(3,\"td\"),core.cd(4),core.uc(5,\"date\"),core.dc(),core.dc()),2&rf){const ctx_r15=core.tc(2);core.Kb(4),core.fd(\"\",core.xc(5,2,ctx_r15.item.endingDate,\"dd MMMM yyyy\",\"UTC\"),\" á \",ctx_r15.event.endingTime,\"\")}}function DetailsTicketComponent_div_7_tr_16_Template(rf,ctx){if(1&rf&&(core.ec(0,\"tr\"),core.ec(1,\"td\",14),core.cd(2,\"Type transport:\"),core.dc(),core.ec(3,\"td\"),core.cd(4),core.uc(5,\"titlecase\"),core.dc(),core.dc()),2&rf){const ctx_r16=core.tc(2);core.Kb(4),core.fd(\"\",ctx_r16.item.transportType+\": \",\"\",core.vc(5,2,ctx_r16.item.transportName),\"\")}}function DetailsTicketComponent_div_7_tr_17_Template(rf,ctx){if(1&rf&&(core.ec(0,\"tr\"),core.ec(1,\"td\",14),core.cd(2,\"Date:\"),core.dc(),core.ec(3,\"td\"),core.cd(4),core.uc(5,\"titlecase\"),core.uc(6,\"date\"),core.dc(),core.dc()),2&rf){const ctx_r17=core.tc(2);core.Kb(4),core.fd(\"\",core.vc(5,2,core.xc(6,4,ctx_r17.item.departDate,\"dd MMMM yyyy\",\"UTC\")),\" á \",ctx_r17.item.departTime,\"\")}}function DetailsTicketComponent_div_7_tr_18_Template(rf,ctx){if(1&rf&&(core.ec(0,\"tr\"),core.ec(1,\"td\",14),core.cd(2,\"Départ:\"),core.dc(),core.ec(3,\"td\"),core.cd(4),core.uc(5,\"titlecase\"),core.dc(),core.dc()),2&rf){const ctx_r18=core.tc(2);core.Kb(4),core.dd(core.vc(5,1,ctx_r18.item.departLocation))}}function DetailsTicketComponent_div_7_tr_19_Template(rf,ctx){if(1&rf&&(core.ec(0,\"tr\"),core.ec(1,\"td\",14),core.cd(2,\"Destination:\"),core.dc(),core.ec(3,\"td\"),core.cd(4),core.uc(5,\"titlecase\"),core.dc(),core.dc()),2&rf){const ctx_r19=core.tc(2);core.Kb(4),core.dd(core.vc(5,1,ctx_r19.item.arrivalLocation))}}function DetailsTicketComponent_div_7_tr_20_Template(rf,ctx){if(1&rf&&(core.ec(0,\"tr\"),core.ec(1,\"td\",14),core.cd(2,\"Lieu:\"),core.dc(),core.ec(3,\"td\"),core.cd(4),core.uc(5,\"titlecase\"),core.dc(),core.dc()),2&rf){const ctx_r20=core.tc(2);core.Kb(4),core.dd(core.vc(5,1,ctx_r20.event.place.designation))}}function DetailsTicketComponent_div_7_Template(rf,ctx){if(1&rf&&(core.ec(0,\"div\",12),core.ec(1,\"table\",13),core.ec(2,\"tbody\"),core.ec(3,\"tr\"),core.ec(4,\"td\",14),core.cd(5,\"Code billet:\"),core.dc(),core.ec(6,\"td\"),core.cd(7),core.dc(),core.dc(),core.ad(8,DetailsTicketComponent_div_7_tr_8_Template,6,3,\"tr\",15),core.ad(9,DetailsTicketComponent_div_7_tr_9_Template,6,3,\"tr\",15),core.ad(10,DetailsTicketComponent_div_7_tr_10_Template,5,1,\"tr\",15),core.ad(11,DetailsTicketComponent_div_7_tr_11_Template,5,1,\"tr\",15),core.ad(12,DetailsTicketComponent_div_7_tr_12_Template,6,3,\"tr\",15),core.ad(13,DetailsTicketComponent_div_7_tr_13_Template,5,1,\"tr\",15),core.ad(14,DetailsTicketComponent_div_7_tr_14_Template,6,6,\"tr\",15),core.ad(15,DetailsTicketComponent_div_7_tr_15_Template,6,6,\"tr\",15),core.ad(16,DetailsTicketComponent_div_7_tr_16_Template,6,4,\"tr\",15),core.ad(17,DetailsTicketComponent_div_7_tr_17_Template,7,8,\"tr\",15),core.ad(18,DetailsTicketComponent_div_7_tr_18_Template,6,3,\"tr\",15),core.ad(19,DetailsTicketComponent_div_7_tr_19_Template,6,3,\"tr\",15),core.ad(20,DetailsTicketComponent_div_7_tr_20_Template,6,3,\"tr\",15),core.ec(21,\"tr\"),core.ec(22,\"td\",14),core.cd(23,\"ID transaction:\"),core.dc(),core.ec(24,\"td\"),core.cd(25),core.dc(),core.dc(),core.ec(26,\"tr\"),core.ec(27,\"td\",14),core.cd(28,\"Payé avec:\"),core.dc(),core.ec(29,\"td\"),core.cd(30),core.uc(31,\"titlecase\"),core.dc(),core.dc(),core.ec(32,\"tr\"),core.ec(33,\"td\",14),core.cd(34,\"Date transaction:\"),core.dc(),core.ec(35,\"td\"),core.cd(36),core.uc(37,\"titlecase\"),core.uc(38,\"date\"),core.uc(39,\"date\"),core.dc(),core.dc(),core.ec(40,\"tr\"),core.ec(41,\"td\",14),core.cd(42,\"Prix:\"),core.dc(),core.ec(43,\"td\"),core.cd(44),core.uc(45,\"currency\"),core.dc(),core.dc(),core.dc(),core.dc(),core.dc()),2&rf){const ctx_r0=core.tc();core.Kb(7),core.dd(ctx_r0.item.isShared?\"PARTAGER\":ctx_r0.item.codeTicket),core.Kb(1),core.Cc(\"ngIf\",ctx_r0.item.isShared),core.Kb(1),core.Cc(\"ngIf\",ctx_r0.item.isShared),core.Kb(1),core.Cc(\"ngIf\",ctx_r0.item.isShared),core.Kb(1),core.Cc(\"ngIf\",\"event\"===ctx_r0.type&&void 0!==ctx_r0.event),core.Kb(1),core.Cc(\"ngIf\",\"event\"===ctx_r0.type&&void 0!==ctx_r0.event),core.Kb(1),core.Cc(\"ngIf\",\"event\"===ctx_r0.type&&void 0!==ctx_r0.event),core.Kb(1),core.Cc(\"ngIf\",\"event\"==ctx_r0.type&&void 0!==ctx_r0.event),core.Kb(1),core.Cc(\"ngIf\",\"event\"===ctx_r0.type&&void 0!==ctx_r0.event),core.Kb(1),core.Cc(\"ngIf\",\"transport\"===ctx_r0.type),core.Kb(1),core.Cc(\"ngIf\",\"transport\"===ctx_r0.type),core.Kb(1),core.Cc(\"ngIf\",\"transport\"===ctx_r0.type),core.Kb(1),core.Cc(\"ngIf\",\"transport\"===ctx_r0.type),core.Kb(1),core.Cc(\"ngIf\",\"event\"===ctx_r0.type&&void 0!==ctx_r0.event),core.Kb(5),core.dd(ctx_r0.item.transactionNumber),core.Kb(5),core.dd(null==ctx_r0.item.transactionType?\"Indéfini\":core.vc(31,19,ctx_r0.item.transactionType)),core.Kb(6),core.fd(\"\",core.vc(37,21,core.xc(38,23,ctx_r0.item.updatedAt,\"dd MMMM yyyy\",\"UTC\")),\" \",core.xc(39,27,ctx_r0.item.updatedAt,\"á HH:MM\",\"UTC\"),\"\"),core.Kb(8),core.dd(core.yc(45,31,ctx_r0.item.totalPrice,\"XOF\",\"symbol\",\"1.1-2\"))}}function DetailsTicketComponent_div_8_div_5_Template(rf,ctx){1&rf&&(core.ec(0,\"div\"),core.ec(1,\"p\",24),core.cd(2,\"Ce champ est requis\"),core.dc(),core.dc())}function DetailsTicketComponent_div_8_div_10_Template(rf,ctx){1&rf&&(core.ec(0,\"div\"),core.ec(1,\"p\",24),core.cd(2,\"Ce champ est requis\"),core.dc(),core.dc())}function DetailsTicketComponent_div_8_option_16_Template(rf,ctx){if(1&rf&&(core.ec(0,\"option\",25),core.cd(1),core.dc()),2&rf){const item_r25=ctx.$implicit;core.Cc(\"value\",item_r25.code),core.Kb(1),core.dd(item_r25.dial_code)}}function DetailsTicketComponent_div_8_div_18_p_1_Template(rf,ctx){1&rf&&(core.ec(0,\"p\",24),core.cd(1,\"Ce champ est requis\"),core.dc())}function DetailsTicketComponent_div_8_div_18_p_2_Template(rf,ctx){1&rf&&(core.ec(0,\"p\",24),core.cd(1,\"Le format de votre téléphone n'est pas valide.\"),core.dc())}function DetailsTicketComponent_div_8_div_18_Template(rf,ctx){if(1&rf&&(core.ec(0,\"div\"),core.ad(1,DetailsTicketComponent_div_8_div_18_p_1_Template,2,0,\"p\",26),core.ad(2,DetailsTicketComponent_div_8_div_18_p_2_Template,2,0,\"p\",26),core.dc()),2&rf){const ctx_r24=core.tc(2);core.Kb(1),core.Cc(\"ngIf\",ctx_r24.fieldValidity.get(\"telephone\").includes(\"required\")),core.Kb(1),core.Cc(\"ngIf\",ctx_r24.fieldValidity.get(\"telephone\").includes(\"badFormat\"))}}function DetailsTicketComponent_div_8_Template(rf,ctx){if(1&rf){const _r29=core.fc();core.ec(0,\"div\",16),core.ec(1,\"div\",17),core.ec(2,\"label\"),core.cd(3,\"Prénom\"),core.dc(),core.ec(4,\"input\",18),core.qc(\"focusin\",(function(){return core.Tc(_r29),core.tc().fieldValidity.delete(\"firstName\")}))(\"focusout\",(function(){return core.Tc(_r29),core.tc().checkFields(\"firstName\")}))(\"ngModelChange\",(function($event){return core.Tc(_r29),core.tc().sharedTo.firstName=$event})),core.dc(),core.ad(5,DetailsTicketComponent_div_8_div_5_Template,3,0,\"div\",15),core.dc(),core.ec(6,\"div\",17),core.ec(7,\"label\"),core.cd(8,\"Nom\"),core.dc(),core.ec(9,\"input\",19),core.qc(\"focusin\",(function(){return core.Tc(_r29),core.tc().fieldValidity.delete(\"lastName\")}))(\"focusout\",(function(){return core.Tc(_r29),core.tc().checkFields(\"lastName\")}))(\"ngModelChange\",(function($event){return core.Tc(_r29),core.tc().sharedTo.lastName=$event})),core.dc(),core.ad(10,DetailsTicketComponent_div_8_div_10_Template,3,0,\"div\",15),core.dc(),core.ec(11,\"div\",17),core.ec(12,\"label\"),core.cd(13,\"Téléphone\"),core.dc(),core.ec(14,\"div\",20),core.ec(15,\"select\",21),core.qc(\"ngModelChange\",(function($event){return core.Tc(_r29),core.tc().sharedTo.countryCode=$event})),core.ad(16,DetailsTicketComponent_div_8_option_16_Template,2,2,\"option\",22),core.dc(),core.ec(17,\"input\",23),core.qc(\"focusout\",(function(){return core.Tc(_r29),core.tc().checkFields(\"telephone\")}))(\"keyup\",(function(){return core.Tc(_r29),core.tc().formatNumber()}))(\"ngModelChange\",(function($event){return core.Tc(_r29),core.tc().sharedTo.telephone=$event})),core.dc(),core.dc(),core.ad(18,DetailsTicketComponent_div_8_div_18_Template,3,2,\"div\",15),core.dc(),core.dc()}if(2&rf){const ctx_r1=core.tc();core.Kb(1),core.Cc(\"ngClass\",ctx_r1.fieldValidity.has(\"firstName\")?\"error\":\"\"),core.Kb(3),core.Cc(\"ngModel\",ctx_r1.sharedTo.firstName),core.Kb(1),core.Cc(\"ngIf\",ctx_r1.fieldValidity.has(\"firstName\")),core.Kb(1),core.Cc(\"ngClass\",ctx_r1.fieldValidity.has(\"lastName\")?\"error\":\"\"),core.Kb(3),core.Cc(\"ngModel\",ctx_r1.sharedTo.lastName),core.Kb(1),core.Cc(\"ngIf\",ctx_r1.fieldValidity.has(\"lastName\")),core.Kb(1),core.Cc(\"ngClass\",ctx_r1.fieldValidity.has(\"telephone\")?\"error\":\"\"),core.Kb(4),core.Cc(\"ngModel\",ctx_r1.sharedTo.countryCode),core.Kb(1),core.Cc(\"ngForOf\",ctx_r1.countries),core.Kb(1),core.Cc(\"ngModel\",ctx_r1.sharedTo.telephone),core.Kb(1),core.Cc(\"ngIf\",ctx_r1.fieldValidity.has(\"telephone\"))}}function DetailsTicketComponent_button_10_Template(rf,ctx){1&rf&&(core.ec(0,\"button\",27),core.cd(1,\"Fermer\"),core.dc())}function DetailsTicketComponent_button_11_Template(rf,ctx){if(1&rf){const _r40=core.fc();core.ec(0,\"button\",28),core.qc(\"click\",(function(){return core.Tc(_r40),core.tc().sharing=!0})),core.cd(1,\"Partager\"),core.dc()}}function DetailsTicketComponent_button_12_Template(rf,ctx){if(1&rf){const _r42=core.fc();core.ec(0,\"button\",28),core.qc(\"click\",(function(){return core.Tc(_r42),core.tc().revokeSharing()})),core.cd(1,\" Supprimer le partage \"),core.dc()}}function DetailsTicketComponent_button_13_Template(rf,ctx){if(1&rf){const _r44=core.fc();core.ec(0,\"button\",29),core.qc(\"click\",(function(){return core.Tc(_r44),core.tc().attributeTicket()})),core.cd(1,\" Attribuer le ticket \"),core.dc()}}function DetailsTicketComponent_button_14_Template(rf,ctx){if(1&rf){const _r46=core.fc();core.ec(0,\"button\",30),core.qc(\"click\",(function(){return core.Tc(_r46),core.tc().cancelSharing()})),core.cd(1,\"Annuler\"),core.dc()}}function DetailsTicketComponent_button_15_Template(rf,ctx){if(1&rf){const _r48=core.fc();core.ec(0,\"button\",28),core.qc(\"click\",(function(){return core.Tc(_r48),core.tc().doSharing()})),core.cd(1,\"Valider\"),core.dc()}}class TicketSharing{constructor(){this.ticketId=\"\",this.firstName=\"\",this.lastName=\"\",this.telephone=\"\",this.countryCode=\"SN\"}}let details_ticket_component_DetailsTicketComponent=(()=>{class DetailsTicketComponent{constructor(dialogRef,data,eventService,sharingService,errorHandler){this.dialogRef=dialogRef,this.data=data,this.eventService=eventService,this.sharingService=sharingService,this.errorHandler=errorHandler,this.loading=!0,this.sharing=!1,this.sharedTo=new TicketSharing,this.countries=(new Country_json.a).countries,this.fieldValidity=new Map,this.scavenger=new scavenger.Scavenger(this)}ngOnDestroy(){}ngOnInit(){this.loading=!0,this.type=this.data.type,\"transport\"===this.type?this.item=this.data.item:\"event\"===this.type&&(this.item=this.data.item,this.getEvent(this.item.eventId)),this.item.isShared?this.getSharing():this.loading=!1}formatNumber(){this.sharedTo.telephone=Object(index_es6.b)(this.sharedTo.telephone,this.sharedTo.countryCode)}checkFields(item){const field=[];0===this.sharedTo[item].length?field.push(\"required\"):\"telephone\"!==item||Object(index_es6.d)(this.sharedTo.telephone,this.sharedTo.countryCode)||field.push(\"badFormat\"),field.length>0?this.fieldValidity.set(item,field):this.fieldValidity.delete(item)}cancelSharing(){this.sharedTo=new TicketSharing,this.fieldValidity.clear(),this.sharing=!1}doSharing(){if(this.loading=!0,Array.of(\"firstName\",\"lastName\",\"telephone\").forEach(x=>this.checkFields(x)),this.fieldValidity.size>0)sweetalert2_all_default.a.fire(\"Erreur\",\"Veuillez corriger le formulaire!\",\"error\");else{this.sharedTo.ticketId=this.item.codeTicket,this.sharedTo.telephone=this.sharedTo.telephone.split(\" \").join(\"\");const dial=this.countries.find(x=>x.code===this.sharedTo.countryCode).dial_code.replace(\"+\",\"\");this.sharingService.doSharing(JSON.stringify(this.sharedTo),this.type,dial).pipe(this.scavenger.collect(),Object(retry.a)(2)).subscribe(data=>{if(200===data.status){const text=this.type=\"le début de l'événement\";this.messageDialog(\"Partage\",\"<p>Le partage du ticket numéro \"+this.sharedTo.ticketId+\" a réussi. Un SMS de confirmation a été envoyé a \"+this.sharedTo.firstName+\" \"+this.sharedTo.lastName+\".Vous pouvez révoquer le partage de ce ticket depuis votre espace personnel. <br/> <strong> VEUILLEZ NOTER: </strong> Vous ne pourrez plus retirer ce billet au nouveau détenteur s'il reste moins d'une heure avant \"+text+\"</p>\",\"success\")}else 404===data.status&&this.errorDialog()},err=>{this.errorHandler.handleError(err),this.loading=!1})}}revokeSharing(){this.loading=!0,this.sharingService.revokeTicket(this.item.sharingId,this.type).pipe(this.scavenger.collect()).subscribe(data=>{data.ok?this.messageDialog(\"Reussi\",\"Le partage de ce ticket a été supprimé avec succès. Vous êtes à nouveau son titulaire.\",\"success\"):this.errorDialog()},err=>{this.errorHandler.handleError(err),this.loading=!1})}attributeTicket(){const name=`<strong>${humanize(this.sharedTo.firstName)} ${humanize(this.sharedTo.lastName)}</strong>`;sweetalert2_all_default.a.fire({title:\"Attribution de ticket\",html:\"<p>Vous êtes sur le point d'attribuer le ticket à \"+name+\". Une fois l'attribution effectuée, vous ne pourrez plus effectuer aucune action sur ce ticket. \"+name+\" deviendra le nouveau propriétaire du ticket. Souhaitez-vous continuer ?</p>\",icon:\"question\",allowEscapeKey:!1,allowEnterKey:!1,allowOutsideClick:!1,showCloseButton:!1,showCancelButton:!0,cancelButtonText:\"Non\",confirmButtonText:\"Oui\",focusConfirm:!0,cancelButtonColor:\"red\",confirmButtonColor:\"green\"}).then(res=>{res.value?this.doAttribution():res.dismiss&&sweetalert2_all_default.a.fire(\"Attribution\",\"L'attribution du ticket a été annulé!\",\"info\")})}doAttribution(){this.sharingService.attributeTicket(this.type,this.item.sharingId).pipe(Object(retry.a)(2),this.scavenger.collect()).subscribe(data=>{data.ok?this.messageDialog(\"Attribution\",\"Le ticket a été attribué avec succès.\",\"success\"):this.messageDialog(\"Attribution\",\"L'attribution du ticket a échoué. Veuillez réessayer SVP.\",\"error\")},err=>{this.errorHandler.handleError(err),this.loading=!1})}getEvent(id){this.eventService.getAnEvent(id).pipe(this.scavenger.collect(),Object(retry.a)(2)).subscribe(res=>this.event=res,error=>{this.errorHandler.handleError(error),this.loading=!1},()=>{this.item.isShared?this.getSharing():this.loading=!1})}getSharing(){this.sharingService.getSharing(this.item.sharingId,this.type).pipe(this.scavenger.collect(),Object(retry.a)(2)).subscribe(data=>{this.sharedTo=data,this.formatNumber()},err=>{this.errorHandler.handleError(err),this.loading=!1},()=>this.loading=!1)}messageDialog(head,msg,type){sweetalert2_all_default.a.fire({title:head,html:msg,icon:type,showCloseButton:!1,allowEnterKey:!1,allowOutsideClick:!1,allowEscapeKey:!1}).then(res=>{res.value&&location.reload()})}errorDialog(){sweetalert2_all_default.a.fire(\"Erreur\",\"Une erreur est survenue. Veuillez réessayer SVP!\",\"error\").then(res=>{res&&(this.loading=!1)})}}return DetailsTicketComponent.ɵfac=function(t){return new(t||DetailsTicketComponent)(core.Yb(fesm2015_dialog.g),core.Yb(fesm2015_dialog.a),core.Yb(event_service.a),core.Yb(sharing_service_SharingService),core.Yb(global_error_handler_service.a))},DetailsTicketComponent.ɵcmp=core.Sb({type:DetailsTicketComponent,selectors:[[\"app-details-ticket\"]],decls:16,vars:10,consts:[[1,\"ui\",\"very\",\"raised\",\"segments\"],[1,\"ui\",\"inverted\",\"dimmer\",3,\"ngClass\"],[1,\"ui\",\"text\",\"loader\"],[\"mat-dialog-title\",\"\",1,\"ui\",\"segment\"],[1,\"ui\",\"header\"],[\"class\",\"ui segment fluid pt-1 pb-2\",4,\"ngIf\"],[\"class\",\"ui segment form fluid pt-1 pb-2\",4,\"ngIf\"],[1,\"ui\",\"segment\",\"d-flex\",\"flex-row\",\"justify-content-end\",\"fluid\"],[\"class\",\"ui orange large button right floated mr-3\",\"mat-dialog-close\",\"\",4,\"ngIf\"],[\"class\",\"ui green large button right floated\",3,\"click\",4,\"ngIf\"],[\"class\",\"ui violet large button right floated\",3,\"click\",4,\"ngIf\"],[\"class\",\"ui teal large button right floated\",3,\"click\",4,\"ngIf\"],[1,\"ui\",\"segment\",\"fluid\",\"pt-1\",\"pb-2\"],[1,\"ui\",\"very\",\"basic\",\"table\"],[1,\"right\",\"aligned\"],[4,\"ngIf\"],[1,\"ui\",\"segment\",\"form\",\"fluid\",\"pt-1\",\"pb-2\"],[1,\"required\",\"field\",3,\"ngClass\"],[\"name\",\"fName\",\"type\",\"text\",3,\"ngModel\",\"focusin\",\"focusout\",\"ngModelChange\"],[\"name\",\"lName\",\"type\",\"text\",3,\"ngModel\",\"focusin\",\"focusout\",\"ngModelChange\"],[1,\"ui\",\"left\",\"labeled\",\"input\"],[\"name\",\"code\",1,\"ui\",\"dropdown\",\"selection\",\"share-tel\",\"mr-2\",\"mb-0\",\"h6\",3,\"ngModel\",\"ngModelChange\"],[3,\"value\",4,\"ngFor\",\"ngForOf\"],[\"name\",\"telephone\",\"placeholder\",\"Telephone\",3,\"ngModel\",\"focusout\",\"keyup\",\"ngModelChange\"],[1,\"error\"],[3,\"value\"],[\"class\",\"error\",4,\"ngIf\"],[\"mat-dialog-close\",\"\",1,\"ui\",\"orange\",\"large\",\"button\",\"right\",\"floated\",\"mr-3\"],[1,\"ui\",\"green\",\"large\",\"button\",\"right\",\"floated\",3,\"click\"],[1,\"ui\",\"violet\",\"large\",\"button\",\"right\",\"floated\",3,\"click\"],[1,\"ui\",\"teal\",\"large\",\"button\",\"right\",\"floated\",3,\"click\"]],template:function(rf,ctx){1&rf&&(core.ec(0,\"div\",0),core.ec(1,\"div\",1),core.ec(2,\"div\",2),core.cd(3,\"Chargement\"),core.dc(),core.dc(),core.ec(4,\"div\",3),core.ec(5,\"p\",4),core.cd(6),core.dc(),core.dc(),core.ad(7,DetailsTicketComponent_div_7_Template,46,36,\"div\",5),core.ad(8,DetailsTicketComponent_div_8_Template,19,11,\"div\",6),core.ec(9,\"div\",7),core.ad(10,DetailsTicketComponent_button_10_Template,2,0,\"button\",8),core.ad(11,DetailsTicketComponent_button_11_Template,2,0,\"button\",9),core.ad(12,DetailsTicketComponent_button_12_Template,2,0,\"button\",9),core.ad(13,DetailsTicketComponent_button_13_Template,2,0,\"button\",10),core.ad(14,DetailsTicketComponent_button_14_Template,2,0,\"button\",11),core.ad(15,DetailsTicketComponent_button_15_Template,2,0,\"button\",9),core.dc(),core.dc()),2&rf&&(core.Kb(1),core.Cc(\"ngClass\",ctx.loading?\"active\":\"\"),core.Kb(5),core.dd(ctx.sharing?\"Partage de ticket\":\"Details Billet\"),core.Kb(1),core.Cc(\"ngIf\",!ctx.sharing),core.Kb(1),core.Cc(\"ngIf\",ctx.sharing),core.Kb(2),core.Cc(\"ngIf\",!ctx.sharing),core.Kb(1),core.Cc(\"ngIf\",!ctx.sharing&&!ctx.item.isShared),core.Kb(1),core.Cc(\"ngIf\",!ctx.sharing&&ctx.item.isShared),core.Kb(1),core.Cc(\"ngIf\",!ctx.sharing&&ctx.item.isShared),core.Kb(1),core.Cc(\"ngIf\",ctx.sharing),core.Kb(1),core.Cc(\"ngIf\",ctx.sharing))},directives:[common.p,fesm2015_dialog.h,common.r,fesm2015_forms.c,fesm2015_forms.n,fesm2015_forms.q,fesm2015_forms.w,common.q,fesm2015_forms.r,fesm2015_forms.y,fesm2015_dialog.d],pipes:[common.A,common.f,common.d],styles:['.ui[class*=\"very basic\"].table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:first-child{font-weight:600;font-size:15px;padding-right:15px!important}.ui[class*=\"very basic\"].table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{color:#444;padding:7px 0!important}.share-tel[_ngcontent-%COMP%]{min-width:auto!important;width:100px!important;padding-right:0!important}']}),DetailsTicketComponent})();var index_all=__webpack_require__(\"xG9w\");let user_service_UserService=(()=>{class UserService{constructor(cookiesService,http){this.cookiesService=cookiesService,this.http=http,this.urls=new url_config.a}getUser(){return this.http.get(`${this.urls.mainHost}/user/search`,{params:{username:this.getUsername()}})}getTransportTickets(){return this.http.get(`${this.urls.mainHost}/user/${this.getUsername()}/tickets/transport`)}getEventTickets(){return this.http.get(`${this.urls.mainHost}/user/${this.getUsername()}/tickets/event`)}updatePassword(oldPassword,newPassword){return this.http.post(`${this.urls.mainHost}/password`,JSON.stringify({username:this.getUsername(),oldPassword:oldPassword,newPassword:newPassword}),{observe:\"response\"})}updateUser(user){return this.http.post(`${this.urls.mainHost}/user/${this.getUsername()}/profile`,JSON.stringify(user),{observe:\"response\"})}getUsername(){return this.cookiesService.getCookie(\"last_email\")}}return UserService.ɵfac=function(t){return new(t||UserService)(core.mc(cookies_service.a),core.mc(fesm2015_http.b))},UserService.ɵprov=core.Ub({token:UserService,factory:UserService.ɵfac,providedIn:\"root\"}),UserService})();function MyTicketsComponent_div_0_Template(rf,ctx){1&rf&&(core.ec(0,\"div\",2),core.ec(1,\"div\",3),core.cd(2,\"Chargement\"),core.dc(),core.dc())}function MyTicketsComponent_div_1_table_4_tbody_18_tr_1_td_1_Template(rf,ctx){1&rf&&(core.ec(0,\"td\",18),core.cd(1,\"EXPIRée\"),core.dc())}function MyTicketsComponent_div_1_table_4_tbody_18_tr_1_td_2_Template(rf,ctx){1&rf&&(core.ec(0,\"td\",19),core.cd(1,\"PARTAGER\"),core.dc())}function MyTicketsComponent_div_1_table_4_tbody_18_tr_1_td_3_Template(rf,ctx){if(1&rf&&(core.ec(0,\"td\"),core.cd(1),core.uc(2,\"titlecase\"),core.uc(3,\"date\"),core.dc()),2&rf){const item_r7=core.tc().$implicit,ctx_r10=core.tc(4);core.Kb(1),core.fd(\" \",core.vc(2,2,core.xc(3,4,ctx_r10.pipeDate(item_r7.departDate),\"dd MMMM yyyy\",\"UTC\")),\" á \",item_r7.departTime,\" \")}}function MyTicketsComponent_div_1_table_4_tbody_18_tr_1_Template(rf,ctx){if(1&rf){const _r13=core.fc();core.ec(0,\"tr\",14),core.qc(\"click\",(function(){core.Tc(_r13);const item_r7=ctx.$implicit;return core.tc(4).ticketDetails(item_r7,\"transport\")})),core.ad(1,MyTicketsComponent_div_1_table_4_tbody_18_tr_1_td_1_Template,2,0,\"td\",15),core.ad(2,MyTicketsComponent_div_1_table_4_tbody_18_tr_1_td_2_Template,2,0,\"td\",16),core.ad(3,MyTicketsComponent_div_1_table_4_tbody_18_tr_1_td_3_Template,4,8,\"td\",12),core.ec(4,\"td\"),core.cd(5),core.uc(6,\"titlecase\"),core.dc(),core.ec(7,\"td\"),core.cd(8),core.uc(9,\"titlecase\"),core.dc(),core.ec(10,\"td\",17),core.cd(11),core.dc(),core.ec(12,\"td\",17),core.cd(13),core.uc(14,\"titlecase\"),core.dc(),core.dc()}if(2&rf){const item_r7=ctx.$implicit;core.Cc(\"ngClass\",\"EXPIRER\"===item_r7.codeTicket?\"center aligned clear\":\"center aligned cursor-pointer\"),core.Kb(1),core.Cc(\"ngIf\",\"EXPIRER\"===item_r7.codeTicket),core.Kb(1),core.Cc(\"ngIf\",\"EXPIRER\"!==item_r7.codeTicket&&item_r7.isShared),core.Kb(1),core.Cc(\"ngIf\",\"EXPIRER\"!==item_r7.codeTicket&&!item_r7.isShared),core.Kb(2),core.dd(core.vc(6,10,item_r7.departLocation)),core.Kb(3),core.dd(core.vc(9,12,item_r7.arrivalLocation)),core.Kb(2),core.Cc(\"ngClass\",\"EXPIRER\"===item_r7.codeTicket?\"strikeout\":\"\"),core.Kb(1),core.dd(item_r7.transportType),core.Kb(1),core.Cc(\"ngClass\",\"EXPIRER\"===item_r7.codeTicket?\"strikeout\":\"\"),core.Kb(1),core.dd(core.vc(14,14,item_r7.transportName))}}function MyTicketsComponent_div_1_table_4_tbody_18_Template(rf,ctx){if(1&rf&&(core.ec(0,\"tbody\"),core.ad(1,MyTicketsComponent_div_1_table_4_tbody_18_tr_1_Template,15,16,\"tr\",13),core.dc()),2&rf){const ctx_r4=core.tc(3);core.Kb(1),core.Cc(\"ngForOf\",ctx_r4.transportTickets)}}function MyTicketsComponent_div_1_table_4_tbody_19_tr_1_Template(rf,ctx){1&rf&&(core.ec(0,\"tr\",9),core.ec(1,\"td\",21),core.cd(2,\"Aucun billet disponible\"),core.dc(),core.dc())}function MyTicketsComponent_div_1_table_4_tbody_19_Template(rf,ctx){if(1&rf&&(core.ec(0,\"tbody\"),core.ad(1,MyTicketsComponent_div_1_table_4_tbody_19_tr_1_Template,3,0,\"tr\",20),core.dc()),2&rf){const ctx_r5=core.tc(3);core.Kb(1),core.Cc(\"ngForOf\",ctx_r5.transportTickets)}}function MyTicketsComponent_div_1_table_4_Template(rf,ctx){if(1&rf&&(core.ec(0,\"table\",8),core.ec(1,\"thead\"),core.ec(2,\"tr\",9),core.ec(3,\"th\",10),core.cd(4,\"Date\"),core.dc(),core.ec(5,\"th\",11),core.cd(6,\"Itineraire\"),core.dc(),core.ec(7,\"th\",11),core.cd(8,\"Transport\"),core.dc(),core.dc(),core.ec(9,\"tr\",9),core.ec(10,\"th\"),core.cd(11,\"Départ\"),core.dc(),core.ec(12,\"th\"),core.cd(13,\"Arrivé\"),core.dc(),core.ec(14,\"th\"),core.cd(15,\"Type\"),core.dc(),core.ec(16,\"th\"),core.cd(17,\"Désignation\"),core.dc(),core.dc(),core.dc(),core.ad(18,MyTicketsComponent_div_1_table_4_tbody_18_Template,2,1,\"tbody\",12),core.ad(19,MyTicketsComponent_div_1_table_4_tbody_19_Template,2,1,\"tbody\",12),core.dc()),2&rf){const ctx_r2=core.tc(2);core.Kb(18),core.Cc(\"ngIf\",ctx_r2.transportTickets&&ctx_r2.transportTickets.length>0),core.Kb(1),core.Cc(\"ngIf\",ctx_r2.transportTickets&&0===ctx_r2.transportTickets.length)}}function MyTicketsComponent_div_1_table_7_tr_14_td_1_Template(rf,ctx){1&rf&&(core.ec(0,\"td\",19),core.cd(1,\"PARTAGER\"),core.dc())}function MyTicketsComponent_div_1_table_7_tr_14_td_2_Template(rf,ctx){if(1&rf&&(core.ec(0,\"td\"),core.cd(1),core.uc(2,\"titlecase\"),core.uc(3,\"date\"),core.dc()),2&rf){const item_r17=core.tc().$implicit,ctx_r19=core.tc(3);core.Kb(1),core.ed(\" \",core.vc(2,1,core.xc(3,3,ctx_r19.getLinkedEvent(item_r17).startingDate,\"dd MMMM yyyy\",\"UTC\")),\" \")}}function MyTicketsComponent_div_1_table_7_tr_14_td_3_Template(rf,ctx){1&rf&&(core.ec(0,\"td\",18),core.cd(1,\"EXPIRée\"),core.dc())}function MyTicketsComponent_div_1_table_7_tr_14_Template(rf,ctx){if(1&rf){const _r23=core.fc();core.ec(0,\"tr\",14),core.qc(\"click\",(function(){core.Tc(_r23);const item_r17=ctx.$implicit;return core.tc(3).ticketDetails(item_r17,\"event\")})),core.ad(1,MyTicketsComponent_div_1_table_7_tr_14_td_1_Template,2,0,\"td\",16),core.ad(2,MyTicketsComponent_div_1_table_7_tr_14_td_2_Template,4,7,\"td\",12),core.ad(3,MyTicketsComponent_div_1_table_7_tr_14_td_3_Template,2,0,\"td\",15),core.ec(4,\"td\"),core.cd(5),core.uc(6,\"titlecase\"),core.dc(),core.ec(7,\"td\"),core.cd(8),core.uc(9,\"titlecase\"),core.dc(),core.ec(10,\"td\"),core.cd(11),core.dc(),core.ec(12,\"td\"),core.cd(13),core.uc(14,\"currency\"),core.dc(),core.dc()}if(2&rf){const item_r17=ctx.$implicit,ctx_r16=core.tc(3);core.Cc(\"ngClass\",\"EXPIRER\"===item_r17.codeTicket?\"center aligned clear\":\"center aligned cursor-pointer\"),core.Kb(1),core.Cc(\"ngIf\",\"EXPIRER\"!==item_r17.codeTicket&&item_r17.isShared),core.Kb(1),core.Cc(\"ngIf\",\"EXPIRER\"!==item_r17.codeTicket&&!item_r17.isShared),core.Kb(1),core.Cc(\"ngIf\",\"EXPIRER\"===item_r17.codeTicket),core.Kb(2),core.dd(core.vc(6,8,ctx_r16.getLinkedEvent(item_r17).designation)),core.Kb(3),core.dd(core.vc(9,10,ctx_r16.getLinkedEvent(item_r17).place.designation)),core.Kb(3),core.dd(item_r17.type),core.Kb(2),core.dd(core.yc(14,12,item_r17.totalPrice,\"XOF\",\"symbol\",\"1.1-2\"))}}function MyTicketsComponent_div_1_table_7_Template(rf,ctx){if(1&rf&&(core.ec(0,\"table\",8),core.ec(1,\"thead\"),core.ec(2,\"tr\",9),core.ec(3,\"th\",22),core.cd(4,\"Date\"),core.dc(),core.ec(5,\"th\"),core.cd(6,\"Désignation\"),core.dc(),core.ec(7,\"th\"),core.cd(8,\"Lieu\"),core.dc(),core.ec(9,\"th\"),core.cd(10,\"Classe\"),core.dc(),core.ec(11,\"th\"),core.cd(12,\"Prix\"),core.dc(),core.dc(),core.dc(),core.ec(13,\"tbody\"),core.ad(14,MyTicketsComponent_div_1_table_7_tr_14_Template,15,17,\"tr\",13),core.dc(),core.dc()),2&rf){const ctx_r3=core.tc(2);core.Kb(14),core.Cc(\"ngForOf\",ctx_r3.eventTickets)}}function MyTicketsComponent_div_1_Template(rf,ctx){if(1&rf&&(core.ec(0,\"div\",4),core.ec(1,\"div\",5),core.ec(2,\"div\",6),core.cd(3,\"Mes titres de transport\"),core.dc(),core.ad(4,MyTicketsComponent_div_1_table_4_Template,20,2,\"table\",7),core.ec(5,\"div\",6),core.cd(6,\"Mes tickets d'evenement\"),core.dc(),core.ad(7,MyTicketsComponent_div_1_table_7_Template,15,1,\"table\",7),core.dc(),core.dc()),2&rf){const ctx_r1=core.tc();core.Kb(4),core.Cc(\"ngIf\",ctx_r1.transportTickets),core.Kb(3),core.Cc(\"ngIf\",ctx_r1.eventTickets)}}let my_tickets_component_MyTicketsComponent=(()=>{class MyTicketsComponent{constructor(userService,eventService,errorHandler,dialog){this.userService=userService,this.eventService=eventService,this.errorHandler=errorHandler,this.dialog=dialog,this.scavenger=new scavenger.Scavenger(this)}ngOnInit(){this.getTransportTickets(),this.getEventTickets()}ngOnDestroy(){}ticketDetails(item,type){this.dialog.open(details_ticket_component_DetailsTicketComponent,{width:window.innerWidth>400?\"550px\":\"380px\",height:\"max-content\",id:\"user-details-ticket-dialog\",hasBackdrop:!0,disableClose:!0,closeOnNavigation:!0,data:{type:type,item:item}}).afterClosed().subscribe(data=>{})}pipeDate(dt){return new Date(dt)}getLinkedEvent(item){return this.events.find(x=>x.eventId===item.eventId)}checkExpiry(item){const date=new Date(item.departDate),times=item.departTime.toString().split(\":\");return date.setHours(Number(times[0])),date.setMinutes(Number(times[1])),Object(differenceInHours.a)(Object(parseISO.a)(date.toISOString()),new Date(Object(moment.now)()))<1}getTransportTickets(){this.userService.getTransportTickets().pipe(this.scavenger.collect()).subscribe(res=>{res.forEach(x=>{this.checkExpiry(x)&&(x.codeTicket=\"EXPIRER\")}),this.transportTickets=res},err=>{this.errorHandler.handleError(err),location.reload()})}getEventTickets(){this.userService.getEventTickets().pipe(this.scavenger.collect()).subscribe(res=>{const ids=index_all.e(res.map(x=>x.eventId));this.getEvents(ids,res)},err=>{this.errorHandler.handleError(err),location.reload()})}getEvents(ids,res){this.eventService.getListedEvents(ids).pipe(this.scavenger.collect()).subscribe(ele=>{this.events=ele,ele.forEach(item=>{Object(isAfter.a)(Object(parseISO.a)(item.startingDate.toString()),new Date(Object(moment.now)()))||(res.find(x=>x.eventId===item.eventId).codeTicket=\"EXPIRER\")})},err=>{this.errorHandler.handleError(err),location.reload()},()=>this.eventTickets=res)}}return MyTicketsComponent.ɵfac=function(t){return new(t||MyTicketsComponent)(core.Yb(user_service_UserService),core.Yb(event_service.a),core.Yb(global_error_handler_service.a),core.Yb(fesm2015_dialog.b))},MyTicketsComponent.ɵcmp=core.Sb({type:MyTicketsComponent,selectors:[[\"app-my-tickets\"]],decls:2,vars:2,consts:[[\"class\",\"ui active dimmer h-100 w-100\",4,\"ngIf\"],[\"class\",\"container mt-3 mb-3\",4,\"ngIf\"],[1,\"ui\",\"active\",\"dimmer\",\"h-100\",\"w-100\"],[1,\"ui\",\"active\",\"huge\",\"text\",\"inverted\",\"loader\"],[1,\"container\",\"mt-3\",\"mb-3\"],[1,\"ui\",\"raised\",\"segment\"],[1,\"ui\",\"header\",\"text-center\"],[\"class\",\"ui mini table celled very compact striped structured selectable\",4,\"ngIf\"],[1,\"ui\",\"mini\",\"table\",\"celled\",\"very\",\"compact\",\"striped\",\"structured\",\"selectable\"],[1,\"center\",\"aligned\"],[\"rowspan\",\"2\",2,\"width\",\"200px\"],[\"colspan\",\"2\"],[4,\"ngIf\"],[3,\"ngClass\",\"click\",4,\"ngFor\",\"ngForOf\"],[3,\"ngClass\",\"click\"],[\"class\",\"transport-expired text-uppercase\",4,\"ngIf\"],[\"class\",\"ticket-shared\",4,\"ngIf\"],[3,\"ngClass\"],[1,\"transport-expired\",\"text-uppercase\"],[1,\"ticket-shared\"],[\"class\",\"center aligned\",4,\"ngFor\",\"ngForOf\"],[\"colspan\",\"9\"],[2,\"width\",\"150px\"]],template:function(rf,ctx){1&rf&&(core.ad(0,MyTicketsComponent_div_0_Template,3,0,\"div\",0),core.ad(1,MyTicketsComponent_div_1_Template,8,2,\"div\",1)),2&rf&&(core.Cc(\"ngIf\",!ctx.transportTickets||!ctx.eventTickets),core.Kb(1),core.Cc(\"ngIf\",ctx.transportTickets&&ctx.eventTickets))},directives:[common.r,common.q,common.p],pipes:[common.A,common.f,common.d],styles:[\"tr.clear[_ngcontent-%COMP%]{cursor:default;pointer-events:none}.transport-expired[_ngcontent-%COMP%]{background-color:red;color:#fff;font-weight:700}.strikeout[_ngcontent-%COMP%]{-webkit-text-decoration-line:line-through;text-decoration-line:line-through}.ticket-shared[_ngcontent-%COMP%]{background-color:green;color:#fff;font-weight:700}\"]}),MyTicketsComponent})();var User_model=__webpack_require__(\"LG61\"),CustomValidators=__webpack_require__(\"DrXB\"),auth_service=__webpack_require__(\"qIOU\");function EditPasswordComponent_div_13_div_1_Template(rf,ctx){1&rf&&(core.ec(0,\"div\",16),core.cd(1,\"Ce champ est requis.\"),core.dc())}function EditPasswordComponent_div_13_Template(rf,ctx){if(1&rf&&(core.ec(0,\"div\"),core.ad(1,EditPasswordComponent_div_13_div_1_Template,2,0,\"div\",15),core.dc()),2&rf){const ctx_r0=core.tc();core.Kb(1),core.Cc(\"ngIf\",ctx_r0.f.old.errors.required)}}function EditPasswordComponent_div_18_div_1_Template(rf,ctx){1&rf&&(core.ec(0,\"div\",16),core.cd(1,\"Ce champ est requis.\"),core.dc())}function EditPasswordComponent_div_18_div_2_Template(rf,ctx){1&rf&&(core.ec(0,\"div\",16),core.cd(1,\"Veuillez saisir au moins huit caracteres.\"),core.dc())}function EditPasswordComponent_div_18_Template(rf,ctx){if(1&rf&&(core.ec(0,\"div\"),core.ad(1,EditPasswordComponent_div_18_div_1_Template,2,0,\"div\",15),core.ad(2,EditPasswordComponent_div_18_div_2_Template,2,0,\"div\",15),core.dc()),2&rf){const ctx_r1=core.tc();core.Kb(1),core.Cc(\"ngIf\",ctx_r1.f.new.errors.required),core.Kb(1),core.Cc(\"ngIf\",ctx_r1.f.new.errors.minlength)}}function EditPasswordComponent_div_23_div_1_Template(rf,ctx){1&rf&&(core.ec(0,\"div\",16),core.cd(1,\"Ce champ est requis.\"),core.dc())}function EditPasswordComponent_div_23_div_2_Template(rf,ctx){1&rf&&(core.ec(0,\"div\",16),core.cd(1,\"Les mot de passe ne correspondent pas!\"),core.dc())}function EditPasswordComponent_div_23_Template(rf,ctx){if(1&rf&&(core.ec(0,\"div\"),core.ad(1,EditPasswordComponent_div_23_div_1_Template,2,0,\"div\",15),core.ad(2,EditPasswordComponent_div_23_div_2_Template,2,0,\"div\",15),core.dc()),2&rf){const ctx_r2=core.tc();core.Kb(1),core.Cc(\"ngIf\",ctx_r2.f.confirm.errors.required),core.Kb(1),core.Cc(\"ngIf\",ctx_r2.f.confirm.errors.mustMatch)}}let edit_password_component_EditPasswordComponent=(()=>{class EditPasswordComponent{constructor(dialogRef,data,formBuilder,userService,authService,errorHandler){this.dialogRef=dialogRef,this.data=data,this.formBuilder=formBuilder,this.userService=userService,this.authService=authService,this.errorHandler=errorHandler,this.loading=!1,this.submitted=!1,this.showPassword=!1,this.scavenger=new scavenger.Scavenger(this)}get f(){return this.resetForm.controls}ngOnDestroy(){}ngOnInit(){this.resetForm=this.formBuilder.group({old:[\"\",[fesm2015_forms.x.required]],new:[\"\",[fesm2015_forms.x.required,fesm2015_forms.x.minLength(8)]],confirm:[\"\",fesm2015_forms.x.required]},{validator:Object(CustomValidators.a)(\"new\",\"confirm\")})}onSubmit(){this.submitted=!0,this.resetForm.invalid||this.userService.updatePassword(this.f.old.value,this.f.new.value).pipe(this.scavenger.collect(),Object(retry.a)(2)).subscribe(data=>{\"EXPECTATION_FAILED\"===data.body?sweetalert2_all_default.a.fire(\"Erreur\",\"L'ancien mot de passe que vous avez entré est incorrect. Veuillez le corriger!\",\"error\"):\"NOT_MODIFIED\"===data.body?sweetalert2_all_default.a.fire(\"Erreur\",\"L'ancien mot de passe et le nouveau ne peuvent pas être identiques\",\"info\"):sweetalert2_all_default.a.fire({title:\"Réussi\",html:\"Votre mot de passe a été modifié avec succès. Vous serez déconnecté. Veuillez vous connecter en utilisant votre nouveau mot de passe.\",icon:\"success\",allowOutsideClick:!1,allowEnterKey:!1,allowEscapeKey:!1,showCloseButton:!1,showCancelButton:!1}).then(res=>{res&&this.authService.logout()})},err=>this.errorHandler.handleError(err))}onReset(){this.submitted=!1,this.resetForm.reset()}}return EditPasswordComponent.ɵfac=function(t){return new(t||EditPasswordComponent)(core.Yb(fesm2015_dialog.g),core.Yb(fesm2015_dialog.a),core.Yb(fesm2015_forms.d),core.Yb(user_service_UserService),core.Yb(auth_service.a),core.Yb(global_error_handler_service.a))},EditPasswordComponent.ɵcmp=core.Sb({type:EditPasswordComponent,selectors:[[\"app-edit-password\"]],decls:29,vars:11,consts:[[1,\"ui\",\"very\",\"raised\",\"segments\"],[1,\"ui\",\"inverted\",\"dimmer\",3,\"ngClass\"],[1,\"ui\",\"text\",\"loader\"],[\"mat-dialog-title\",\"\",1,\"ui\",\"segment\"],[1,\"ui\",\"header\"],[1,\"ui\",\"segment\",\"fluid\",\"pt-1\",\"pb-2\"],[1,\"ui\",\"form\",3,\"formGroup\",\"ngSubmit\"],[1,\"field\",\"required\",3,\"ngClass\"],[\"formControlName\",\"old\",3,\"type\"],[4,\"ngIf\"],[\"formControlName\",\"new\",3,\"type\"],[\"formControlName\",\"confirm\",3,\"type\"],[1,\"w-100\"],[\"mat-dialog-close\",\"\",1,\"ui\",\"right\",\"aligned\",\"teal\",\"button\"],[\"type\",\"submit\",1,\"ui\",\"right\",\"aligned\",\"violet\",\"button\"],[\"class\",\"invalid-message\",4,\"ngIf\"],[1,\"invalid-message\"]],template:function(rf,ctx){1&rf&&(core.ec(0,\"div\",0),core.ec(1,\"div\",1),core.ec(2,\"div\",2),core.cd(3,\"Chargement\"),core.dc(),core.dc(),core.ec(4,\"div\",3),core.ec(5,\"p\",4),core.cd(6,\"Modification du mot de passe\"),core.dc(),core.dc(),core.ec(7,\"div\",5),core.ec(8,\"form\",6),core.qc(\"ngSubmit\",(function(){return ctx.onSubmit()})),core.ec(9,\"div\",7),core.ec(10,\"label\"),core.cd(11,\"Ancien Mot de passe\"),core.dc(),core.Zb(12,\"input\",8),core.ad(13,EditPasswordComponent_div_13_Template,2,1,\"div\",9),core.dc(),core.ec(14,\"div\",7),core.ec(15,\"label\"),core.cd(16,\"Nouveau mot de passe\"),core.dc(),core.Zb(17,\"input\",10),core.ad(18,EditPasswordComponent_div_18_Template,3,2,\"div\",9),core.dc(),core.ec(19,\"div\",7),core.ec(20,\"label\"),core.cd(21,\"Confirmer mot de passe\"),core.dc(),core.Zb(22,\"input\",11),core.ad(23,EditPasswordComponent_div_23_Template,3,2,\"div\",9),core.dc(),core.ec(24,\"div\",12),core.ec(25,\"button\",13),core.cd(26,\"Annuler\"),core.dc(),core.ec(27,\"button\",14),core.cd(28,\"Modifier\"),core.dc(),core.dc(),core.dc(),core.dc(),core.dc()),2&rf&&(core.Kb(1),core.Cc(\"ngClass\",ctx.loading?\"active\":\"\"),core.Kb(7),core.Cc(\"formGroup\",ctx.resetForm),core.Kb(1),core.Cc(\"ngClass\",ctx.submitted&&\"INVALID\"===ctx.f.old.status?\"error\":\"\"),core.Kb(3),core.Cc(\"type\",ctx.showPassword?\"text\":\"password\"),core.Kb(1),core.Cc(\"ngIf\",ctx.submitted&&ctx.f.old.errors),core.Kb(1),core.Cc(\"ngClass\",ctx.submitted&&\"INVALID\"===ctx.f.new.status?\"error\":\"\"),core.Kb(3),core.Cc(\"type\",ctx.showPassword?\"text\":\"password\"),core.Kb(1),core.Cc(\"ngIf\",ctx.submitted&&ctx.f.new.errors),core.Kb(1),core.Cc(\"ngClass\",ctx.submitted&&\"INVALID\"===ctx.f.confirm.status?\"error\":\"\"),core.Kb(3),core.Cc(\"type\",ctx.showPassword?\"text\":\"password\"),core.Kb(1),core.Cc(\"ngIf\",ctx.f.confirm.errors&&ctx.submitted))},directives:[common.p,fesm2015_dialog.h,fesm2015_forms.z,fesm2015_forms.o,fesm2015_forms.h,fesm2015_forms.c,fesm2015_forms.n,fesm2015_forms.f,common.r,fesm2015_dialog.d],styles:[\"\"]}),EditPasswordComponent})();var tooltip=__webpack_require__(\"Qu3c\");function MyAccountComponent_div_0_Template(rf,ctx){1&rf&&(core.ec(0,\"div\",2),core.ec(1,\"div\",3),core.cd(2,\"Chargement\"),core.dc(),core.dc())}function MyAccountComponent_div_1_div_3_Template(rf,ctx){if(1&rf){const _r20=core.fc();core.ec(0,\"div\",40),core.ec(1,\"i\",41),core.qc(\"click\",(function(){return core.Tc(_r20),core.tc(2).editing=!0})),core.dc(),core.dc()}}function MyAccountComponent_div_1_div_15_div_1_Template(rf,ctx){1&rf&&(core.ec(0,\"div\",43),core.cd(1,\"Ce champ est requis.\"),core.dc())}function MyAccountComponent_div_1_div_15_div_2_Template(rf,ctx){1&rf&&(core.ec(0,\"div\",43),core.cd(1,\"Ce champ doit contenir au moins 2 caractères.\"),core.dc())}function MyAccountComponent_div_1_div_15_Template(rf,ctx){if(1&rf&&(core.ec(0,\"div\"),core.ad(1,MyAccountComponent_div_1_div_15_div_1_Template,2,0,\"div\",42),core.ad(2,MyAccountComponent_div_1_div_15_div_2_Template,2,0,\"div\",42),core.dc()),2&rf){const ctx_r3=core.tc(2);core.Kb(1),core.Cc(\"ngIf\",ctx_r3.f.firstName.errors.required),core.Kb(1),core.Cc(\"ngIf\",ctx_r3.f.firstName.errors.minlength)}}function MyAccountComponent_div_1_div_20_div_1_Template(rf,ctx){1&rf&&(core.ec(0,\"div\",43),core.cd(1,\"Ce champ est requis.\"),core.dc())}function MyAccountComponent_div_1_div_20_div_2_Template(rf,ctx){1&rf&&(core.ec(0,\"div\",43),core.cd(1,\"Ce champ doit contenir au moins 2 caractères.\"),core.dc())}function MyAccountComponent_div_1_div_20_Template(rf,ctx){if(1&rf&&(core.ec(0,\"div\"),core.ad(1,MyAccountComponent_div_1_div_20_div_1_Template,2,0,\"div\",42),core.ad(2,MyAccountComponent_div_1_div_20_div_2_Template,2,0,\"div\",42),core.dc()),2&rf){const ctx_r4=core.tc(2);core.Kb(1),core.Cc(\"ngIf\",ctx_r4.f.lastName.errors.required),core.Kb(1),core.Cc(\"ngIf\",ctx_r4.f.lastName.errors.minlength)}}function MyAccountComponent_div_1_div_26_div_1_Template(rf,ctx){1&rf&&(core.ec(0,\"div\",43),core.cd(1,\"Ce champ est requis.\"),core.dc())}function MyAccountComponent_div_1_div_26_div_2_Template(rf,ctx){1&rf&&(core.ec(0,\"div\",43),core.cd(1,\"Ce champ doit contenir au moins 6 caractères.\"),core.dc())}function MyAccountComponent_div_1_div_26_div_3_Template(rf,ctx){1&rf&&(core.ec(0,\"div\",43),core.cd(1,\"Ce champ ne peut contenir plus de 20 caractères.\"),core.dc())}function MyAccountComponent_div_1_div_26_Template(rf,ctx){if(1&rf&&(core.ec(0,\"div\"),core.ad(1,MyAccountComponent_div_1_div_26_div_1_Template,2,0,\"div\",42),core.ad(2,MyAccountComponent_div_1_div_26_div_2_Template,2,0,\"div\",42),core.ad(3,MyAccountComponent_div_1_div_26_div_3_Template,2,0,\"div\",42),core.dc()),2&rf){const ctx_r5=core.tc(2);core.Kb(1),core.Cc(\"ngIf\",ctx_r5.f.username.errors.required),core.Kb(1),core.Cc(\"ngIf\",ctx_r5.f.username.errors.minlength),core.Kb(1),core.Cc(\"ngIf\",ctx_r5.f.username.errors.maxlength)}}function MyAccountComponent_div_1_div_31_div_1_Template(rf,ctx){1&rf&&(core.ec(0,\"div\",43),core.cd(1,\"Ce champ ne peut contenir plus de 200 caractères.\"),core.dc())}function MyAccountComponent_div_1_div_31_div_2_Template(rf,ctx){1&rf&&(core.ec(0,\"div\",43),core.cd(1,\"Le format de votre email est invalide.\"),core.dc())}function MyAccountComponent_div_1_div_31_Template(rf,ctx){if(1&rf&&(core.ec(0,\"div\"),core.ad(1,MyAccountComponent_div_1_div_31_div_1_Template,2,0,\"div\",42),core.ad(2,MyAccountComponent_div_1_div_31_div_2_Template,2,0,\"div\",42),core.dc()),2&rf){const ctx_r6=core.tc(2);core.Kb(1),core.Cc(\"ngIf\",ctx_r6.f.email.errors.maxlength),core.Kb(1),core.Cc(\"ngIf\",ctx_r6.f.email.errors.email)}}function MyAccountComponent_div_1_input_36_Template(rf,ctx){if(1&rf&&core.Zb(0,\"input\",44),2&rf){const ctx_r7=core.tc(2);core.Cc(\"value\",ctx_r7.getIdType())}}function MyAccountComponent_div_1_select_37_Template(rf,ctx){1&rf&&(core.ec(0,\"select\",45),core.ec(1,\"option\",46),core.cd(2,\"Séléctionner\"),core.dc(),core.ec(3,\"option\",47),core.cd(4,\"Carte Nationale d'identité\"),core.dc(),core.ec(5,\"option\",48),core.cd(6,\"Passport\"),core.dc(),core.dc()),2&rf&&(core.Kb(1),core.Cc(\"value\",null))}function MyAccountComponent_div_1_div_59_div_1_Template(rf,ctx){1&rf&&(core.ec(0,\"div\",43),core.cd(1,\"Ce champ ne peut contenir que des chiffres.\"),core.dc())}function MyAccountComponent_div_1_div_59_Template(rf,ctx){if(1&rf&&(core.ec(0,\"div\"),core.ad(1,MyAccountComponent_div_1_div_59_div_1_Template,2,0,\"div\",42),core.dc()),2&rf){const ctx_r9=core.tc(2);core.Kb(1),core.Cc(\"ngIf\",ctx_r9.f.postalCode.errors.pattern)}}function MyAccountComponent_div_1_input_64_Template(rf,ctx){if(1&rf&&(core.Zb(0,\"input\",44),core.uc(1,\"titlecase\")),2&rf){const ctx_r10=core.tc(2);core.Cc(\"value\",core.vc(1,1,ctx_r10.getCountry()))}}function MyAccountComponent_div_1_select_65_option_1_Template(rf,ctx){if(1&rf&&(core.ec(0,\"option\",51),core.cd(1),core.dc()),2&rf){const item_r32=ctx.$implicit;core.Cc(\"value\",item_r32.code),core.Kb(1),core.dd(item_r32.name)}}function MyAccountComponent_div_1_select_65_Template(rf,ctx){if(1&rf&&(core.ec(0,\"select\",49),core.ad(1,MyAccountComponent_div_1_select_65_option_1_Template,2,2,\"option\",50),core.dc()),2&rf){const ctx_r11=core.tc(2);core.Kb(1),core.Cc(\"ngForOf\",ctx_r11.countries)}}function MyAccountComponent_div_1_div_66_div_1_Template(rf,ctx){1&rf&&(core.ec(0,\"div\",43),core.cd(1,\"Ce champ est requis.\"),core.dc())}function MyAccountComponent_div_1_div_66_Template(rf,ctx){if(1&rf&&(core.ec(0,\"div\"),core.ad(1,MyAccountComponent_div_1_div_66_div_1_Template,2,0,\"div\",42),core.dc()),2&rf){const ctx_r12=core.tc(2);core.Kb(1),core.Cc(\"ngIf\",ctx_r12.f.countryCode.errors.required)}}function MyAccountComponent_div_1_input_75_Template(rf,ctx){if(1&rf&&core.Zb(0,\"input\",52),2&rf){const ctx_r13=core.tc(2);core.Cc(\"value\",ctx_r13.formatNumber())}}function MyAccountComponent_div_1_input_76_Template(rf,ctx){if(1&rf){const _r35=core.fc();core.ec(0,\"input\",53),core.qc(\"keyup\",(function(){return core.Tc(_r35),core.tc(2).formatNumber()})),core.dc()}}function MyAccountComponent_div_1_div_77_div_1_Template(rf,ctx){1&rf&&(core.ec(0,\"div\",43),core.cd(1,\"Ce champ est requis.\"),core.dc())}function MyAccountComponent_div_1_div_77_div_2_Template(rf,ctx){1&rf&&(core.ec(0,\"div\",43),core.cd(1,\"Le format de votre numéro de téléphone est invalide. \"),core.dc())}function MyAccountComponent_div_1_div_77_div_3_Template(rf,ctx){1&rf&&(core.ec(0,\"div\",43),core.cd(1,\"Ce champ ne peut contenir que des chiffres.\"),core.dc())}function MyAccountComponent_div_1_div_77_Template(rf,ctx){if(1&rf&&(core.ec(0,\"div\"),core.ad(1,MyAccountComponent_div_1_div_77_div_1_Template,2,0,\"div\",42),core.ad(2,MyAccountComponent_div_1_div_77_div_2_Template,2,0,\"div\",42),core.ad(3,MyAccountComponent_div_1_div_77_div_3_Template,2,0,\"div\",42),core.dc()),2&rf){const ctx_r15=core.tc(2);core.Kb(1),core.Cc(\"ngIf\",ctx_r15.f.telephone.errors.required),core.Kb(1),core.Cc(\"ngIf\",ctx_r15.f.telephone.errors.validPhone),core.Kb(1),core.Cc(\"ngIf\",ctx_r15.f.telephone.errors.pattern)}}function MyAccountComponent_div_1_button_79_Template(rf,ctx){if(1&rf){const _r40=core.fc();core.ec(0,\"button\",54),core.qc(\"click\",(function(){return core.Tc(_r40),core.tc(2).updatePassword()})),core.cd(1,\"Modifier mot de passe\"),core.dc()}}function MyAccountComponent_div_1_button_80_Template(rf,ctx){if(1&rf){const _r42=core.fc();core.ec(0,\"button\",55),core.qc(\"click\",(function(){return core.Tc(_r42),core.tc(2).resetForm()})),core.cd(1,\"Annuler\"),core.dc()}}function MyAccountComponent_div_1_button_81_Template(rf,ctx){1&rf&&(core.ec(0,\"button\",56),core.cd(1,\"Enregistrer\"),core.dc())}function MyAccountComponent_div_1_Template(rf,ctx){if(1&rf){const _r44=core.fc();core.ec(0,\"div\",4),core.ec(1,\"div\",5),core.ec(2,\"div\",6),core.ad(3,MyAccountComponent_div_1_div_3_Template,2,0,\"div\",7),core.ec(4,\"h1\",8),core.cd(5,\"Mon compte\"),core.dc(),core.dc(),core.ec(6,\"div\",6),core.ec(7,\"h3\",9),core.cd(8,\"Information\"),core.dc(),core.ec(9,\"form\",10),core.qc(\"ngSubmit\",(function(){return core.Tc(_r44),core.tc().onSubmit()})),core.ec(10,\"div\",11),core.ec(11,\"div\",12),core.ec(12,\"label\"),core.cd(13,\"Prénom\"),core.dc(),core.Zb(14,\"input\",13),core.ad(15,MyAccountComponent_div_1_div_15_Template,3,2,\"div\",14),core.dc(),core.ec(16,\"div\",12),core.ec(17,\"label\"),core.cd(18,\"Nom\"),core.dc(),core.Zb(19,\"input\",15),core.ad(20,MyAccountComponent_div_1_div_20_Template,3,2,\"div\",14),core.dc(),core.dc(),core.ec(21,\"div\",11),core.ec(22,\"div\",12),core.ec(23,\"label\"),core.cd(24,\"Nom d'utilisateur\"),core.dc(),core.ec(25,\"input\",16),core.qc(\"keyup\",(function(){core.Tc(_r44);const ctx_r45=core.tc();return ctx_r45.f.username.setValue(ctx_r45.f.username.value.toLowerCase())})),core.dc(),core.ad(26,MyAccountComponent_div_1_div_26_Template,4,3,\"div\",14),core.dc(),core.ec(27,\"div\",17),core.ec(28,\"label\"),core.cd(29,\"Email\"),core.dc(),core.Zb(30,\"input\",18),core.ad(31,MyAccountComponent_div_1_div_31_Template,3,2,\"div\",14),core.dc(),core.dc(),core.ec(32,\"div\",11),core.ec(33,\"div\",19),core.ec(34,\"label\"),core.cd(35,\"Type d'identification\"),core.dc(),core.ad(36,MyAccountComponent_div_1_input_36_Template,1,1,\"input\",20),core.ad(37,MyAccountComponent_div_1_select_37_Template,7,1,\"select\",21),core.dc(),core.ec(38,\"div\",19),core.ec(39,\"label\"),core.cd(40,\"Numéro d'identification\"),core.dc(),core.Zb(41,\"input\",22),core.dc(),core.dc(),core.ec(42,\"div\",23),core.ec(43,\"label\"),core.cd(44,\"Adresse\"),core.dc(),core.Zb(45,\"input\",24),core.dc(),core.ec(46,\"div\",25),core.ec(47,\"div\",26),core.ec(48,\"label\"),core.cd(49,\"Ville\"),core.dc(),core.Zb(50,\"input\",27),core.dc(),core.ec(51,\"div\",26),core.ec(52,\"label\"),core.cd(53,\"Département\"),core.dc(),core.Zb(54,\"input\",28),core.dc(),core.ec(55,\"div\",29),core.ec(56,\"label\"),core.cd(57,\"Code postal\"),core.dc(),core.Zb(58,\"input\",30),core.ad(59,MyAccountComponent_div_1_div_59_Template,2,1,\"div\",14),core.dc(),core.dc(),core.ec(60,\"div\",31),core.ec(61,\"div\",12),core.ec(62,\"label\"),core.cd(63,\"Pays\"),core.dc(),core.ad(64,MyAccountComponent_div_1_input_64_Template,2,3,\"input\",20),core.ad(65,MyAccountComponent_div_1_select_65_Template,2,1,\"select\",32),core.ad(66,MyAccountComponent_div_1_div_66_Template,2,1,\"div\",14),core.dc(),core.ec(67,\"div\",12),core.ec(68,\"label\"),core.cd(69,\"Téléphone\"),core.dc(),core.ec(70,\"div\",33),core.ec(71,\"div\",34),core.Zb(72,\"i\"),core.uc(73,\"lowercase\"),core.cd(74),core.dc(),core.ad(75,MyAccountComponent_div_1_input_75_Template,1,1,\"input\",35),core.ad(76,MyAccountComponent_div_1_input_76_Template,1,0,\"input\",36),core.dc(),core.ad(77,MyAccountComponent_div_1_div_77_Template,4,3,\"div\",14),core.dc(),core.dc(),core.ec(78,\"div\"),core.ad(79,MyAccountComponent_div_1_button_79_Template,2,0,\"button\",37),core.ad(80,MyAccountComponent_div_1_button_80_Template,2,0,\"button\",38),core.ad(81,MyAccountComponent_div_1_button_81_Template,2,0,\"button\",39),core.dc(),core.dc(),core.dc(),core.dc(),core.dc()}if(2&rf){const ctx_r1=core.tc();core.Kb(3),core.Cc(\"ngIf\",!ctx_r1.editing),core.Kb(6),core.Cc(\"formGroup\",ctx_r1.userForm),core.Kb(2),core.Mb(ctx_r1.editing?\"required field\":\"field\"),core.Cc(\"ngClass\",ctx_r1.submitted&&\"INVALID\"===ctx_r1.f.firstName.status?\"error\":\"\"),core.Kb(3),core.Cc(\"readonly\",!ctx_r1.editing),core.Kb(1),core.Cc(\"ngIf\",ctx_r1.submitted&&ctx_r1.f.firstName.errors),core.Kb(1),core.Mb(ctx_r1.editing?\"required field\":\"field\"),core.Cc(\"ngClass\",ctx_r1.submitted&&\"INVALID\"===ctx_r1.f.lastName.status?\"error\":\"\"),core.Kb(3),core.Cc(\"readonly\",!ctx_r1.editing),core.Kb(1),core.Cc(\"ngIf\",ctx_r1.submitted&&ctx_r1.f.lastName.errors),core.Kb(2),core.Mb(ctx_r1.editing?\"required field\":\"field\"),core.Cc(\"ngClass\",ctx_r1.submitted&&\"INVALID\"===ctx_r1.f.username.status?\"error\":\"\"),core.Kb(3),core.Cc(\"readonly\",!ctx_r1.editing),core.Kb(1),core.Cc(\"ngIf\",ctx_r1.submitted&&ctx_r1.f.username.errors),core.Kb(1),core.Cc(\"ngClass\",ctx_r1.submitted&&\"INVALID\"===ctx_r1.f.email.status?\"error\":\"\"),core.Kb(3),core.Cc(\"readonly\",!ctx_r1.editing),core.Kb(1),core.Cc(\"ngIf\",ctx_r1.submitted&&ctx_r1.f.email.errors),core.Kb(5),core.Cc(\"ngIf\",!ctx_r1.editing),core.Kb(1),core.Cc(\"ngIf\",ctx_r1.editing),core.Kb(4),core.Cc(\"readonly\",!ctx_r1.editing),core.Kb(4),core.Cc(\"readonly\",!ctx_r1.editing),core.Kb(5),core.Cc(\"readonly\",!ctx_r1.editing),core.Kb(4),core.Cc(\"readonly\",!ctx_r1.editing),core.Kb(1),core.Cc(\"ngClass\",ctx_r1.submitted&&ctx_r1.f.postalCode.errors?\"error\":\"\"),core.Kb(3),core.Cc(\"readonly\",!ctx_r1.editing),core.Kb(1),core.Cc(\"ngIf\",ctx_r1.submitted&&ctx_r1.f.postalCode.errors),core.Kb(2),core.Mb(ctx_r1.editing?\"required field\":\"field\"),core.Cc(\"ngClass\",ctx_r1.submitted&&ctx_r1.f.countryCode.errors?\"error\":\"\"),core.Kb(3),core.Cc(\"ngIf\",!ctx_r1.editing),core.Kb(1),core.Cc(\"ngIf\",ctx_r1.editing),core.Kb(1),core.Cc(\"ngIf\",ctx_r1.submitted&&ctx_r1.f.countryCode.errors),core.Kb(1),core.Mb(ctx_r1.editing?\"required field\":\"field\"),core.Cc(\"ngClass\",ctx_r1.submitted&&ctx_r1.f.telephone.errors?\"error\":\"\"),core.Kb(5),core.Nb(\"\",core.vc(73,53,ctx_r1.f.countryCode.value),\" flag\"),core.Kb(2),core.ed(\"\",ctx_r1.getDialCode(),\" \"),core.Kb(1),core.Cc(\"ngIf\",!ctx_r1.editing),core.Kb(1),core.Cc(\"ngIf\",ctx_r1.editing),core.Kb(1),core.Cc(\"ngIf\",ctx_r1.submitted&&ctx_r1.f.telephone.errors),core.Kb(2),core.Cc(\"ngIf\",!ctx_r1.editing),core.Kb(1),core.Cc(\"ngIf\",ctx_r1.editing),core.Kb(1),core.Cc(\"ngIf\",ctx_r1.editing)}}const routes=[{path:\"mytickets\",component:my_tickets_component_MyTicketsComponent},{path:\"myaccount\",component:(()=>{class MyAccountComponent{constructor(userService,dialog,fb,router,authService,errorHandler){this.userService=userService,this.dialog=dialog,this.fb=fb,this.router=router,this.authService=authService,this.errorHandler=errorHandler,this.editing=!1,this.loading=!0,this.countries=(new Country_json.a).countries,this.submitted=!1,this.scavenger=new scavenger.Scavenger(this)}get f(){return this.userForm.controls}ngOnDestroy(){}ngOnInit(){this.getUser()}updatePassword(){this.dialog.open(edit_password_component_EditPasswordComponent,{width:\"360px\",height:\"max-content\",id:\"user-details-ticket-dialog\",hasBackdrop:!0,disableClose:!0,closeOnNavigation:!0,data:{username:this.user.credential.username}}).afterClosed().subscribe(data=>{data&&this.router.navigate([\"/\"])})}getIdType(){return void 0===this.user.idType||null===this.f.idType.value?\"\":\"cni\"===this.f.idType.value.toLowerCase()?\"Carte National d'Identité\":\"passport\"===this.f.idType.value.toLowerCase()?\"Passeport\":\"\"}formatNumber(){return Object(index_es6.b)(this.f.telephone.value,this.f.countryCode.value.toUpperCase())}getCountry(){return this.countries.find(x=>x.code===this.user.countryCode).name}resetForm(){this.loading=!0,this.submitted=!1,this.userForm.reset(),this.createForm(),this.editing=!1,this.loading=!1}getDialCode(){return this.countries.find(x=>x.code===this.f.countryCode.value).dial_code}onSubmit(){if(this.submitted=!0,this.userForm.invalid)return;this.loading=!0;let userUpdate=new User_model.b;userUpdate=Object.assign(userUpdate,this.userForm.value),this.userService.updateUser(userUpdate).pipe(this.scavenger.collect(),Object(retry.a)(2)).subscribe(data=>{data.ok&&(this.user.credential.username===this.f.username.value?sweetalert2_all_default.a.fire(\"Done\",\"La modification du profile a reussi\",\"success\").then(res=>{res&&location.reload()}):sweetalert2_all_default.a.fire(\"Done\",\"La modification du profil a réussi. En raison de la modification de votre nom d'utilisateur, vous serez déconnecté. Veuillez vous reconnecter avec votre nouveau nom d'utilisateur.\",\"success\").then(res=>{res&&this.authService.logout()}))},err=>{this.errorHandler.handleError(err),this.loading=!1})}createForm(){this.userForm=this.fb.group({firstName:[this.user.firstName,[fesm2015_forms.x.required,fesm2015_forms.x.minLength(2)]],lastName:[this.user.lastName,[fesm2015_forms.x.required,fesm2015_forms.x.minLength(2)]],email:[this.user.email,Object(CustomValidators.b)([fesm2015_forms.x.maxLength(200),fesm2015_forms.x.email])],username:[this.user.credential.username,[fesm2015_forms.x.required,fesm2015_forms.x.minLength(6),fesm2015_forms.x.maxLength(20)]],idType:[this.user.idType],idNumber:[this.user.idNumber],line:[this.user.line],city:[this.user.city],state:[this.user.state],postalCode:[this.user.postalCode,Object(CustomValidators.b)([fesm2015_forms.x.pattern(/^[0-9]+$/)])],countryCode:[this.user.countryCode,[fesm2015_forms.x.required]],telephone:[this.user.telephone,[fesm2015_forms.x.required,fesm2015_forms.x.pattern(/^[0-9]+$/)]]},{validator:Object(CustomValidators.c)(\"countryCode\",\"telephone\")})}getUser(){this.userService.getUser().pipe(Object(retry.a)(2),this.scavenger.collect()).subscribe(data=>{this.user=data,this.createForm()},_=>sweetalert2_all_default.a.fire(\"Error\",\"Une erreure s'est produite lors de la recupération de votre profile. Veuillez rééssayer SVP\",\"error\").then(res=>{res&&location.reload()}),()=>this.loading=!1)}}return MyAccountComponent.ɵfac=function(t){return new(t||MyAccountComponent)(core.Yb(user_service_UserService),core.Yb(fesm2015_dialog.b),core.Yb(fesm2015_forms.d),core.Yb(fesm2015_router.c),core.Yb(auth_service.a),core.Yb(global_error_handler_service.a))},MyAccountComponent.ɵcmp=core.Sb({type:MyAccountComponent,selectors:[[\"app-my-account\"]],decls:2,vars:2,consts:[[\"class\",\"ui active dimmer h-100 w-100\",4,\"ngIf\"],[\"class\",\"ui main container mb-4 mt-4\",4,\"ngIf\"],[1,\"ui\",\"active\",\"dimmer\",\"h-100\",\"w-100\"],[1,\"ui\",\"active\",\"huge\",\"text\",\"inverted\",\"loader\"],[1,\"ui\",\"main\",\"container\",\"mb-4\",\"mt-4\"],[1,\"ui\",\"card\",\"fluid\"],[1,\"content\"],[\"class\",\"right floated meta\",4,\"ngIf\"],[1,\"header\"],[1,\"ui\",\"dividing\",\"sub\",\"header\"],[\"autocomplete\",\"on\",1,\"ui\",\"form\",3,\"formGroup\",\"ngSubmit\"],[1,\"two\",\"equal\",\"width\",\"fields\"],[3,\"ngClass\"],[\"autocapitalize\",\"words\",\"formControlName\",\"firstName\",\"type\",\"text\",3,\"readonly\"],[4,\"ngIf\"],[\"autocapitalize\",\"words\",\"formControlName\",\"lastName\",\"type\",\"text\",3,\"readonly\"],[\"autocomplete\",\"off\",\"formControlName\",\"username\",\"type\",\"text\",3,\"readonly\",\"keyup\"],[1,\"field\",3,\"ngClass\"],[\"formControlName\",\"email\",\"placeholder\",\"Not set\",\"type\",\"email\",3,\"readonly\"],[1,\"field\"],[\"placeholder\",\"Not set\",\"readonly\",\"\",\"type\",\"text\",3,\"value\",4,\"ngIf\"],[\"class\",\"ui dropdown selectable\",\"formControlName\",\"idType\",\"name\",\"idType\",4,\"ngIf\"],[\"formControlName\",\"idNumber\",\"placeholder\",\"Not set\",\"type\",\"text\",3,\"readonly\"],[1,\"field\",\"fluid\"],[\"autocapitalize\",\"words\",\"formControlName\",\"line\",\"placeholder\",\"Not set\",\"type\",\"text\",3,\"readonly\"],[1,\"three\",\"fields\"],[1,\"six\",\"wide\",\"field\"],[\"autocapitalize\",\"words\",\"formControlName\",\"city\",\"placeholder\",\"Not set\",\"type\",\"text\",3,\"readonly\"],[\"autocapitalize\",\"words\",\"formControlName\",\"state\",\"placeholder\",\"Not set\",\"type\",\"text\",3,\"readonly\"],[1,\"four\",\"wide\",\"field\",3,\"ngClass\"],[\"formControlName\",\"postalCode\",\"placeholder\",\"Not set\",\"type\",\"text\",3,\"readonly\"],[1,\"ui\",\"two\",\"equal\",\"width\",\"fields\"],[\"class\",\"ui dropdown selection share-tel mr-2  mb-0 h6\",\"formControlName\",\"countryCode\",4,\"ngIf\"],[1,\"ui\",\"left\",\"labeled\",\"input\"],[1,\"ui\",\"olive\",\"label\"],[\"readonly\",\"\",\"type\",\"tel\",3,\"value\",4,\"ngIf\"],[\"formControlName\",\"telephone\",\"type\",\"tel\",3,\"keyup\",4,\"ngIf\"],[\"class\",\"ui right floated violet button\",3,\"click\",4,\"ngIf\"],[\"class\",\"ui right floated red button\",3,\"click\",4,\"ngIf\"],[\"class\",\"ui right floated blue button\",\"type\",\"submit\",4,\"ngIf\"],[1,\"right\",\"floated\",\"meta\"],[\"matTooltip\",\"Modifier\",1,\"violet\",\"large\",\"edit\",\"outline\",\"icon\",\"cursor-pointer\",3,\"click\"],[\"class\",\"invalid-message\",4,\"ngIf\"],[1,\"invalid-message\"],[\"placeholder\",\"Not set\",\"readonly\",\"\",\"type\",\"text\",3,\"value\"],[\"formControlName\",\"idType\",\"name\",\"idType\",1,\"ui\",\"dropdown\",\"selectable\"],[\"selected\",\"\",3,\"value\"],[\"value\",\"CNI\"],[\"value\",\"password\"],[\"formControlName\",\"countryCode\",1,\"ui\",\"dropdown\",\"selection\",\"share-tel\",\"mr-2\",\"mb-0\",\"h6\"],[3,\"value\",4,\"ngFor\",\"ngForOf\"],[3,\"value\"],[\"readonly\",\"\",\"type\",\"tel\",3,\"value\"],[\"formControlName\",\"telephone\",\"type\",\"tel\",3,\"keyup\"],[1,\"ui\",\"right\",\"floated\",\"violet\",\"button\",3,\"click\"],[1,\"ui\",\"right\",\"floated\",\"red\",\"button\",3,\"click\"],[\"type\",\"submit\",1,\"ui\",\"right\",\"floated\",\"blue\",\"button\"]],template:function(rf,ctx){1&rf&&(core.ad(0,MyAccountComponent_div_0_Template,3,0,\"div\",0),core.ad(1,MyAccountComponent_div_1_Template,82,55,\"div\",1)),2&rf&&(core.Cc(\"ngIf\",ctx.loading),core.Kb(1),core.Cc(\"ngIf\",!ctx.loading))},directives:[common.r,fesm2015_forms.z,fesm2015_forms.o,fesm2015_forms.h,common.p,fesm2015_forms.c,fesm2015_forms.n,fesm2015_forms.f,tooltip.a,fesm2015_forms.w,fesm2015_forms.r,fesm2015_forms.y,common.q],pipes:[common.o,common.A],styles:[\"\"]}),MyAccountComponent})()}];let account_routing_module_AccountRoutingModule=(()=>{class AccountRoutingModule{}return AccountRoutingModule.ɵmod=core.Wb({type:AccountRoutingModule}),AccountRoutingModule.ɵinj=core.Vb({factory:function(t){return new(t||AccountRoutingModule)},imports:[[fesm2015_router.g.forChild(routes)],fesm2015_router.g]}),AccountRoutingModule})(),account_module_AccountModule=(()=>{class AccountModule{}return AccountModule.ɵmod=core.Wb({type:AccountModule}),AccountModule.ɵinj=core.Vb({factory:function(t){return new(t||AccountModule)},providers:[],imports:[[common.c,account_routing_module_AccountRoutingModule,fesm2015_dialog.f,fesm2015_forms.i,tooltip.b,fesm2015_forms.u]]}),AccountModule})()}}]);","extractedComments":[]}