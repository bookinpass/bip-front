{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{ypLv:function(module,__webpack_exports__,__webpack_require__){\"use strict\";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,\"TransactionModule\",(function(){return transaction_module_TransactionModule}));var common=__webpack_require__(\"ofXK\"),fesm2015_router=__webpack_require__(\"tyNb\"),retry=__webpack_require__(\"un/a\"),Swal_config=__webpack_require__(\"BapT\"),scavenger=__webpack_require__(\"+0XT\"),sweetalert2_all=__webpack_require__(\"PSD3\"),sweetalert2_all_default=__webpack_require__.n(sweetalert2_all),jspdf_min=__webpack_require__(\"5RHE\"),html2canvas=__webpack_require__(\"wOnQ\"),html2canvas_default=__webpack_require__.n(html2canvas),moment=__webpack_require__(\"wd/R\"),core=__webpack_require__(\"fXoL\"),event_service=__webpack_require__(\"gcxx\"),global_error_handler_service=__webpack_require__(\"AXpb\"),url_config=__webpack_require__(\"QnqH\"),fesm2015_http=__webpack_require__(\"tk/3\"),cookies_service=__webpack_require__(\"jzuh\");let ticket_service_TicketService=(()=>{class TicketService{constructor(http,cookieService){this.http=http,this.cookieService=cookieService,this.urlConfig=new url_config.a,this.host=this.urlConfig.mainHost}getTicketEventByRef(ref){return this.http.get(`${this.host}${this.urlConfig.searchEventByRef}/${ref}`)}getTicketTransportByRef(ref){return this.http.get(`${this.host}${this.urlConfig.searchTransportByRef}/${ref}`)}}return TicketService.ɵfac=function(t){return new(t||TicketService)(core.ec(fesm2015_http.b),core.ec(cookies_service.a))},TicketService.ɵprov=core.Mb({token:TicketService,factory:TicketService.ɵfac,providedIn:\"root\"}),TicketService})();var angularx_qrcode=__webpack_require__(\"0hV+\");function TransactionComponent_div_0_Template(rf,ctx){1&rf&&(core.Wb(0,\"div\",2),core.Wb(1,\"div\",3),core.Uc(2,\"Chargement\"),core.Vb(),core.Vb())}function TransactionComponent_div_1_div_1_Template(rf,ctx){if(1&rf&&(core.Wb(0,\"div\",6),core.Wb(1,\"h2\",7),core.Uc(2,\"Info de l'evenement\"),core.Vb(),core.Wb(3,\"div\",10),core.Wb(4,\"div\",11),core.Wb(5,\"div\",12),core.Rb(6,\"img\",13),core.Vb(),core.Wb(7,\"div\",14),core.Wb(8,\"a\",15),core.Uc(9),core.Vb(),core.Wb(10,\"div\",16),core.Wb(11,\"div\"),core.Wb(12,\"h6\"),core.Uc(13,\"Type\"),core.Vb(),core.Uc(14),core.Vb(),core.Wb(15,\"div\"),core.Wb(16,\"h6\"),core.Uc(17,\"Lieu\"),core.Vb(),core.Uc(18),core.Vb(),core.Wb(19,\"div\"),core.Wb(20,\"h6\"),core.Uc(21,\"Début\"),core.Vb(),core.Uc(22),core.mc(23,\"titlecase\"),core.mc(24,\"date\"),core.Vb(),core.Wb(25,\"div\"),core.Wb(26,\"h6\"),core.Uc(27,\"Fin\"),core.Vb(),core.Uc(28),core.mc(29,\"titlecase\"),core.mc(30,\"date\"),core.Vb(),core.Vb(),core.Vb(),core.Vb(),core.Wb(31,\"div\",17),core.Wb(32,\"h6\",18),core.Uc(33),core.Vb(),core.Vb(),core.Vb(),core.Vb()),2&rf){const ctx_r474=core.lc(2);core.Cb(6),core.wc(\"src\",\"../../../assets/images/event/\",ctx_r474.idEvent,\".jpg\",core.Nc),core.Cb(3),core.Vc(ctx_r474.event.designation),core.Cb(5),core.Wc(\": \",ctx_r474.event.eventType,\"\"),core.Cb(4),core.Wc(\": \",ctx_r474.event.place.designation,\"\"),core.Cb(4),core.Xc(\": \",core.nc(23,9,core.oc(24,11,ctx_r474.event.startingDate,\"EEEE, dd MMMM yyyy\")),\" a \",ctx_r474.event.startingTime,\"\"),core.Cb(6),core.Xc(\": \",core.nc(29,14,core.oc(30,16,ctx_r474.event.endingDate,\"EEEE, dd MMMM yyyy\")),\" a \",ctx_r474.event.endingTime,\"\"),core.Cb(5),core.Vc(ctx_r474.event.description)}}function TransactionComponent_div_1_div_8_div_1_Template(rf,ctx){if(1&rf&&(core.Wb(0,\"div\",21),core.Wb(1,\"div\",22),core.Rb(2,\"img\",23),core.Rb(3,\"qrcode\",24),core.Vb(),core.Wb(4,\"div\",25),core.Wb(5,\"span\",26),core.Uc(6),core.Vb(),core.Wb(7,\"span\"),core.Uc(8),core.Vb(),core.Wb(9,\"span\"),core.Uc(10),core.mc(11,\"date\"),core.Vb(),core.Wb(12,\"span\",26),core.Uc(13),core.mc(14,\"currency\"),core.Vb(),core.Vb(),core.Rb(15,\"hr\",27),core.Wb(16,\"div\",28),core.Wb(17,\"div\",29),core.Wb(18,\"p\"),core.Uc(19,\"Réserve sur\"),core.Vb(),core.Rb(20,\"img\",30),core.Vb(),core.Wb(21,\"div\",29),core.Wb(22,\"p\"),core.Uc(23,\"Payé via\"),core.Vb(),core.Rb(24,\"img\",31),core.Vb(),core.Vb(),core.Wb(25,\"div\",32),core.Uc(26,\" www.bookinpass.com \"),core.Vb(),core.Vb()),2&rf){const item_r478=ctx.$implicit,i_r479=ctx.index,ctx_r477=core.lc(3);core.wc(\"id\",\"event-ticket-container\",i_r479,\"\"),core.Cb(2),core.wc(\"src\",\"../../../assets/images/event/\",ctx_r477.idEvent,\".jpg\",core.Nc),core.Cb(1),core.uc(\"allowEmptyString\",!1)(\"elementType\",\"url\")(\"errorCorrectionLevel\",\"H\")(\"margin\",2)(\"qrdata\",item_r478.codeTicket)(\"version\",6)(\"width\",100),core.Cb(3),core.Vc(ctx_r477.event.designation),core.Cb(2),core.Vc(ctx_r477.event.place.designation),core.Cb(2),core.Xc(\"Le \",core.oc(11,16,ctx_r477.event.startingDate,\"dd MMM yyyy\"),\" a partir de \",ctx_r477.event.startingTime,\"\"),core.Cb(3),core.Xc(\"Ticket \",item_r478.type.toLowerCase(),\", \",core.qc(14,19,item_r478.totalPrice,\"XOF\",\"symbol-narrow\",\"1.1-2\"),\" \"),core.Cb(11),core.uc(\"src\",ctx_r477.getLogoPath(item_r478.transactionType),core.Nc)}}function TransactionComponent_div_1_div_8_Template(rf,ctx){if(1&rf&&(core.Wb(0,\"div\",19),core.Sc(1,TransactionComponent_div_1_div_8_div_1_Template,27,24,\"div\",20),core.Vb()),2&rf){const ctx_r475=core.lc(2);core.Cb(1),core.uc(\"ngForOf\",ctx_r475.eventTickets)}}function TransactionComponent_div_1_div_9_div_1_Template(rf,ctx){if(1&rf&&(core.Wb(0,\"div\",34),core.Wb(1,\"div\",22),core.Rb(2,\"img\",35),core.Rb(3,\"qrcode\",36),core.Vb(),core.Wb(4,\"p\",37),core.Wb(5,\"span\",38),core.Uc(6,\"Date\"),core.Vb(),core.Uc(7),core.mc(8,\"titlecase\"),core.mc(9,\"date\"),core.Vb(),core.Wb(10,\"p\",37),core.Wb(11,\"span\",38),core.Uc(12,\"Prix\"),core.Vb(),core.Uc(13),core.mc(14,\"currency\"),core.Vb(),core.Wb(15,\"p\",39),core.Uc(16,\"Ce ticket est non remboursable.\"),core.Vb(),core.Rb(17,\"hr\",27),core.Wb(18,\"div\",28),core.Wb(19,\"div\",29),core.Wb(20,\"p\"),core.Uc(21,\"Réserve sur\"),core.Vb(),core.Rb(22,\"img\",30),core.Vb(),core.Wb(23,\"div\",29),core.Wb(24,\"p\"),core.Uc(25,\"Payé via\"),core.Vb(),core.Rb(26,\"img\",31),core.Vb(),core.Vb(),core.Wb(27,\"div\",32),core.Uc(28,\" www.bookinpass.com \"),core.Vb(),core.Vb()),2&rf){const item_r481=ctx.$implicit,i_r482=ctx.index,ctx_r480=core.lc(3);core.wc(\"id\",\"transport-ticket-container\",i_r482,\"\"),core.Cb(3),core.uc(\"allowEmptyString\",!1)(\"elementType\",\"url\")(\"errorCorrectionLevel\",\"H\")(\"margin\",2)(\"qrdata\",item_r481.codeTicket)(\"version\",6)(\"width\",100),core.Cb(4),core.Xc(\": \",core.nc(8,12,core.oc(9,14,item_r481.departDate,\"dd MMMM yyyy\")),\" à \",item_r481.departTime,\"\"),core.Cb(6),core.Wc(\": \",core.qc(14,17,item_r481.totalPrice,\"XOF\",\"symbol-narrow\",\"1.1-1\"),\" \"),core.Cb(13),core.uc(\"src\",ctx_r480.getLogoPath(item_r481.transactionType),core.Nc)}}function TransactionComponent_div_1_div_9_Template(rf,ctx){if(1&rf&&(core.Wb(0,\"div\",19),core.Sc(1,TransactionComponent_div_1_div_9_div_1_Template,29,22,\"div\",33),core.Vb()),2&rf){const ctx_r476=core.lc(2);core.Cb(1),core.uc(\"ngForOf\",ctx_r476.transportTickets)}}function TransactionComponent_div_1_Template(rf,ctx){if(1&rf){const _r484=core.Xb();core.Wb(0,\"div\",4),core.Sc(1,TransactionComponent_div_1_div_1_Template,34,19,\"div\",5),core.Wb(2,\"div\",6),core.Wb(3,\"div\"),core.Wb(4,\"h2\",7),core.Uc(5,\"Mes billets\"),core.Vb(),core.Wb(6,\"div\",8),core.ic(\"click\",(function(){return core.Lc(_r484),core.lc().download()})),core.Uc(7,\"Telecharger\"),core.Vb(),core.Vb(),core.Sc(8,TransactionComponent_div_1_div_8_Template,2,1,\"div\",9),core.Sc(9,TransactionComponent_div_1_div_9_Template,2,1,\"div\",9),core.Vb(),core.Vb()}if(2&rf){const ctx_r473=core.lc();core.Cb(1),core.uc(\"ngIf\",\"event_sport\"===ctx_r473.type),core.Cb(7),core.uc(\"ngIf\",\"event_sport\"===ctx_r473.type),core.Cb(1),core.uc(\"ngIf\",\"transport\"===ctx_r473.type)}}const routes=[{path:\"\",component:(()=>{class TransactionComponent{constructor(eventService,router,activatedRoute,errorHandler,ticketService){this.eventService=eventService,this.router=router,this.activatedRoute=activatedRoute,this.errorHandler=errorHandler,this.ticketService=ticketService,this.loading=!0,this.scavenger=new scavenger.Scavenger(this),router.events.subscribe(val=>{val instanceof fesm2015_router.b&&this.activatedRoute.queryParamMap.subscribe(params=>{this.status=params.params.status,this.idTransaction=params.params.ref,this.items=Number(params.params.items),this.idEvent=params.params.id,this.type=params.params.type},_=>_)})}ngOnInit(){if(\"succeed\"===this.status){let msg;msg=1===this.items?\"L'achat de votre ticket a réussi. Vous pouvez proceder au téléchargement de votre ticket. Si vous souhaitez partager votre ticket avec un de vos proches, veuillez vous rendre dans votre espace personnel.\":\"Vous venez d'acquérir \"+this.items+' billets. Vous pouvez télécharger vos billets. <strong class=\"underlined\">NOTE:</strong> Tous les billets sont actuellement enregistrés sous votre nom. Une autre personne ne peut en faire usage que si vous la partagez. Veuillez vous rendre dans votre espace personnel pour partager ces billets.',sweetalert2_all_default.a.fire({title:\"Transaction acceptée \",html:msg,icon:\"success\",allowEscapeKey:!1,allowOutsideClick:!1,focusConfirm:!0,showCloseButton:!1}),\"event_sport\"===this.type.toLowerCase()?this.getEventSportDetails():\"transport\"===this.type.toLowerCase()&&this.getTransportTickets()}else this.failedStatus()}ngOnDestroy(){}getLogoPath(paymentType){let src=\"../../../assets/images/icons/\";switch(paymentType.toLowerCase()){case\"orange money\":case\"om\":src=src.concat(\"OM.jpg\");break;case\"wari\":src.concat(\"wari.png\");break;case\"joni joni\":case\"jj\":src=src.concat(\"\");break;case\"paypal\":case\"pp\":src=src.concat(\"paypal.png\");break;default:src=\"\"}return src}download(){this.loading=!0;const type=\"event_sport\"===this.type?\"event\":\"transport\"===this.type?\"transport\":\"\";for(let i=0;i<this.items;++i){const data=document.getElementById(type+\"-ticket-container\"+i);null==data?sweetalert2_all_default.a.fire(\"Erreur\",\"Une erreure s'est produite lors de la tentative de telechargement des tickets!\",\"error\").then(res=>{res&&(this.loading=!1)}):html2canvas_default()(data).then(canvas=>{const imgHeight=1.99*canvas.height/canvas.width,contentDataURL=canvas.toDataURL(\"image/jpg\"),pdf=new jspdf_min(\"p\",\"in\",\"a8\");pdf.addImage(contentDataURL,\"jpg\",0,0,1.99,imgHeight,null,\"slow\"),pdf.save(`${new Date(Object(moment.now)()).toISOString()}.pdf`,{returnPromise:!0}).then(()=>{this.loading=!1})})}}failedStatus(){}getEventSportDetails(){this.eventService.getAnEvent(this.idEvent).pipe(this.scavenger.collect(),Object(retry.a)(3)).subscribe(data=>this.event=data,error=>{404===error.status?(new Swal_config.a).ErrorSwalWithReturn(\"Invalid ID\",\"Cet ID ne correspond à aucun événement\").then(res=>{res&&this.router.navigate([\"\"])}):this.errorHandler.handleError(error)},()=>this.getEventTickets())}getEventTickets(){this.ticketService.getTicketEventByRef(this.idTransaction).pipe(this.scavenger.collect(),Object(retry.a)(3)).subscribe(data=>{data.length!==this.items?setTimeout(()=>this.getEventTickets(),1e3):(this.eventTickets=data,this.eventTickets.sort((a,b)=>a.totalPrice<b.totalPrice?-1:a.totalPrice>b.totalPrice?1:0),this.loading=!1)})}getTransportTickets(){this.ticketService.getTicketTransportByRef(this.idTransaction).pipe(this.scavenger.collect(),Object(retry.a)(3)).subscribe(data=>{data.length!==this.items?setTimeout(()=>this.getTransportTickets(),1e3):(this.transportTickets=data,this.loading=!1)})}}return TransactionComponent.ɵfac=function(t){return new(t||TransactionComponent)(core.Qb(event_service.a),core.Qb(fesm2015_router.c),core.Qb(fesm2015_router.a),core.Qb(global_error_handler_service.a),core.Qb(ticket_service_TicketService))},TransactionComponent.ɵcmp=core.Kb({type:TransactionComponent,selectors:[[\"app-transaction\"]],decls:2,vars:2,consts:[[\"class\",\"ui active dimmer h-100 w-100\",4,\"ngIf\"],[\"class\",\"ui main container segments mb-4 mt-4\",4,\"ngIf\"],[1,\"ui\",\"active\",\"dimmer\",\"h-100\",\"w-100\"],[1,\"ui\",\"active\",\"huge\",\"text\",\"inverted\",\"loader\"],[1,\"ui\",\"main\",\"container\",\"segments\",\"mb-4\",\"mt-4\"],[\"class\",\"ui raised segment\",4,\"ngIf\"],[1,\"ui\",\"raised\",\"segment\"],[1,\"ui\",\"dividing\",\"header\"],[1,\"ui\",\"right\",\"floated\",\"button\",\"download-button\",3,\"click\"],[\"class\",\"my-tickets-container\",4,\"ngIf\"],[1,\"ui\",\"items\"],[1,\"item\"],[1,\"ui\",\"small\",\"rectangle\",\"image\"],[\"alt\",\"\",3,\"src\"],[1,\"content\"],[1,\"header\",\"event-title\"],[1,\"description\",\"d-flex\",\"flex-column\"],[1,\"item\",\"d-flex\",\"flex-column\"],[1,\"font-weight-normal\"],[1,\"my-tickets-container\"],[\"class\",\"ticket-container\",3,\"id\",4,\"ngFor\",\"ngForOf\"],[1,\"ticket-container\",3,\"id\"],[1,\"ticket-header\"],[\"alt\",\"event image\",3,\"src\"],[3,\"allowEmptyString\",\"elementType\",\"errorCorrectionLevel\",\"margin\",\"qrdata\",\"version\",\"width\"],[1,\"ticket-body\"],[1,\"text-uppercase\"],[1,\"w-100\"],[1,\"d-flex\",\"flex-row\",\"justify-content-around\"],[1,\"d-flex\",\"flex-column\",\"justify-content-start\",\"align-items-center\",\"logo-container\"],[\"alt\",\"logo bip\",\"src\",\"../../../assets/images/logo/bip-logo.png\"],[\"alt\",\"logo vendeur\",3,\"src\"],[1,\"d-flex\",\"flex-row\",\"justify-content-end\",\"ticket-footer\"],[\"class\",\"d-flex flex-column ticket-container\",3,\"id\",4,\"ngFor\",\"ngForOf\"],[1,\"d-flex\",\"flex-column\",\"ticket-container\",3,\"id\"],[\"alt\",\"sen-dd bus img\",\"height\",\"110px\",\"src\",\"../../../assets/images/icons/sen-dd.jpg\",\"width\",\"220px\",1,\"bus\"],[1,\"bus\",3,\"allowEmptyString\",\"elementType\",\"errorCorrectionLevel\",\"margin\",\"qrdata\",\"version\",\"width\"],[1,\"h6\",\"mb-1\"],[1,\"underlined\"],[1,\"font-weight-bolder\",\"h7\",\"mb-1\"]],template:function(rf,ctx){1&rf&&(core.Sc(0,TransactionComponent_div_0_Template,3,0,\"div\",0),core.Sc(1,TransactionComponent_div_1_Template,10,3,\"div\",1)),2&rf&&(core.uc(\"ngIf\",ctx.loading),core.Cb(1),core.uc(\"ngIf\",!ctx.loading))},directives:[common.q,common.p,angularx_qrcode.a],pipes:[common.z,common.f,common.d],styles:[\".content[_ngcontent-%COMP%] > .description[_ngcontent-%COMP%] > div[_ngcontent-%COMP%], .event-title[_ngcontent-%COMP%]{font-family:Font Awesome\\\\ 5 Free Solid,Open Sans,Ubuntu,Roboto,Helvetica Neue,sans-serif!important}.content[_ngcontent-%COMP%] > .description[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{font-size:14px;font-weight:400;display:flex;flex-flow:row;margin-bottom:3px}.content[_ngcontent-%COMP%] > .description[_ngcontent-%COMP%] > div[_ngcontent-%COMP%] > h6[_ngcontent-%COMP%]{font-weight:500;text-decoration:underline;margin-bottom:0}.download-button[_ngcontent-%COMP%]{background-color:#f60;color:#fff;position:absolute;right:0;top:4px}.my-tickets-container[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-between;flex-wrap:wrap;min-width:100%}.ticket-container[_ngcontent-%COMP%]{margin:10px 0 10px 20px;width:-webkit-max-content;width:-moz-max-content;width:max-content;height:-webkit-max-content;height:-moz-max-content;height:max-content}.ticket-header[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:flex-start;align-items:center;height:175px}.ticket-header[_ngcontent-%COMP%] > img[_ngcontent-%COMP%]:not(.bus){z-index:1;width:220px;height:100px}.ticket-header[_ngcontent-%COMP%] > qrcode[_ngcontent-%COMP%]:not(.bus){z-index:2;position:relative;bottom:30px}hr[_ngcontent-%COMP%]{margin:0 2px;border-color:#000}.ticket-body[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:flex-start;align-items:center}.ticket-body[_ngcontent-%COMP%] > span[_ngcontent-%COMP%]:first-child{font-size:14px;font-weight:700}.ticket-body[_ngcontent-%COMP%] > span[_ngcontent-%COMP%]{margin-bottom:1px;width:100%;font-size:12px;line-height:17px;text-align:center}.ticket-body[_ngcontent-%COMP%] > span[_ngcontent-%COMP%]:last-child{color:#f60;font-weight:700;font-size:13px}.logo-container[_ngcontent-%COMP%] > p[_ngcontent-%COMP%]{margin-bottom:1px;font-size:12px}.logo-container[_ngcontent-%COMP%]:first-child > img[_ngcontent-%COMP%]{width:100px;height:45px}.logo-container[_ngcontent-%COMP%]:last-child > img[_ngcontent-%COMP%]{width:40px;height:45px}.ticket-footer[_ngcontent-%COMP%]{background-color:#000;height:22px;color:#fff;font-size:13px;margin-top:2px;padding-right:10px;font-family:ubuntu,open sans,sans-serif;font-weight:700;width:100%}@media screen and (max-width:768px){.my-tickets-container[_ngcontent-%COMP%]{justify-content:space-evenly}}@media print{.ticket-container[_ngcontent-%COMP%]{page-break-after:always}}\"]}),TransactionComponent})()}];let transaction_routing_module_TransactionRoutingModule=(()=>{class TransactionRoutingModule{}return TransactionRoutingModule.ɵmod=core.Ob({type:TransactionRoutingModule}),TransactionRoutingModule.ɵinj=core.Nb({factory:function(t){return new(t||TransactionRoutingModule)},imports:[[fesm2015_router.g.forChild(routes)],fesm2015_router.g]}),TransactionRoutingModule})(),transaction_module_TransactionModule=(()=>{class TransactionModule{}return TransactionModule.ɵmod=core.Ob({type:TransactionModule}),TransactionModule.ɵinj=core.Nb({factory:function(t){return new(t||TransactionModule)},imports:[[common.c,transaction_routing_module_TransactionRoutingModule,angularx_qrcode.b]]}),TransactionModule})()}}]);","extractedComments":[]}