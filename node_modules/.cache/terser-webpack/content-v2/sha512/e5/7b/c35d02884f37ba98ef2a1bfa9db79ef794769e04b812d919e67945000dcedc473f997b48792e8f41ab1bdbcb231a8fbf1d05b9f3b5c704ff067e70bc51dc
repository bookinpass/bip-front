{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{ypLv:function(module,__webpack_exports__,__webpack_require__){\"use strict\";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,\"TransactionModule\",(function(){return transaction_module_TransactionModule}));var common=__webpack_require__(\"ofXK\"),fesm2015_router=__webpack_require__(\"tyNb\"),retry=__webpack_require__(\"un/a\"),Swal_config=__webpack_require__(\"BapT\"),scavenger=__webpack_require__(\"+0XT\"),sweetalert2_all=__webpack_require__(\"PSD3\"),sweetalert2_all_default=__webpack_require__.n(sweetalert2_all),jspdf_min=__webpack_require__(\"5RHE\"),html2canvas=__webpack_require__(\"wOnQ\"),html2canvas_default=__webpack_require__.n(html2canvas),moment=__webpack_require__(\"wd/R\"),core=__webpack_require__(\"fXoL\"),event_service=__webpack_require__(\"gcxx\"),global_error_handler_service=__webpack_require__(\"AXpb\"),url_config=__webpack_require__(\"QnqH\"),fesm2015_http=__webpack_require__(\"tk/3\"),cookies_service=__webpack_require__(\"jzuh\");let ticket_service_TicketService=(()=>{class TicketService{constructor(http,cookieService){this.http=http,this.cookieService=cookieService,this.urlConfig=new url_config.a,this.host=this.urlConfig.mainHost}getTicketEventByRef(ref){return this.http.get(`${this.host}${this.urlConfig.searchEventByRef}/${ref}`)}getTicketTransportByRef(ref){return this.http.get(`${this.host}${this.urlConfig.searchTransportByRef}/${ref}`)}}return TicketService.ɵfac=function(t){return new(t||TicketService)(core.mc(fesm2015_http.b),core.mc(cookies_service.a))},TicketService.ɵprov=core.Ub({token:TicketService,factory:TicketService.ɵfac,providedIn:\"root\"}),TicketService})();var angularx_qrcode=__webpack_require__(\"0hV+\");function TransactionComponent_div_0_Template(rf,ctx){1&rf&&(core.ec(0,\"div\",2),core.ec(1,\"div\",3),core.dd(2,\"Chargement\"),core.dc(),core.dc())}function TransactionComponent_div_1_div_1_Template(rf,ctx){if(1&rf&&(core.ec(0,\"div\",6),core.ec(1,\"h2\",7),core.dd(2,\"Info de l'evenement\"),core.dc(),core.ec(3,\"div\",10),core.ec(4,\"div\",11),core.ec(5,\"div\",12),core.Zb(6,\"img\",13),core.dc(),core.ec(7,\"div\",14),core.ec(8,\"a\",15),core.dd(9),core.dc(),core.ec(10,\"div\",16),core.ec(11,\"div\"),core.ec(12,\"h6\"),core.dd(13,\"Type\"),core.dc(),core.dd(14),core.dc(),core.ec(15,\"div\"),core.ec(16,\"h6\"),core.dd(17,\"Lieu\"),core.dc(),core.dd(18),core.dc(),core.ec(19,\"div\"),core.ec(20,\"h6\"),core.dd(21,\"Début\"),core.dc(),core.dd(22),core.uc(23,\"titlecase\"),core.uc(24,\"date\"),core.dc(),core.ec(25,\"div\"),core.ec(26,\"h6\"),core.dd(27,\"Fin\"),core.dc(),core.dd(28),core.uc(29,\"titlecase\"),core.uc(30,\"date\"),core.dc(),core.dc(),core.dc(),core.dc(),core.ec(31,\"div\",17),core.ec(32,\"h6\",18),core.dd(33),core.dc(),core.dc(),core.dc(),core.dc()),2&rf){const ctx_r2=core.tc(2);core.Kb(6),core.Ec(\"src\",\"../../../assets/images/event/\",ctx_r2.idEvent,\".jpg\",core.Vc),core.Kb(3),core.ed(ctx_r2.event.designation),core.Kb(5),core.fd(\": \",ctx_r2.event.eventType,\"\"),core.Kb(4),core.fd(\": \",ctx_r2.event.place.designation,\"\"),core.Kb(4),core.gd(\": \",core.vc(23,9,core.wc(24,11,ctx_r2.event.startingDate,\"EEEE, dd MMMM yyyy\")),\" a \",ctx_r2.event.startingTime,\"\"),core.Kb(6),core.gd(\": \",core.vc(29,14,core.wc(30,16,ctx_r2.event.endingDate,\"EEEE, dd MMMM yyyy\")),\" a \",ctx_r2.event.endingTime,\"\"),core.Kb(5),core.ed(ctx_r2.event.description)}}function TransactionComponent_div_1_div_8_div_1_Template(rf,ctx){if(1&rf){const _r9=core.fc();core.ec(0,\"div\",21),core.qc(\"click\",(function(){core.Tc(_r9);const i_r7=ctx.index;return core.tc(3).downloadTicket(\"event\",i_r7)})),core.ec(1,\"div\",22),core.ec(2,\"a\",23),core.Zb(3,\"i\",24),core.dc(),core.dc(),core.ec(4,\"div\",25),core.Zb(5,\"img\",26),core.Zb(6,\"qrcode\",27),core.dc(),core.ec(7,\"div\",28),core.ec(8,\"span\",29),core.dd(9),core.dc(),core.ec(10,\"span\"),core.dd(11),core.dc(),core.ec(12,\"span\"),core.dd(13),core.uc(14,\"date\"),core.dc(),core.ec(15,\"span\",29),core.dd(16),core.uc(17,\"currency\"),core.dc(),core.dc(),core.Zb(18,\"hr\",30),core.ec(19,\"div\",31),core.ec(20,\"div\",32),core.ec(21,\"p\"),core.dd(22,\"Réserve sur\"),core.dc(),core.Zb(23,\"img\",33),core.dc(),core.ec(24,\"div\",32),core.ec(25,\"p\"),core.dd(26,\"Payé via\"),core.dc(),core.Zb(27,\"img\",34),core.dc(),core.dc(),core.ec(28,\"div\",35),core.dd(29,\" www.bookinpass.com \"),core.dc(),core.dc()}if(2&rf){const item_r6=ctx.$implicit,i_r7=ctx.index,ctx_r5=core.tc(3);core.Ec(\"id\",\"event-ticket-container\",i_r7,\"\"),core.Kb(5),core.Ec(\"src\",\"../../../assets/images/event/\",ctx_r5.idEvent,\".jpg\",core.Vc),core.Kb(1),core.Cc(\"allowEmptyString\",!1)(\"elementType\",\"url\")(\"errorCorrectionLevel\",\"H\")(\"margin\",0)(\"qrdata\",item_r6.codeTicket)(\"version\",6)(\"width\",90),core.Kb(3),core.ed(ctx_r5.event.designation),core.Kb(2),core.ed(ctx_r5.event.place.designation),core.Kb(2),core.gd(\"Le \",core.wc(14,16,ctx_r5.event.startingDate,\"dd MMM yyyy\"),\" a partir de \",ctx_r5.event.startingTime,\"\"),core.Kb(3),core.gd(\"Ticket \",item_r6.type.toLowerCase(),\", \",core.yc(17,19,item_r6.totalPrice,\"XOF\",\"symbol-narrow\",\"1.1-2\"),\" \"),core.Kb(11),core.Cc(\"src\",ctx_r5.getLogoPath(item_r6.transactionType),core.Vc)}}function TransactionComponent_div_1_div_8_Template(rf,ctx){if(1&rf&&(core.ec(0,\"div\",19),core.bd(1,TransactionComponent_div_1_div_8_div_1_Template,30,24,\"div\",20),core.dc()),2&rf){const ctx_r3=core.tc(2);core.Kb(1),core.Cc(\"ngForOf\",ctx_r3.eventTickets)}}function TransactionComponent_div_1_div_9_div_1_Template(rf,ctx){if(1&rf){const _r14=core.fc();core.ec(0,\"div\",21),core.qc(\"click\",(function(){core.Tc(_r14);const i_r12=ctx.index;return core.tc(3).downloadTicket(\"event\",i_r12)})),core.ec(1,\"div\",36),core.Zb(2,\"img\",37),core.Zb(3,\"qrcode\",38),core.dc(),core.ec(4,\"p\",39),core.ec(5,\"span\",40),core.dd(6,\"Date\"),core.dc(),core.dd(7),core.uc(8,\"titlecase\"),core.uc(9,\"date\"),core.dc(),core.ec(10,\"p\",39),core.ec(11,\"span\",40),core.dd(12,\"Prix\"),core.dc(),core.dd(13),core.uc(14,\"currency\"),core.dc(),core.ec(15,\"p\",41),core.dd(16,\"Ce ticket est non remboursable\"),core.dc(),core.Zb(17,\"hr\",42),core.ec(18,\"div\",31),core.ec(19,\"div\",32),core.ec(20,\"p\"),core.dd(21,\"Réserve sur\"),core.dc(),core.Zb(22,\"img\",33),core.dc(),core.ec(23,\"div\",32),core.ec(24,\"p\"),core.dd(25,\"Payé via\"),core.dc(),core.Zb(26,\"img\",34),core.dc(),core.dc(),core.ec(27,\"div\",35),core.dd(28,\" www.bookinpass.com \"),core.dc(),core.dc()}if(2&rf){const item_r11=ctx.$implicit,i_r12=ctx.index,ctx_r10=core.tc(3);core.Ec(\"id\",\"transport-ticket-container\",i_r12,\"\"),core.Kb(3),core.Cc(\"allowEmptyString\",!1)(\"elementType\",\"url\")(\"errorCorrectionLevel\",\"H\")(\"margin\",0)(\"qrdata\",item_r11.codeTicket)(\"version\",6)(\"width\",90),core.Kb(4),core.gd(\": \",core.vc(8,12,core.wc(9,14,item_r11.departDate,\"dd MMMM yyyy\")),\" à \",item_r11.departTime,\"\"),core.Kb(6),core.fd(\": \",core.yc(14,17,item_r11.totalPrice,\"XOF\",\"symbol-narrow\",\"1.1-1\"),\" \"),core.Kb(13),core.Cc(\"src\",ctx_r10.getLogoPath(item_r11.transactionType),core.Vc)}}function TransactionComponent_div_1_div_9_Template(rf,ctx){if(1&rf&&(core.ec(0,\"div\",19),core.bd(1,TransactionComponent_div_1_div_9_div_1_Template,29,22,\"div\",20),core.dc()),2&rf){const ctx_r4=core.tc(2);core.Kb(1),core.Cc(\"ngForOf\",ctx_r4.transportTickets)}}function TransactionComponent_div_1_Template(rf,ctx){if(1&rf){const _r16=core.fc();core.ec(0,\"div\",4),core.bd(1,TransactionComponent_div_1_div_1_Template,34,19,\"div\",5),core.ec(2,\"div\",6),core.ec(3,\"div\"),core.ec(4,\"h2\",7),core.dd(5,\"Mes billets\"),core.dc(),core.ec(6,\"div\",8),core.qc(\"click\",(function(){return core.Tc(_r16),core.tc().download()})),core.dd(7,\"Telecharger\"),core.dc(),core.dc(),core.bd(8,TransactionComponent_div_1_div_8_Template,2,1,\"div\",9),core.bd(9,TransactionComponent_div_1_div_9_Template,2,1,\"div\",9),core.dc(),core.dc()}if(2&rf){const ctx_r1=core.tc();core.Kb(1),core.Cc(\"ngIf\",\"event_sport\"===ctx_r1.type),core.Kb(7),core.Cc(\"ngIf\",\"event_sport\"===ctx_r1.type),core.Kb(1),core.Cc(\"ngIf\",\"transport\"===ctx_r1.type)}}const routes=[{path:\"\",component:(()=>{class TransactionComponent{constructor(eventService,router,activatedRoute,errorHandler,ticketService){this.eventService=eventService,this.router=router,this.activatedRoute=activatedRoute,this.errorHandler=errorHandler,this.ticketService=ticketService,this.loading=!0,this.scavenger=new scavenger.Scavenger(this),router.events.subscribe(val=>{val instanceof fesm2015_router.b&&this.activatedRoute.queryParamMap.subscribe(params=>{this.status=params.params.status,this.idTransaction=params.params.ref,this.items=Number(params.params.items),this.idEvent=params.params.id,this.type=params.params.type},_=>_)})}ngOnInit(){if(\"succeed\"===this.status){let msg;msg=1===this.items?\"L'achat de votre ticket a réussi. Vous pouvez proceder au téléchargement de votre ticket. Si vous souhaitez partager votre ticket avec un de vos proches, veuillez vous rendre dans votre espace personnel.\":\"Vous venez d'acquérir \"+this.items+' billets. Vous pouvez télécharger vos billets. <strong class=\"underlined\">NOTE:</strong> Tous les billets sont actuellement enregistrés sous votre nom. Une autre personne ne peut en faire usage que si vous la partagez. Veuillez vous rendre dans votre espace personnel pour partager ces billets.',sweetalert2_all_default.a.fire({title:\"Transaction acceptée \",html:msg,icon:\"success\",allowEscapeKey:!1,allowOutsideClick:!1,focusConfirm:!0,showCloseButton:!1}),\"event_sport\"===this.type.toLowerCase()?this.getEventSportDetails():\"transport\"===this.type.toLowerCase()&&this.getTransportTickets()}else this.failedStatus()}ngOnDestroy(){}getLogoPath(paymentType){let src=\"../../../assets/images/icons/\";switch(paymentType.toLowerCase()){case\"orange money\":case\"om\":src=src.concat(\"OM.jpg\");break;case\"wari\":src.concat(\"wari.png\");break;case\"joni joni\":case\"jj\":src=src.concat(\"\");break;case\"paypal\":case\"pp\":src=src.concat(\"paypal.png\");break;default:src=\"\"}return src}download(){this.loading=!0;const type=\"event_sport\"===this.type?\"event\":\"transport\"===this.type?\"transport\":\"\";for(let i=0;i<this.items;++i){const data=document.getElementById(type+\"-ticket-container\"+i);console.log(data),null==data?sweetalert2_all_default.a.fire(\"Erreur\",\"Une erreure s'est produite lors de la tentative de telechargement des tickets!\",\"error\").then(res=>{res&&(this.loading=!1)}):html2canvas_default()(data).then(canvas=>{const imgHeight=2*canvas.height/canvas.width,contentDataURL=canvas.toDataURL(\"image/jpeg\"),pdf=new jspdf_min(\"p\",\"in\",\"a8\");pdf.addImage(contentDataURL,\"jepg\",0,0,2,imgHeight,null,\"slow\"),pdf.save(`${new Date(Object(moment.now)()).toISOString()}.pdf`,{returnPromise:!0}).then(()=>{this.loading=!1})})}}downloadTicket(type,id){console.log(type,id)}failedStatus(){}getEventSportDetails(){this.eventService.getAnEvent(this.idEvent).pipe(this.scavenger.collect(),Object(retry.a)(3)).subscribe(data=>this.event=data,error=>{404===error.status?(new Swal_config.a).ErrorSwalWithReturn(\"Invalid ID\",\"Cet ID ne correspond à aucun événement\").then(res=>{res&&this.router.navigate([\"\"])}):this.errorHandler.handleError(error)},()=>this.getEventTickets())}getEventTickets(){this.ticketService.getTicketEventByRef(this.idTransaction).pipe(this.scavenger.collect(),Object(retry.a)(3)).subscribe(data=>{data.length!==this.items?setTimeout(()=>this.getEventTickets(),1e3):(this.eventTickets=data,this.eventTickets.sort((a,b)=>a.totalPrice<b.totalPrice?-1:a.totalPrice>b.totalPrice?1:0),this.loading=!1)})}getTransportTickets(){this.ticketService.getTicketTransportByRef(this.idTransaction).pipe(this.scavenger.collect(),Object(retry.a)(3)).subscribe(data=>{data.length!==this.items?setTimeout(()=>this.getTransportTickets(),1e3):(this.transportTickets=data,this.loading=!1)})}}return TransactionComponent.ɵfac=function(t){return new(t||TransactionComponent)(core.Yb(event_service.a),core.Yb(fesm2015_router.c),core.Yb(fesm2015_router.a),core.Yb(global_error_handler_service.a),core.Yb(ticket_service_TicketService))},TransactionComponent.ɵcmp=core.Sb({type:TransactionComponent,selectors:[[\"app-transaction\"]],decls:2,vars:2,consts:[[\"class\",\"ui active dimmer h-100 w-100\",4,\"ngIf\"],[\"class\",\"ui main container segments mb-4 mt-4\",4,\"ngIf\"],[1,\"ui\",\"active\",\"dimmer\",\"h-100\",\"w-100\"],[1,\"ui\",\"active\",\"huge\",\"text\",\"inverted\",\"loader\"],[1,\"ui\",\"main\",\"container\",\"segments\",\"mb-4\",\"mt-4\"],[\"class\",\"ui raised segment\",4,\"ngIf\"],[1,\"ui\",\"raised\",\"segment\"],[1,\"ui\",\"dividing\",\"header\"],[1,\"ui\",\"right\",\"floated\",\"button\",\"download-button\",3,\"click\"],[\"class\",\"my-tickets-container\",4,\"ngIf\"],[1,\"ui\",\"items\"],[1,\"item\"],[1,\"ui\",\"small\",\"rectangle\",\"image\"],[\"alt\",\"\",3,\"src\"],[1,\"content\"],[1,\"header\",\"event-title\"],[1,\"description\",\"d-flex\",\"flex-column\"],[1,\"item\",\"d-flex\",\"flex-column\"],[1,\"font-weight-normal\"],[1,\"my-tickets-container\"],[\"class\",\"d-flex flex-column ticket-container\",3,\"id\",\"click\",4,\"ngFor\",\"ngForOf\"],[1,\"d-flex\",\"flex-column\",\"ticket-container\",3,\"id\",\"click\"],[1,\"overlay\"],[\"title\",\"Telecharger\",1,\"icon\"],[1,\"download\",\"inverted\",\"icon\"],[1,\"ticket-header\"],[\"alt\",\"event image\",\"height\",\"100\",\"width\",\"220\",3,\"src\"],[3,\"allowEmptyString\",\"elementType\",\"errorCorrectionLevel\",\"margin\",\"qrdata\",\"version\",\"width\"],[1,\"ticket-body\"],[1,\"text-uppercase\"],[1,\"w-100\"],[1,\"d-flex\",\"flex-row\",\"justify-content-around\"],[1,\"d-flex\",\"flex-column\",\"justify-content-start\",\"align-items-center\",\"logo-container\"],[\"alt\",\"logo bip\",\"src\",\"../../../assets/images/logo/bip-logo-ticket.jpg\"],[\"alt\",\"logo vendeur\",3,\"src\"],[1,\"d-flex\",\"flex-row\",\"justify-content-end\",\"ticket-footer\"],[1,\"ticket-header\",\"bus\"],[\"alt\",\"sen-dd bus img\",\"height\",\"100\",\"src\",\"../../../assets/images/icons/sen-dd2.jpg\",\"width\",\"220\",1,\"bus\"],[1,\"bus\",3,\"allowEmptyString\",\"elementType\",\"errorCorrectionLevel\",\"margin\",\"qrdata\",\"version\",\"width\"],[1,\"h7\",\"font-weight-bold\",\"mb-1\",\"ml-2\"],[1,\"underlined\"],[1,\"h7\",\"font-weight-bold\",\"mb-1\",\"text-center\",2,\"color\",\"#FF6600\"],[2,\"width\",\"100% !important\"]],template:function(rf,ctx){1&rf&&(core.bd(0,TransactionComponent_div_0_Template,3,0,\"div\",0),core.bd(1,TransactionComponent_div_1_Template,10,3,\"div\",1)),2&rf&&(core.Cc(\"ngIf\",ctx.loading),core.Kb(1),core.Cc(\"ngIf\",!ctx.loading))},directives:[common.r,common.q,angularx_qrcode.a],pipes:[common.A,common.f,common.d],styles:[\".content[_ngcontent-%COMP%] > .description[_ngcontent-%COMP%] > div[_ngcontent-%COMP%], .event-title[_ngcontent-%COMP%]{font-family:Font Awesome\\\\ 5 Free Solid,Open Sans,Ubuntu,Roboto,Helvetica Neue,sans-serif!important}.content[_ngcontent-%COMP%] > .description[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{font-size:14px;font-weight:400;display:flex;flex-flow:row;margin-bottom:3px}.content[_ngcontent-%COMP%] > .description[_ngcontent-%COMP%] > div[_ngcontent-%COMP%] > h6[_ngcontent-%COMP%]{font-weight:500;text-decoration:underline;margin-bottom:0}.download-button[_ngcontent-%COMP%]{background-color:#f60;color:#fff;position:absolute;right:0;top:4px}.my-tickets-container[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-between;flex-wrap:wrap;min-width:100%}.ticket-container[_ngcontent-%COMP%]{margin:0 0 20px;border:.3px solid #dedede;width:-webkit-max-content;width:-moz-max-content;width:max-content;height:-webkit-max-content;height:-moz-max-content;height:max-content;cursor:pointer;position:relative}.ticket-header[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:flex-start;align-items:center;height:170px}.ticket-header.bus[_ngcontent-%COMP%]{height:175px}.ticket-header[_ngcontent-%COMP%] > img[_ngcontent-%COMP%]:not(.bus){z-index:1;width:220px;height:100px}.ticket-header[_ngcontent-%COMP%] > qrcode[_ngcontent-%COMP%]{z-index:2;position:relative;bottom:20px}hr[_ngcontent-%COMP%]{margin:0 2px;border-color:#000}.ticket-body[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:flex-start;align-items:center}.ticket-body[_ngcontent-%COMP%] > span[_ngcontent-%COMP%]{margin-bottom:1px;width:100%;font-size:12px;line-height:17px;text-align:center}.ticket-body[_ngcontent-%COMP%] > span[_ngcontent-%COMP%]:first-child, .ticket-body[_ngcontent-%COMP%] > span[_ngcontent-%COMP%]:last-child{font-size:12px;font-weight:600}.ticket-body[_ngcontent-%COMP%] > span[_ngcontent-%COMP%]:last-child{color:#f60}.logo-container[_ngcontent-%COMP%] > p[_ngcontent-%COMP%]{margin-bottom:1px;font-size:12px}.logo-container[_ngcontent-%COMP%]:first-child > img[_ngcontent-%COMP%]{width:100px;height:45px}.logo-container[_ngcontent-%COMP%]:last-child > img[_ngcontent-%COMP%]{width:45px;height:45px}.ticket-footer[_ngcontent-%COMP%]{background-color:#000;height:20px;color:#fff;font-size:12px;margin-top:2px;padding-right:10px;font-family:open sans,sans-serif;font-weight:500;width:100%}.overlay[_ngcontent-%COMP%]{position:absolute;top:0;bottom:0;left:0;right:0;height:100%;width:100%;opacity:0;transition:.3s ease;z-index:4;background-color:#111}.ticket-container[_ngcontent-%COMP%]:hover   .overlay[_ngcontent-%COMP%]{opacity:.75}.icon[_ngcontent-%COMP%]{color:#f60;font-size:50px;position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);-ms-transform:translate(-50%,-50%);text-align:center}@media screen and (max-width:768px){.my-tickets-container[_ngcontent-%COMP%]{justify-content:space-evenly}}@media print{.ticket-container[_ngcontent-%COMP%]{margin:0!important;page-break-after:always}}\"]}),TransactionComponent})()}];let transaction_routing_module_TransactionRoutingModule=(()=>{class TransactionRoutingModule{}return TransactionRoutingModule.ɵmod=core.Wb({type:TransactionRoutingModule}),TransactionRoutingModule.ɵinj=core.Vb({factory:function(t){return new(t||TransactionRoutingModule)},imports:[[fesm2015_router.g.forChild(routes)],fesm2015_router.g]}),TransactionRoutingModule})(),transaction_module_TransactionModule=(()=>{class TransactionModule{}return TransactionModule.ɵmod=core.Wb({type:TransactionModule}),TransactionModule.ɵinj=core.Vb({factory:function(t){return new(t||TransactionModule)},imports:[[common.c,transaction_routing_module_TransactionRoutingModule,angularx_qrcode.b]]}),TransactionModule})()}}]);","extractedComments":[]}