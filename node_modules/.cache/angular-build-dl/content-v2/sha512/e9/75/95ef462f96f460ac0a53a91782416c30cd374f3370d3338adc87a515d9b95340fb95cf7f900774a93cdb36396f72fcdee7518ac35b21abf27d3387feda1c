(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{DrXB:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return s}));var r=n("3Pt+"),o=n("PoRY");function a(e,t){return n=>{const r=n.controls[t];r.errors&&!r.errors.mustMatch||r.setErrors(n.controls[e].value!==r.value?{mustMatch:!0}:null)}}function i(e){return t=>t.value?r.w.compose(e)(t):null}function s(e,t){return n=>{const r=n.controls[e],a=n.controls[t];a.errors&&!a.errors.checkTelephone||r.errors&&!a.errors.required||(Object(o.c)(a.value,r.value.toUpperCase())?a.setErrors(null):a.setErrors({validPhone:!0}))}}},EhJz:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("/Tr7"),o=n("jIYg");function a(e,t){Object(o.a)(2,arguments);var n=Object(r.a)(e),a=Object(r.a)(t);return n.getTime()>a.getTime()}},Orh4:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("/Tr7"),o=n("jIYg");function a(e,t){Object(o.a)(2,arguments);var n=Object(r.a)(e),a=Object(r.a)(t);return n.getTime()-a.getTime()}},moCM:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("Orh4"),o=n("jIYg");function a(e,t){Object(o.a)(2,arguments);var n=Object(r.a)(e,t)/36e5;return n>0?Math.floor(n):Math.ceil(n)}},oVPa:function(e,t,n){"use strict";n.r(t),n.d(t,"PaymentModule",(function(){return p}));var r=n("ofXK"),o=n("tyNb"),a=n("ywLJ"),i=n("fXoL");const s=[{path:"",component:a.a}];let c=(()=>{class e{}return e.\u0275mod=i.Ob({type:e}),e.\u0275inj=i.Nb({factory:function(t){return new(t||e)},imports:[[o.g.forChild(s)],o.g]}),e})();var u=n("3Pt+"),l=n("0IaG");let p=(()=>{class e{}return e.\u0275mod=i.Ob({type:e}),e.\u0275inj=i.Nb({factory:function(t){return new(t||e)},imports:[[r.c,c,u.i,l.f]]}),e})()},ywLJ:function(e,t,n){"use strict";n.d(t,"a",(function(){return j}));var r=n("fXoL"),o=n("QnqH"),a=n("BapT"),i=n("QmTJ"),s=n("MsxN"),c=n("+0XT"),u=n("PSD3"),l=n.n(u),p=n("PoRY"),d=n("0IaG"),b=n("Da6A"),h=n("un/a"),g=n("ofXK"),f=n("tk/3");let m=(()=>{class e{constructor(e){this.http=e,this.config=new o.a}getCurrencyConverterRate(e,t,n){const r=new f.f({fromObject:{format:"json",from:e,to:t,amount:n.toString()}}),o=new f.e({"x-rapidapi-host":"currency-converter5.p.rapidapi.com","x-rapidapi-key":"67568f8200msh5098fd2bce948a2p156272jsn548d1cf520b5"});return this.http.get("https://currency-converter5.p.rapidapi.com/currency/convert",{headers:o,params:r})}sendNotificationSMS(e,t){return e=e.replace("+",""),this.http.post(`${this.config.mainHost}${this.config.sendSmsNotification}?telephone=${e}`,JSON.stringify(t))}}return e.\u0275fac=function(t){return new(t||e)(r.ec(f.b))},e.\u0275prov=r.Mb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var y=n("3Pt+");function v(e,t){if(1&e&&(r.Wb(0,"option",18),r.Uc(1),r.Vb()),2&e){const e=t.$implicit;r.uc("value",e.code),r.Cb(1),r.Vc(e.name)}}let w=(()=>{class e{constructor(e,t,n,r){this.dialogRef=e,this.data=t,this.datePipe=n,this.currency=r,this.loading=!1,this.countries=(new i.a).countries,this.status=!1,this.scavenger=new c.Scavenger(this)}ngOnInit(){this.payer=this.data.payer,this.price=this.data.price}ngOnDestroy(){}getCountryDialingCode(){return(new s.a).countries.find(e=>e.code.equalIgnoreCase(this.payer.countryCode)).dial_code}cancelRequest(){l.a.fire("Annul\xe9","Vous avez annul\xe9 le processus de paiement","info").then(e=>{e&&(this.data.status="canceled",this.dialogRef.close(this.status))})}validateRequest(){this.checkPhoneNumber()?(this.loading=!0,setTimeout(()=>{l.a.fire({title:"Cash payment",html:'<p class="text-center">Votre reservation a \xe9t\xe9 enregistr\xe9e. Un message vous sera envoy\xe9 avec le code de r\xe9rservation suivant: SN892JI7P<br/><br/>Rendez vous dans le point relais le plus proche pour valider votre reservation avant le '+this.datePipe.transform(Object(b.a)(new Date,5),"EEEE, dd MMMM yyyy \xe0 HH:mm")+"</p>",icon:"success",showCancelButton:!1,confirmButtonText:"OK",allowEnterKey:!0,allowOutsideClick:!1,allowEscapeKey:!1}).then(e=>{if(e){this.loading=!1,this.status=!0;const e="Bonjour, votre r\xe9servation a bien \xe9t\xe9 enregistr\xe9e. Num\xe9ro de votre dossier: SN892JI7P. Rendez-vous au point de relai le plus proche.",t=(new s.a).countries.find(e=>e.code===this.payer.countryCode).dial_code.replace("+","").concat(this.payer.telephone);this.currency.sendNotificationSMS(t,e).pipe(this.scavenger.collect(),Object(h.a)(2)).subscribe(()=>this.dialogRef.close(this.status))}})},1e3)):l.a.fire("Erreur","Ce numero de telephone ne represente pas un numero valide pour le "+this.countries.find(e=>e.code.equalIgnoreCase(this.payer.countryCode)).name)}checkPhoneNumber(){return Object(p.d)(this.payer.telephone,this.payer.countryCode)}}return e.\u0275fac=function(t){return new(t||e)(r.Qb(d.g),r.Qb(d.a),r.Qb(g.f),r.Qb(m))},e.\u0275cmp=r.Kb({type:e,selectors:[["app-cash-payment"]],decls:33,vars:10,consts:[["mat-dialog-title","",1,"d-flex","flex-column","justify-content-start","mb-2"],[1,"d-flex","flex-row","justify-content-between"],["alt","logo BIP","height","80px","src","../../../../assets/images/logo/bip-logo.png","width","130px"],["alt","logo paiement en espece","height","80px","src","../../../../assets/images/icons/cash.jpg","width","80px"],[1,"payment-text"],["mat-dialog-content","",1,"ui","form","w-100","m-0","p-0",3,"ngClass"],[1,"ui","required","field"],["name","firstName","type","text",3,"ngModel","ngModelChange"],["name","lastName","type","text",3,"ngModel","ngModelChange"],[1,"field"],[1,"ui","compact","selection","dropdown",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[1,"ui","labeled","input"],[1,"ui","basic","label"],["name","phone","type","text",1,"phone",3,"ngModel","ngModelChange"],["mat-dialog-actions","",1,"w-100","d-flex","flex-row","justify-content-around","align-items-center"],[1,"ui","gray","button",3,"click"],[1,"ui","orange","button",3,"click"],[3,"value"]],template:function(e,t){1&e&&(r.Wb(0,"div",0),r.Wb(1,"div",1),r.Rb(2,"img",2),r.Rb(3,"img",3),r.Vb(),r.Wb(4,"p",4),r.Uc(5,"Paiement en point de relai"),r.Vb(),r.Vb(),r.Wb(6,"div",5),r.Wb(7,"div",6),r.Wb(8,"label"),r.Uc(9,"Pr\xe9nom"),r.Vb(),r.Wb(10,"input",7),r.ic("ngModelChange",(function(e){return t.payer.firstName=e})),r.Vb(),r.Vb(),r.Wb(11,"div",6),r.Wb(12,"label"),r.Uc(13,"Nom"),r.Vb(),r.Wb(14,"input",8),r.ic("ngModelChange",(function(e){return t.payer.lastName=e})),r.Vb(),r.Vb(),r.Wb(15,"div",9),r.Wb(16,"label"),r.Uc(17,"Pays"),r.Vb(),r.Wb(18,"select",10),r.ic("ngModelChange",(function(e){return t.payer.countryCode=e})),r.Sc(19,v,2,2,"option",11),r.Vb(),r.Vb(),r.Wb(20,"div",6),r.Wb(21,"label"),r.Uc(22,"T\xe9l\xe9phone"),r.Vb(),r.Wb(23,"div",12),r.Wb(24,"div",13),r.Rb(25,"i"),r.Uc(26),r.Vb(),r.Wb(27,"input",14),r.ic("ngModelChange",(function(e){return t.payer.telephone=e})),r.Vb(),r.Vb(),r.Vb(),r.Wb(28,"div",15),r.Wb(29,"button",16),r.ic("click",(function(){return t.cancelRequest()})),r.Uc(30,"Annuler"),r.Vb(),r.Wb(31,"button",17),r.ic("click",(function(){return t.validateRequest()})),r.Uc(32,"Valider"),r.Vb(),r.Vb(),r.Vb()),2&e&&(r.Cb(6),r.uc("ngClass",t.loading?"loading":""),r.Cb(4),r.uc("ngModel",t.payer.firstName),r.Cb(4),r.uc("ngModel",t.payer.lastName),r.Cb(4),r.uc("ngModel",t.payer.countryCode),r.Cb(1),r.uc("ngForOf",t.countries),r.Cb(6),r.Fb("",t.payer.countryCode.toLowerCase()," flag"),r.Cb(1),r.Wc("",t.getCountryDialingCode()," "),r.Cb(1),r.uc("ngModel",t.payer.telephone))},directives:[d.h,d.e,g.o,y.c,y.n,y.q,y.v,g.p,d.c,y.r,y.x],styles:[""]}),e})();var C=n("FfJ/"),M=n("tyNb");let j=(()=>{class e{constructor(e,t){this.cashMatDialog=e,this.router=t,this.loader=new r.n}openCashPaymentDialog(){this.cashMatDialog.open(w,{width:window.innerWidth>400?"400px":"360px",height:"max-content",hasBackdrop:!0,disableClose:!0,closeOnNavigation:!0,data:{payer:new C.a,price:this.paymentRequest.item_price}}).afterClosed().subscribe(()=>{status&&this.router.navigate(["/"])})}pay(){const e=new o.a;this.loader.emit(!0),new PayExpresse({body:JSON.stringify(this.paymentRequest)}).withOption({requestTokenUrl:`${e.mainHost}${e.payExpressPaymentRequest}`,method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},prensentationMode:PayExpresse.OPEN_IN_POPUP,didReceiveNonSuccessResponse(e){if(e.message.toString().includes("[")){const t=e.message.toString().split("[");t[0]="";const n=JSON.parse(t.join("").slice(0,t.join("").length-1).replace("]",""));e.error=n.message,e.message=n.error}(new a.a).ErrorSwalWithNoReturn(e.error,e.message)}}).send()}}return e.\u0275fac=function(t){return new(t||e)(r.Qb(d.b),r.Qb(M.c))},e.\u0275cmp=r.Kb({type:e,selectors:[["app-payment"]],inputs:{payer:"payer",paymentRequest:"paymentRequest"},outputs:{loader:"loader"},decls:5,vars:0,consts:[[1,"w-100","d-flex","flex-row","justify-content-around"],[1,"cursor-pointer",3,"click"],["alt","logo cash payment","src","../../../assets/images/icons/cash.jpg","width","100px"],["alt","Pay with PayExpress","src","../../../assets/images/icons/payexpress.jpg","width","100px"]],template:function(e,t){1&e&&(r.Wb(0,"div",0),r.Wb(1,"div",1),r.ic("click",(function(){return t.openCashPaymentDialog()})),r.Rb(2,"img",2),r.Vb(),r.Wb(3,"div",1),r.ic("click",(function(){return t.pay()})),r.Rb(4,"img",3),r.Vb(),r.Vb())},styles:[""]}),e})()}}]);