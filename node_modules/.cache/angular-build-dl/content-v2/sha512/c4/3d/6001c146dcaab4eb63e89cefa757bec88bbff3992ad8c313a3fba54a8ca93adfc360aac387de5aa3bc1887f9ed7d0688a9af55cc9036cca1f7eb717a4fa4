(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{lKKO:function(e,t,i){"use strict";i.r(t),i.d(t,"AccountModule",(function(){return ht}));var c=i("ofXK"),d=i("tyNb"),n=i("+0XT"),r=i("moCM"),s=i("4+6U"),o=i("EhJz"),a=i("wd/R"),l=i("0IaG"),u=i("MsxN"),f=i("PoRY"),h=i("PSD3"),b=i.n(h),g=i("un/a"),p=i("MlvY"),m=i("fXoL"),v=i("gcxx"),C=i("QnqH"),y=i("jzuh"),I=i("tk/3");let K=(()=>{class e{constructor(e,t){this.cookieService=e,this.http=t,this.url=new C.a}doSharing(e,t,i){return this.http.post(`${this.url.mainHost}/tickets/${t}/sharing`,e,{params:{username:this.getUsername(),dial:i},observe:"response"})}getSharing(e,t){return this.http.get(`${this.url.mainHost}/tickets/${t}/sharing/${e}`,{params:{username:this.getUsername()}})}revokeTicket(e,t){return this.http.get(`${this.url.mainHost}/tickets/${t}/sharing/${e}/revoke`,{params:{username:this.getUsername()},observe:"response"})}attributeTicket(e,t){return this.http.post(`${this.url.mainHost}/tickets/${e}/sharing/${t}/attribute`,null,{params:{username:this.getUsername()},observe:"response"})}getUsername(){return this.cookieService.getCookie("last_email")}}return e.\u0275fac=function(t){return new(t||e)(m.mc(y.a),m.mc(I.b))},e.\u0275prov=m.Ub({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var T=i("AXpb"),k=i("3Pt+");function w(e,t){if(1&e&&(m.ec(0,"tr"),m.ec(1,"td",14),m.dd(2,"Pr\xe9nom:"),m.dc(),m.ec(3,"td"),m.dd(4),m.uc(5,"titlecase"),m.dc(),m.dc()),2&e){const e=m.tc(2);m.Kb(4),m.ed(m.vc(5,1,e.sharedTo.firstName))}}function N(e,t){if(1&e&&(m.ec(0,"tr"),m.ec(1,"td",14),m.dd(2,"Nom:"),m.dc(),m.ec(3,"td"),m.dd(4),m.uc(5,"titlecase"),m.dc(),m.dc()),2&e){const e=m.tc(2);m.Kb(4),m.ed(m.vc(5,1,e.sharedTo.lastName))}}function S(e,t){if(1&e&&(m.ec(0,"tr"),m.ec(1,"td",14),m.dd(2,"T\xe9l\xe9phone:"),m.dc(),m.ec(3,"td"),m.dd(4),m.dc(),m.dc()),2&e){const e=m.tc(2);m.Kb(4),m.ed(e.sharedTo.telephone)}}function E(e,t){if(1&e&&(m.ec(0,"tr"),m.ec(1,"td",14),m.dd(2,"Classe:"),m.dc(),m.ec(3,"td"),m.dd(4),m.dc(),m.dc()),2&e){const e=m.tc(2);m.Kb(4),m.ed(e.item.type)}}function x(e,t){if(1&e&&(m.ec(0,"tr"),m.ec(1,"td",14),m.dd(2,"Type d'\xe9v\xe9nement:"),m.dc(),m.ec(3,"td"),m.dd(4),m.uc(5,"titlecase"),m.dc(),m.dc()),2&e){const e=m.tc(2);m.Kb(4),m.ed(m.vc(5,1,e.event.eventType))}}function M(e,t){if(1&e&&(m.ec(0,"tr"),m.ec(1,"td",14),m.dd(2,"D\xe9signation:"),m.dc(),m.ec(3,"td"),m.dd(4),m.dc(),m.dc()),2&e){const e=m.tc(2);m.Kb(4),m.ed(e.event.designation)}}function q(e,t){if(1&e&&(m.ec(0,"tr"),m.ec(1,"td",14),m.dd(2,"D\xe9but:"),m.dc(),m.ec(3,"td"),m.dd(4),m.uc(5,"date"),m.dc(),m.dc()),2&e){const e=m.tc(2);m.Kb(4),m.gd("",m.xc(5,2,e.item.startingDate,"dd MMMM yyyy","UTC")," \xe1 ",e.event.startingTime,"")}}function O(e,t){if(1&e&&(m.ec(0,"tr"),m.ec(1,"td",14),m.dd(2,"Fin:"),m.dc(),m.ec(3,"td"),m.dd(4),m.uc(5,"date"),m.dc(),m.dc()),2&e){const e=m.tc(2);m.Kb(4),m.gd("",m.xc(5,2,e.item.endingDate,"dd MMMM yyyy","UTC")," \xe1 ",e.event.endingTime,"")}}function D(e,t){if(1&e&&(m.ec(0,"tr"),m.ec(1,"td",14),m.dd(2,"Type transport:"),m.dc(),m.ec(3,"td"),m.dd(4),m.uc(5,"titlecase"),m.dc(),m.dc()),2&e){const e=m.tc(2);m.Kb(4),m.gd("",e.item.transportType+": ","",m.vc(5,2,e.item.transportName),"")}}function P(e,t){if(1&e&&(m.ec(0,"tr"),m.ec(1,"td",14),m.dd(2,"Date:"),m.dc(),m.ec(3,"td"),m.dd(4),m.uc(5,"titlecase"),m.uc(6,"date"),m.dc(),m.dc()),2&e){const e=m.tc(2);m.Kb(4),m.gd("",m.vc(5,2,m.xc(6,4,e.item.departDate,"dd MMMM yyyy","UTC"))," \xe1 ",e.item.departTime,"")}}function L(e,t){if(1&e&&(m.ec(0,"tr"),m.ec(1,"td",14),m.dd(2,"D\xe9part:"),m.dc(),m.ec(3,"td"),m.dd(4),m.uc(5,"titlecase"),m.dc(),m.dc()),2&e){const e=m.tc(2);m.Kb(4),m.ed(m.vc(5,1,e.item.departLocation))}}function V(e,t){if(1&e&&(m.ec(0,"tr"),m.ec(1,"td",14),m.dd(2,"Destination:"),m.dc(),m.ec(3,"td"),m.dd(4),m.uc(5,"titlecase"),m.dc(),m.dc()),2&e){const e=m.tc(2);m.Kb(4),m.ed(m.vc(5,1,e.item.arrivalLocation))}}function F(e,t){if(1&e&&(m.ec(0,"tr"),m.ec(1,"td",14),m.dd(2,"Lieu:"),m.dc(),m.ec(3,"td"),m.dd(4),m.uc(5,"titlecase"),m.dc(),m.dc()),2&e){const e=m.tc(2);m.Kb(4),m.ed(m.vc(5,1,e.event.place.designation))}}function R(e,t){if(1&e&&(m.ec(0,"div",12),m.ec(1,"table",13),m.ec(2,"tbody"),m.ec(3,"tr"),m.ec(4,"td",14),m.dd(5,"Code billet:"),m.dc(),m.ec(6,"td"),m.dd(7),m.dc(),m.dc(),m.bd(8,w,6,3,"tr",15),m.bd(9,N,6,3,"tr",15),m.bd(10,S,5,1,"tr",15),m.bd(11,E,5,1,"tr",15),m.bd(12,x,6,3,"tr",15),m.bd(13,M,5,1,"tr",15),m.bd(14,q,6,6,"tr",15),m.bd(15,O,6,6,"tr",15),m.bd(16,D,6,4,"tr",15),m.bd(17,P,7,8,"tr",15),m.bd(18,L,6,3,"tr",15),m.bd(19,V,6,3,"tr",15),m.bd(20,F,6,3,"tr",15),m.ec(21,"tr"),m.ec(22,"td",14),m.dd(23,"ID transaction:"),m.dc(),m.ec(24,"td"),m.dd(25),m.dc(),m.dc(),m.ec(26,"tr"),m.ec(27,"td",14),m.dd(28,"Pay\xe9 avec:"),m.dc(),m.ec(29,"td"),m.dd(30),m.uc(31,"titlecase"),m.dc(),m.dc(),m.ec(32,"tr"),m.ec(33,"td",14),m.dd(34,"Date transaction:"),m.dc(),m.ec(35,"td"),m.dd(36),m.uc(37,"titlecase"),m.uc(38,"date"),m.uc(39,"date"),m.dc(),m.dc(),m.ec(40,"tr"),m.ec(41,"td",14),m.dd(42,"Prix:"),m.dc(),m.ec(43,"td"),m.dd(44),m.uc(45,"currency"),m.dc(),m.dc(),m.dc(),m.dc(),m.dc()),2&e){const e=m.tc();m.Kb(7),m.ed(e.item.isShared?"PARTAGER":e.item.codeTicket),m.Kb(1),m.Cc("ngIf",e.item.isShared),m.Kb(1),m.Cc("ngIf",e.item.isShared),m.Kb(1),m.Cc("ngIf",e.item.isShared),m.Kb(1),m.Cc("ngIf","event"===e.type&&void 0!==e.event),m.Kb(1),m.Cc("ngIf","event"===e.type&&void 0!==e.event),m.Kb(1),m.Cc("ngIf","event"===e.type&&void 0!==e.event),m.Kb(1),m.Cc("ngIf","event"==e.type&&void 0!==e.event),m.Kb(1),m.Cc("ngIf","event"===e.type&&void 0!==e.event),m.Kb(1),m.Cc("ngIf","transport"===e.type),m.Kb(1),m.Cc("ngIf","transport"===e.type),m.Kb(1),m.Cc("ngIf","transport"===e.type),m.Kb(1),m.Cc("ngIf","transport"===e.type),m.Kb(1),m.Cc("ngIf","event"===e.type&&void 0!==e.event),m.Kb(5),m.ed(e.item.transactionNumber),m.Kb(5),m.ed(null==e.item.transactionType?"Ind\xe9fini":m.vc(31,19,e.item.transactionType)),m.Kb(6),m.gd("",m.vc(37,21,m.xc(38,23,e.item.updatedAt,"dd MMMM yyyy","UTC"))," ",m.xc(39,27,e.item.updatedAt,"\xe1 HH:MM","UTC"),""),m.Kb(8),m.ed(m.yc(45,31,e.item.totalPrice,"XOF","symbol","1.1-2"))}}function A(e,t){1&e&&(m.ec(0,"div"),m.ec(1,"p",24),m.dd(2,"Ce champ est requis"),m.dc(),m.dc())}function U(e,t){1&e&&(m.ec(0,"div"),m.ec(1,"p",24),m.dd(2,"Ce champ est requis"),m.dc(),m.dc())}function $(e,t){if(1&e&&(m.ec(0,"option",25),m.dd(1),m.dc()),2&e){const e=t.$implicit;m.Cc("value",e.code),m.Kb(1),m.ed(e.dial_code)}}function H(e,t){1&e&&(m.ec(0,"p",24),m.dd(1,"Ce champ est requis"),m.dc())}function j(e,t){1&e&&(m.ec(0,"p",24),m.dd(1,"Le format de votre t\xe9l\xe9phone n'est pas valide."),m.dc())}function z(e,t){if(1&e&&(m.ec(0,"div"),m.bd(1,H,2,0,"p",26),m.bd(2,j,2,0,"p",26),m.dc()),2&e){const e=m.tc(2);m.Kb(1),m.Cc("ngIf",e.fieldValidity.get("telephone").includes("required")),m.Kb(1),m.Cc("ngIf",e.fieldValidity.get("telephone").includes("badFormat"))}}function Y(e,t){if(1&e){const e=m.fc();m.ec(0,"div",16),m.ec(1,"div",17),m.ec(2,"label"),m.dd(3,"Pr\xe9nom"),m.dc(),m.ec(4,"input",18),m.qc("focusin",(function(){return m.Tc(e),m.tc().fieldValidity.delete("firstName")}))("focusout",(function(){return m.Tc(e),m.tc().checkFields("firstName")}))("ngModelChange",(function(t){return m.Tc(e),m.tc().sharedTo.firstName=t})),m.dc(),m.bd(5,A,3,0,"div",15),m.dc(),m.ec(6,"div",17),m.ec(7,"label"),m.dd(8,"Nom"),m.dc(),m.ec(9,"input",19),m.qc("focusin",(function(){return m.Tc(e),m.tc().fieldValidity.delete("lastName")}))("focusout",(function(){return m.Tc(e),m.tc().checkFields("lastName")}))("ngModelChange",(function(t){return m.Tc(e),m.tc().sharedTo.lastName=t})),m.dc(),m.bd(10,U,3,0,"div",15),m.dc(),m.ec(11,"div",17),m.ec(12,"label"),m.dd(13,"T\xe9l\xe9phone"),m.dc(),m.ec(14,"div",20),m.ec(15,"select",21),m.qc("ngModelChange",(function(t){return m.Tc(e),m.tc().sharedTo.countryCode=t})),m.bd(16,$,2,2,"option",22),m.dc(),m.ec(17,"input",23),m.qc("focusout",(function(){return m.Tc(e),m.tc().checkFields("telephone")}))("keyup",(function(){return m.Tc(e),m.tc().formatNumber()}))("ngModelChange",(function(t){return m.Tc(e),m.tc().sharedTo.telephone=t})),m.dc(),m.dc(),m.bd(18,z,3,2,"div",15),m.dc(),m.dc()}if(2&e){const e=m.tc();m.Kb(1),m.Cc("ngClass",e.fieldValidity.has("firstName")?"error":""),m.Kb(3),m.Cc("ngModel",e.sharedTo.firstName),m.Kb(1),m.Cc("ngIf",e.fieldValidity.has("firstName")),m.Kb(1),m.Cc("ngClass",e.fieldValidity.has("lastName")?"error":""),m.Kb(3),m.Cc("ngModel",e.sharedTo.lastName),m.Kb(1),m.Cc("ngIf",e.fieldValidity.has("lastName")),m.Kb(1),m.Cc("ngClass",e.fieldValidity.has("telephone")?"error":""),m.Kb(4),m.Cc("ngModel",e.sharedTo.countryCode),m.Kb(1),m.Cc("ngForOf",e.countries),m.Kb(1),m.Cc("ngModel",e.sharedTo.telephone),m.Kb(1),m.Cc("ngIf",e.fieldValidity.has("telephone"))}}function X(e,t){1&e&&(m.ec(0,"button",27),m.dd(1,"Fermer"),m.dc())}function Z(e,t){if(1&e){const e=m.fc();m.ec(0,"button",28),m.qc("click",(function(){return m.Tc(e),m.tc().sharing=!0})),m.dd(1,"Partager"),m.dc()}}function _(e,t){if(1&e){const e=m.fc();m.ec(0,"button",28),m.qc("click",(function(){return m.Tc(e),m.tc().revokeSharing()})),m.dd(1," Supprimer le partage "),m.dc()}}function B(e,t){if(1&e){const e=m.fc();m.ec(0,"button",29),m.qc("click",(function(){return m.Tc(e),m.tc().attributeTicket()})),m.dd(1," Attribuer le ticket "),m.dc()}}function G(e,t){if(1&e){const e=m.fc();m.ec(0,"button",30),m.qc("click",(function(){return m.Tc(e),m.tc().cancelSharing()})),m.dd(1,"Annuler"),m.dc()}}function J(e,t){if(1&e){const e=m.fc();m.ec(0,"button",28),m.qc("click",(function(){return m.Tc(e),m.tc().doSharing()})),m.dd(1,"Valider"),m.dc()}}class W{constructor(){this.ticketId="",this.firstName="",this.lastName="",this.telephone="",this.countryCode="SN"}}let Q=(()=>{class e{constructor(e,t,i,c,d){this.dialogRef=e,this.data=t,this.eventService=i,this.sharingService=c,this.errorHandler=d,this.loading=!0,this.sharing=!1,this.sharedTo=new W,this.countries=(new u.a).countries,this.fieldValidity=new Map,this.scavenger=new n.Scavenger(this)}ngOnDestroy(){}ngOnInit(){this.loading=!0,this.type=this.data.type,"transport"===this.type?this.item=this.data.item:"event"===this.type&&(this.item=this.data.item,this.getEvent(this.item.eventId)),this.item.isShared?this.getSharing():this.loading=!1}formatNumber(){this.sharedTo.telephone=Object(f.b)(this.sharedTo.telephone,this.sharedTo.countryCode)}checkFields(e){const t=[];0===this.sharedTo[e].length?t.push("required"):"telephone"!==e||Object(f.d)(this.sharedTo.telephone,this.sharedTo.countryCode)||t.push("badFormat"),t.length>0?this.fieldValidity.set(e,t):this.fieldValidity.delete(e)}cancelSharing(){this.sharedTo=new W,this.fieldValidity.clear(),this.sharing=!1}doSharing(){if(this.loading=!0,Array.of("firstName","lastName","telephone").forEach(e=>this.checkFields(e)),this.fieldValidity.size>0)b.a.fire("Erreur","Veuillez corriger le formulaire!","error");else{this.sharedTo.ticketId=this.item.codeTicket,this.sharedTo.telephone=this.sharedTo.telephone.split(" ").join("");const e=this.countries.find(e=>e.code===this.sharedTo.countryCode).dial_code.replace("+","");this.sharingService.doSharing(JSON.stringify(this.sharedTo),this.type,e).pipe(this.scavenger.collect(),Object(g.a)(2)).subscribe(e=>{if(200===e.status){const e=this.type="le d\xe9but de l'\xe9v\xe9nement";this.messageDialog("Partage","<p>Le partage du ticket num\xe9ro "+this.sharedTo.ticketId+" a r\xe9ussi. Un SMS de confirmation a \xe9t\xe9 envoy\xe9 a "+this.sharedTo.firstName+" "+this.sharedTo.lastName+".Vous pouvez r\xe9voquer le partage de ce ticket depuis votre espace personnel. <br/> <strong> VEUILLEZ NOTER: </strong> Vous ne pourrez plus retirer ce billet au nouveau d\xe9tenteur s'il reste moins d'une heure avant "+e+"</p>","success")}else 404===e.status&&this.errorDialog()},e=>{this.errorHandler.handleError(e),this.loading=!1})}}revokeSharing(){this.loading=!0,this.sharingService.revokeTicket(this.item.sharingId,this.type).pipe(this.scavenger.collect()).subscribe(e=>{e.ok?this.messageDialog("Reussi","Le partage de ce ticket a \xe9t\xe9 supprim\xe9 avec succ\xe8s. Vous \xeates \xe0 nouveau son titulaire.","success"):this.errorDialog()},e=>{this.errorHandler.handleError(e),this.loading=!1})}attributeTicket(){const e=`<strong>${p(this.sharedTo.firstName)} ${p(this.sharedTo.lastName)}</strong>`;b.a.fire({title:"Attribution de ticket",html:"<p>Vous \xeates sur le point d'attribuer le ticket \xe0 "+e+". Une fois l'attribution effectu\xe9e, vous ne pourrez plus effectuer aucune action sur ce ticket. "+e+" deviendra le nouveau propri\xe9taire du ticket. Souhaitez-vous continuer ?</p>",icon:"question",allowEscapeKey:!1,allowEnterKey:!1,allowOutsideClick:!1,showCloseButton:!1,showCancelButton:!0,cancelButtonText:"Non",confirmButtonText:"Oui",focusConfirm:!0,cancelButtonColor:"red",confirmButtonColor:"green"}).then(e=>{e.value?this.doAttribution():e.dismiss&&b.a.fire("Attribution","L'attribution du ticket a \xe9t\xe9 annul\xe9!","info")})}doAttribution(){this.sharingService.attributeTicket(this.type,this.item.sharingId).pipe(Object(g.a)(2),this.scavenger.collect()).subscribe(e=>{e.ok?this.messageDialog("Attribution","Le ticket a \xe9t\xe9 attribu\xe9 avec succ\xe8s.","success"):this.messageDialog("Attribution","L'attribution du ticket a \xe9chou\xe9. Veuillez r\xe9essayer SVP.","error")},e=>{this.errorHandler.handleError(e),this.loading=!1})}getEvent(e){this.eventService.getAnEvent(e).pipe(this.scavenger.collect(),Object(g.a)(2)).subscribe(e=>this.event=e,e=>{this.errorHandler.handleError(e),this.loading=!1},()=>{this.item.isShared?this.getSharing():this.loading=!1})}getSharing(){this.sharingService.getSharing(this.item.sharingId,this.type).pipe(this.scavenger.collect(),Object(g.a)(2)).subscribe(e=>{this.sharedTo=e,this.formatNumber()},e=>{this.errorHandler.handleError(e),this.loading=!1},()=>this.loading=!1)}messageDialog(e,t,i){b.a.fire({title:e,html:t,icon:i,showCloseButton:!1,allowEnterKey:!1,allowOutsideClick:!1,allowEscapeKey:!1}).then(e=>{e.value&&location.reload()})}errorDialog(){b.a.fire("Erreur","Une erreur est survenue. Veuillez r\xe9essayer SVP!","error").then(e=>{e&&(this.loading=!1)})}}return e.\u0275fac=function(t){return new(t||e)(m.Yb(l.g),m.Yb(l.a),m.Yb(v.a),m.Yb(K),m.Yb(T.a))},e.\u0275cmp=m.Sb({type:e,selectors:[["app-details-ticket"]],decls:16,vars:10,consts:[[1,"ui","very","raised","segments"],[1,"ui","inverted","dimmer",3,"ngClass"],[1,"ui","text","loader"],["mat-dialog-title","",1,"ui","segment"],[1,"ui","header"],["class","ui segment fluid pt-1 pb-2",4,"ngIf"],["class","ui segment form fluid pt-1 pb-2",4,"ngIf"],[1,"ui","segment","d-flex","flex-row","justify-content-end","fluid"],["class","ui orange large button right floated mr-3","mat-dialog-close","",4,"ngIf"],["class","ui green large button right floated",3,"click",4,"ngIf"],["class","ui violet large button right floated",3,"click",4,"ngIf"],["class","ui teal large button right floated",3,"click",4,"ngIf"],[1,"ui","segment","fluid","pt-1","pb-2"],[1,"ui","very","basic","table"],[1,"right","aligned"],[4,"ngIf"],[1,"ui","segment","form","fluid","pt-1","pb-2"],[1,"required","field",3,"ngClass"],["name","fName","type","text",3,"ngModel","focusin","focusout","ngModelChange"],["name","lName","type","text",3,"ngModel","focusin","focusout","ngModelChange"],[1,"ui","left","labeled","input"],["name","code",1,"ui","dropdown","selection","share-tel","mr-2","mb-0","h6",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["name","telephone","placeholder","Telephone",3,"ngModel","focusout","keyup","ngModelChange"],[1,"error"],[3,"value"],["class","error",4,"ngIf"],["mat-dialog-close","",1,"ui","orange","large","button","right","floated","mr-3"],[1,"ui","green","large","button","right","floated",3,"click"],[1,"ui","violet","large","button","right","floated",3,"click"],[1,"ui","teal","large","button","right","floated",3,"click"]],template:function(e,t){1&e&&(m.ec(0,"div",0),m.ec(1,"div",1),m.ec(2,"div",2),m.dd(3,"Chargement"),m.dc(),m.dc(),m.ec(4,"div",3),m.ec(5,"p",4),m.dd(6),m.dc(),m.dc(),m.bd(7,R,46,36,"div",5),m.bd(8,Y,19,11,"div",6),m.ec(9,"div",7),m.bd(10,X,2,0,"button",8),m.bd(11,Z,2,0,"button",9),m.bd(12,_,2,0,"button",9),m.bd(13,B,2,0,"button",10),m.bd(14,G,2,0,"button",11),m.bd(15,J,2,0,"button",9),m.dc(),m.dc()),2&e&&(m.Kb(1),m.Cc("ngClass",t.loading?"active":""),m.Kb(5),m.ed(t.sharing?"Partage de ticket":"Details Billet"),m.Kb(1),m.Cc("ngIf",!t.sharing),m.Kb(1),m.Cc("ngIf",t.sharing),m.Kb(2),m.Cc("ngIf",!t.sharing),m.Kb(1),m.Cc("ngIf",!t.sharing&&!t.item.isShared),m.Kb(1),m.Cc("ngIf",!t.sharing&&t.item.isShared),m.Kb(1),m.Cc("ngIf",!t.sharing&&t.item.isShared),m.Kb(1),m.Cc("ngIf",t.sharing),m.Kb(1),m.Cc("ngIf",t.sharing))},directives:[c.p,l.h,c.r,k.c,k.n,k.q,k.w,c.q,k.r,k.y,l.d],pipes:[c.A,c.f,c.d],styles:['.ui[class*="very basic"].table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:first-child{font-weight:600;font-size:15px;padding-right:15px!important}.ui[class*="very basic"].table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{color:#444;padding:7px 0!important}.share-tel[_ngcontent-%COMP%]{min-width:auto!important;width:100px!important;padding-right:0!important}']}),e})();var ee=i("xG9w");let te=(()=>{class e{constructor(e,t){this.cookiesService=e,this.http=t,this.urls=new C.a}getUser(){return this.http.get(`${this.urls.mainHost}/user/search`,{params:{username:this.getUsername()}})}getTransportTickets(){return this.http.get(`${this.urls.mainHost}/user/${this.getUsername()}/tickets/transport`)}getEventTickets(){return this.http.get(`${this.urls.mainHost}/user/${this.getUsername()}/tickets/event`)}updatePassword(e,t){return this.http.post(`${this.urls.mainHost}/password`,JSON.stringify({username:this.getUsername(),oldPassword:e,newPassword:t}),{observe:"response"})}updateUser(e){return this.http.post(`${this.urls.mainHost}/user/${this.getUsername()}/profile`,JSON.stringify(e),{observe:"response"})}getUsername(){return this.cookiesService.getCookie("last_email")}}return e.\u0275fac=function(t){return new(t||e)(m.mc(y.a),m.mc(I.b))},e.\u0275prov=m.Ub({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();function ie(e,t){1&e&&(m.ec(0,"div",2),m.ec(1,"div",3),m.dd(2,"Chargement"),m.dc(),m.dc())}function ce(e,t){1&e&&(m.ec(0,"td",18),m.dd(1,"EXPIR\xe9e"),m.dc())}function de(e,t){1&e&&(m.ec(0,"td",19),m.dd(1,"PARTAGER"),m.dc())}function ne(e,t){if(1&e&&(m.ec(0,"td"),m.dd(1),m.uc(2,"titlecase"),m.uc(3,"date"),m.dc()),2&e){const e=m.tc().$implicit,t=m.tc(4);m.Kb(1),m.gd(" ",m.vc(2,2,m.xc(3,4,t.pipeDate(e.departDate),"dd MMMM yyyy","UTC"))," \xe1 ",e.departTime," ")}}function re(e,t){if(1&e){const e=m.fc();m.ec(0,"tr",14),m.qc("click",(function(){m.Tc(e);const i=t.$implicit;return m.tc(4).ticketDetails(i,"transport")})),m.bd(1,ce,2,0,"td",15),m.bd(2,de,2,0,"td",16),m.bd(3,ne,4,8,"td",12),m.ec(4,"td"),m.dd(5),m.uc(6,"titlecase"),m.dc(),m.ec(7,"td"),m.dd(8),m.uc(9,"titlecase"),m.dc(),m.ec(10,"td",17),m.dd(11),m.dc(),m.ec(12,"td",17),m.dd(13),m.uc(14,"titlecase"),m.dc(),m.dc()}if(2&e){const e=t.$implicit;m.Cc("ngClass","EXPIRER"===e.codeTicket?"center aligned clear":"center aligned cursor-pointer"),m.Kb(1),m.Cc("ngIf","EXPIRER"===e.codeTicket),m.Kb(1),m.Cc("ngIf","EXPIRER"!==e.codeTicket&&e.isShared),m.Kb(1),m.Cc("ngIf","EXPIRER"!==e.codeTicket&&!e.isShared),m.Kb(2),m.ed(m.vc(6,10,e.departLocation)),m.Kb(3),m.ed(m.vc(9,12,e.arrivalLocation)),m.Kb(2),m.Cc("ngClass","EXPIRER"===e.codeTicket?"strikeout":""),m.Kb(1),m.ed(e.transportType),m.Kb(1),m.Cc("ngClass","EXPIRER"===e.codeTicket?"strikeout":""),m.Kb(1),m.ed(m.vc(14,14,e.transportName))}}function se(e,t){if(1&e&&(m.ec(0,"tbody"),m.bd(1,re,15,16,"tr",13),m.dc()),2&e){const e=m.tc(3);m.Kb(1),m.Cc("ngForOf",e.transportTickets)}}function oe(e,t){1&e&&(m.ec(0,"tr",9),m.ec(1,"td",21),m.dd(2,"Aucun billet disponible"),m.dc(),m.dc())}function ae(e,t){if(1&e&&(m.ec(0,"tbody"),m.bd(1,oe,3,0,"tr",20),m.dc()),2&e){const e=m.tc(3);m.Kb(1),m.Cc("ngForOf",e.transportTickets)}}function le(e,t){if(1&e&&(m.ec(0,"table",8),m.ec(1,"thead"),m.ec(2,"tr",9),m.ec(3,"th",10),m.dd(4,"Date"),m.dc(),m.ec(5,"th",11),m.dd(6,"Itineraire"),m.dc(),m.ec(7,"th",11),m.dd(8,"Transport"),m.dc(),m.dc(),m.ec(9,"tr",9),m.ec(10,"th"),m.dd(11,"D\xe9part"),m.dc(),m.ec(12,"th"),m.dd(13,"Arriv\xe9"),m.dc(),m.ec(14,"th"),m.dd(15,"Type"),m.dc(),m.ec(16,"th"),m.dd(17,"D\xe9signation"),m.dc(),m.dc(),m.dc(),m.bd(18,se,2,1,"tbody",12),m.bd(19,ae,2,1,"tbody",12),m.dc()),2&e){const e=m.tc(2);m.Kb(18),m.Cc("ngIf",e.transportTickets&&e.transportTickets.length>0),m.Kb(1),m.Cc("ngIf",e.transportTickets&&0===e.transportTickets.length)}}function ue(e,t){1&e&&(m.ec(0,"td",19),m.dd(1,"PARTAGER"),m.dc())}function fe(e,t){if(1&e&&(m.ec(0,"td"),m.dd(1),m.uc(2,"titlecase"),m.uc(3,"date"),m.dc()),2&e){const e=m.tc().$implicit,t=m.tc(3);m.Kb(1),m.fd(" ",m.vc(2,1,m.xc(3,3,t.getLinkedEvent(e).startingDate,"dd MMMM yyyy","UTC"))," ")}}function he(e,t){1&e&&(m.ec(0,"td",18),m.dd(1,"EXPIR\xe9e"),m.dc())}function be(e,t){if(1&e){const e=m.fc();m.ec(0,"tr",14),m.qc("click",(function(){m.Tc(e);const i=t.$implicit;return m.tc(3).ticketDetails(i,"event")})),m.bd(1,ue,2,0,"td",16),m.bd(2,fe,4,7,"td",12),m.bd(3,he,2,0,"td",15),m.ec(4,"td"),m.dd(5),m.uc(6,"titlecase"),m.dc(),m.ec(7,"td"),m.dd(8),m.uc(9,"titlecase"),m.dc(),m.ec(10,"td"),m.dd(11),m.dc(),m.ec(12,"td"),m.dd(13),m.uc(14,"currency"),m.dc(),m.dc()}if(2&e){const e=t.$implicit,i=m.tc(3);m.Cc("ngClass","EXPIRER"===e.codeTicket?"center aligned clear":"center aligned cursor-pointer"),m.Kb(1),m.Cc("ngIf","EXPIRER"!==e.codeTicket&&e.isShared),m.Kb(1),m.Cc("ngIf","EXPIRER"!==e.codeTicket&&!e.isShared),m.Kb(1),m.Cc("ngIf","EXPIRER"===e.codeTicket),m.Kb(2),m.ed(m.vc(6,8,i.getLinkedEvent(e).designation)),m.Kb(3),m.ed(m.vc(9,10,i.getLinkedEvent(e).place.designation)),m.Kb(3),m.ed(e.type),m.Kb(2),m.ed(m.yc(14,12,e.totalPrice,"XOF","symbol","1.1-2"))}}function ge(e,t){if(1&e&&(m.ec(0,"table",8),m.ec(1,"thead"),m.ec(2,"tr",9),m.ec(3,"th",22),m.dd(4,"Date"),m.dc(),m.ec(5,"th"),m.dd(6,"D\xe9signation"),m.dc(),m.ec(7,"th"),m.dd(8,"Lieu"),m.dc(),m.ec(9,"th"),m.dd(10,"Classe"),m.dc(),m.ec(11,"th"),m.dd(12,"Prix"),m.dc(),m.dc(),m.dc(),m.ec(13,"tbody"),m.bd(14,be,15,17,"tr",13),m.dc(),m.dc()),2&e){const e=m.tc(2);m.Kb(14),m.Cc("ngForOf",e.eventTickets)}}function pe(e,t){if(1&e&&(m.ec(0,"div",4),m.ec(1,"div",5),m.ec(2,"div",6),m.dd(3,"Mes titres de transport"),m.dc(),m.bd(4,le,20,2,"table",7),m.ec(5,"div",6),m.dd(6,"Mes tickets d'evenement"),m.dc(),m.bd(7,ge,15,1,"table",7),m.dc(),m.dc()),2&e){const e=m.tc();m.Kb(4),m.Cc("ngIf",e.transportTickets),m.Kb(3),m.Cc("ngIf",e.eventTickets)}}let me=(()=>{class e{constructor(e,t,i,c){this.userService=e,this.eventService=t,this.errorHandler=i,this.dialog=c,this.scavenger=new n.Scavenger(this)}ngOnInit(){this.getTransportTickets(),this.getEventTickets()}ngOnDestroy(){}ticketDetails(e,t){this.dialog.open(Q,{width:window.innerWidth>400?"550px":"380px",height:"max-content",id:"user-details-ticket-dialog",hasBackdrop:!0,disableClose:!0,closeOnNavigation:!0,data:{type:t,item:e}}).afterClosed().subscribe(e=>{})}pipeDate(e){return new Date(e)}getLinkedEvent(e){return this.events.find(t=>t.eventId===e.eventId)}checkExpiry(e){const t=new Date(e.departDate),i=e.departTime.toString().split(":");return t.setHours(Number(i[0])),t.setMinutes(Number(i[1])),Object(r.a)(Object(s.a)(t.toISOString()),new Date(Object(a.now)()))<1}getTransportTickets(){this.userService.getTransportTickets().pipe(this.scavenger.collect()).subscribe(e=>{e.forEach(e=>{this.checkExpiry(e)&&(e.codeTicket="EXPIRER")}),this.transportTickets=e},e=>{this.errorHandler.handleError(e),location.reload()})}getEventTickets(){this.userService.getEventTickets().pipe(this.scavenger.collect()).subscribe(e=>{const t=ee.e(e.map(e=>e.eventId));this.getEvents(t,e)},e=>{this.errorHandler.handleError(e),location.reload()})}getEvents(e,t){this.eventService.getListedEvents(e).pipe(this.scavenger.collect()).subscribe(e=>{this.events=e,e.forEach(e=>{Object(o.a)(Object(s.a)(e.startingDate.toString()),new Date(Object(a.now)()))||(t.find(t=>t.eventId===e.eventId).codeTicket="EXPIRER")})},e=>{this.errorHandler.handleError(e),location.reload()},()=>this.eventTickets=t)}}return e.\u0275fac=function(t){return new(t||e)(m.Yb(te),m.Yb(v.a),m.Yb(T.a),m.Yb(l.b))},e.\u0275cmp=m.Sb({type:e,selectors:[["app-my-tickets"]],decls:2,vars:2,consts:[["class","ui active dimmer h-100 w-100",4,"ngIf"],["class","container mt-3 mb-3",4,"ngIf"],[1,"ui","active","dimmer","h-100","w-100"],[1,"ui","active","huge","text","inverted","loader"],[1,"container","mt-3","mb-3"],[1,"ui","raised","segment"],[1,"ui","header","text-center"],["class","ui mini table celled very compact striped structured selectable",4,"ngIf"],[1,"ui","mini","table","celled","very","compact","striped","structured","selectable"],[1,"center","aligned"],["rowspan","2",2,"width","200px"],["colspan","2"],[4,"ngIf"],[3,"ngClass","click",4,"ngFor","ngForOf"],[3,"ngClass","click"],["class","transport-expired text-uppercase",4,"ngIf"],["class","ticket-shared",4,"ngIf"],[3,"ngClass"],[1,"transport-expired","text-uppercase"],[1,"ticket-shared"],["class","center aligned",4,"ngFor","ngForOf"],["colspan","9"],[2,"width","150px"]],template:function(e,t){1&e&&(m.bd(0,ie,3,0,"div",0),m.bd(1,pe,8,2,"div",1)),2&e&&(m.Cc("ngIf",!t.transportTickets||!t.eventTickets),m.Kb(1),m.Cc("ngIf",t.transportTickets&&t.eventTickets))},directives:[c.r,c.q,c.p],pipes:[c.A,c.f,c.d],styles:["tr.clear[_ngcontent-%COMP%]{cursor:default;pointer-events:none}.transport-expired[_ngcontent-%COMP%]{background-color:red;color:#fff;font-weight:700}.strikeout[_ngcontent-%COMP%]{-webkit-text-decoration-line:line-through;text-decoration-line:line-through}.ticket-shared[_ngcontent-%COMP%]{background-color:green;color:#fff;font-weight:700}"]}),e})();var ve=i("LG61"),Ce=i("DrXB"),ye=i("qIOU");function Ie(e,t){1&e&&(m.ec(0,"div",16),m.dd(1,"Ce champ est requis."),m.dc())}function Ke(e,t){if(1&e&&(m.ec(0,"div"),m.bd(1,Ie,2,0,"div",15),m.dc()),2&e){const e=m.tc();m.Kb(1),m.Cc("ngIf",e.f.old.errors.required)}}function Te(e,t){1&e&&(m.ec(0,"div",16),m.dd(1,"Ce champ est requis."),m.dc())}function ke(e,t){1&e&&(m.ec(0,"div",16),m.dd(1,"Veuillez saisir au moins huit caracteres."),m.dc())}function we(e,t){if(1&e&&(m.ec(0,"div"),m.bd(1,Te,2,0,"div",15),m.bd(2,ke,2,0,"div",15),m.dc()),2&e){const e=m.tc();m.Kb(1),m.Cc("ngIf",e.f.new.errors.required),m.Kb(1),m.Cc("ngIf",e.f.new.errors.minlength)}}function Ne(e,t){1&e&&(m.ec(0,"div",16),m.dd(1,"Ce champ est requis."),m.dc())}function Se(e,t){1&e&&(m.ec(0,"div",16),m.dd(1,"Les mot de passe ne correspondent pas!"),m.dc())}function Ee(e,t){if(1&e&&(m.ec(0,"div"),m.bd(1,Ne,2,0,"div",15),m.bd(2,Se,2,0,"div",15),m.dc()),2&e){const e=m.tc();m.Kb(1),m.Cc("ngIf",e.f.confirm.errors.required),m.Kb(1),m.Cc("ngIf",e.f.confirm.errors.mustMatch)}}let xe=(()=>{class e{constructor(e,t,i,c,d,r){this.dialogRef=e,this.data=t,this.formBuilder=i,this.userService=c,this.authService=d,this.errorHandler=r,this.loading=!1,this.submitted=!1,this.showPassword=!1,this.scavenger=new n.Scavenger(this)}get f(){return this.resetForm.controls}ngOnDestroy(){}ngOnInit(){this.resetForm=this.formBuilder.group({old:["",[k.x.required]],new:["",[k.x.required,k.x.minLength(8)]],confirm:["",k.x.required]},{validator:Object(Ce.a)("new","confirm")})}onSubmit(){this.submitted=!0,this.resetForm.invalid||this.userService.updatePassword(this.f.old.value,this.f.new.value).pipe(this.scavenger.collect(),Object(g.a)(2)).subscribe(e=>{"EXPECTATION_FAILED"===e.body?b.a.fire("Erreur","L'ancien mot de passe que vous avez entr\xe9 est incorrect. Veuillez le corriger!","error"):"NOT_MODIFIED"===e.body?b.a.fire("Erreur","L'ancien mot de passe et le nouveau ne peuvent pas \xeatre identiques","info"):b.a.fire({title:"R\xe9ussi",html:"Votre mot de passe a \xe9t\xe9 modifi\xe9 avec succ\xe8s. Vous serez d\xe9connect\xe9. Veuillez vous connecter en utilisant votre nouveau mot de passe.",icon:"success",allowOutsideClick:!1,allowEnterKey:!1,allowEscapeKey:!1,showCloseButton:!1,showCancelButton:!1}).then(e=>{e&&this.authService.logout()})},e=>this.errorHandler.handleError(e))}onReset(){this.submitted=!1,this.resetForm.reset()}}return e.\u0275fac=function(t){return new(t||e)(m.Yb(l.g),m.Yb(l.a),m.Yb(k.d),m.Yb(te),m.Yb(ye.a),m.Yb(T.a))},e.\u0275cmp=m.Sb({type:e,selectors:[["app-edit-password"]],decls:29,vars:11,consts:[[1,"ui","very","raised","segments"],[1,"ui","inverted","dimmer",3,"ngClass"],[1,"ui","text","loader"],["mat-dialog-title","",1,"ui","segment"],[1,"ui","header"],[1,"ui","segment","fluid","pt-1","pb-2"],[1,"ui","form",3,"formGroup","ngSubmit"],[1,"field","required",3,"ngClass"],["formControlName","old",3,"type"],[4,"ngIf"],["formControlName","new",3,"type"],["formControlName","confirm",3,"type"],[1,"w-100"],["mat-dialog-close","",1,"ui","right","aligned","teal","button"],["type","submit",1,"ui","right","aligned","violet","button"],["class","invalid-message",4,"ngIf"],[1,"invalid-message"]],template:function(e,t){1&e&&(m.ec(0,"div",0),m.ec(1,"div",1),m.ec(2,"div",2),m.dd(3,"Chargement"),m.dc(),m.dc(),m.ec(4,"div",3),m.ec(5,"p",4),m.dd(6,"Modification du mot de passe"),m.dc(),m.dc(),m.ec(7,"div",5),m.ec(8,"form",6),m.qc("ngSubmit",(function(){return t.onSubmit()})),m.ec(9,"div",7),m.ec(10,"label"),m.dd(11,"Ancien Mot de passe"),m.dc(),m.Zb(12,"input",8),m.bd(13,Ke,2,1,"div",9),m.dc(),m.ec(14,"div",7),m.ec(15,"label"),m.dd(16,"Nouveau mot de passe"),m.dc(),m.Zb(17,"input",10),m.bd(18,we,3,2,"div",9),m.dc(),m.ec(19,"div",7),m.ec(20,"label"),m.dd(21,"Confirmer mot de passe"),m.dc(),m.Zb(22,"input",11),m.bd(23,Ee,3,2,"div",9),m.dc(),m.ec(24,"div",12),m.ec(25,"button",13),m.dd(26,"Annuler"),m.dc(),m.ec(27,"button",14),m.dd(28,"Modifier"),m.dc(),m.dc(),m.dc(),m.dc(),m.dc()),2&e&&(m.Kb(1),m.Cc("ngClass",t.loading?"active":""),m.Kb(7),m.Cc("formGroup",t.resetForm),m.Kb(1),m.Cc("ngClass",t.submitted&&"INVALID"===t.f.old.status?"error":""),m.Kb(3),m.Cc("type",t.showPassword?"text":"password"),m.Kb(1),m.Cc("ngIf",t.submitted&&t.f.old.errors),m.Kb(1),m.Cc("ngClass",t.submitted&&"INVALID"===t.f.new.status?"error":""),m.Kb(3),m.Cc("type",t.showPassword?"text":"password"),m.Kb(1),m.Cc("ngIf",t.submitted&&t.f.new.errors),m.Kb(1),m.Cc("ngClass",t.submitted&&"INVALID"===t.f.confirm.status?"error":""),m.Kb(3),m.Cc("type",t.showPassword?"text":"password"),m.Kb(1),m.Cc("ngIf",t.f.confirm.errors&&t.submitted))},directives:[c.p,l.h,k.z,k.o,k.h,k.c,k.n,k.f,c.r,l.d],styles:[""]}),e})();var Me=i("Qu3c");function qe(e,t){1&e&&(m.ec(0,"div",2),m.ec(1,"div",3),m.dd(2,"Chargement"),m.dc(),m.dc())}function Oe(e,t){if(1&e){const e=m.fc();m.ec(0,"div",40),m.ec(1,"i",41),m.qc("click",(function(){return m.Tc(e),m.tc(2).editing=!0})),m.dc(),m.dc()}}function De(e,t){1&e&&(m.ec(0,"div",43),m.dd(1,"Ce champ est requis."),m.dc())}function Pe(e,t){1&e&&(m.ec(0,"div",43),m.dd(1,"Ce champ doit contenir au moins 2 caract\xe8res."),m.dc())}function Le(e,t){if(1&e&&(m.ec(0,"div"),m.bd(1,De,2,0,"div",42),m.bd(2,Pe,2,0,"div",42),m.dc()),2&e){const e=m.tc(2);m.Kb(1),m.Cc("ngIf",e.f.firstName.errors.required),m.Kb(1),m.Cc("ngIf",e.f.firstName.errors.minlength)}}function Ve(e,t){1&e&&(m.ec(0,"div",43),m.dd(1,"Ce champ est requis."),m.dc())}function Fe(e,t){1&e&&(m.ec(0,"div",43),m.dd(1,"Ce champ doit contenir au moins 2 caract\xe8res."),m.dc())}function Re(e,t){if(1&e&&(m.ec(0,"div"),m.bd(1,Ve,2,0,"div",42),m.bd(2,Fe,2,0,"div",42),m.dc()),2&e){const e=m.tc(2);m.Kb(1),m.Cc("ngIf",e.f.lastName.errors.required),m.Kb(1),m.Cc("ngIf",e.f.lastName.errors.minlength)}}function Ae(e,t){1&e&&(m.ec(0,"div",43),m.dd(1,"Ce champ est requis."),m.dc())}function Ue(e,t){1&e&&(m.ec(0,"div",43),m.dd(1,"Ce champ doit contenir au moins 6 caract\xe8res."),m.dc())}function $e(e,t){1&e&&(m.ec(0,"div",43),m.dd(1,"Ce champ ne peut contenir plus de 20 caract\xe8res."),m.dc())}function He(e,t){if(1&e&&(m.ec(0,"div"),m.bd(1,Ae,2,0,"div",42),m.bd(2,Ue,2,0,"div",42),m.bd(3,$e,2,0,"div",42),m.dc()),2&e){const e=m.tc(2);m.Kb(1),m.Cc("ngIf",e.f.username.errors.required),m.Kb(1),m.Cc("ngIf",e.f.username.errors.minlength),m.Kb(1),m.Cc("ngIf",e.f.username.errors.maxlength)}}function je(e,t){1&e&&(m.ec(0,"div",43),m.dd(1,"Ce champ ne peut contenir plus de 200 caract\xe8res."),m.dc())}function ze(e,t){1&e&&(m.ec(0,"div",43),m.dd(1,"Le format de votre email est invalide."),m.dc())}function Ye(e,t){if(1&e&&(m.ec(0,"div"),m.bd(1,je,2,0,"div",42),m.bd(2,ze,2,0,"div",42),m.dc()),2&e){const e=m.tc(2);m.Kb(1),m.Cc("ngIf",e.f.email.errors.maxlength),m.Kb(1),m.Cc("ngIf",e.f.email.errors.email)}}function Xe(e,t){if(1&e&&m.Zb(0,"input",44),2&e){const e=m.tc(2);m.Cc("value",e.getIdType())}}function Ze(e,t){1&e&&(m.ec(0,"select",45),m.ec(1,"option",46),m.dd(2,"S\xe9l\xe9ctionner"),m.dc(),m.ec(3,"option",47),m.dd(4,"Carte Nationale d'identit\xe9"),m.dc(),m.ec(5,"option",48),m.dd(6,"Passport"),m.dc(),m.dc()),2&e&&(m.Kb(1),m.Cc("value",null))}function _e(e,t){1&e&&(m.ec(0,"div",43),m.dd(1,"Ce champ ne peut contenir que des chiffres."),m.dc())}function Be(e,t){if(1&e&&(m.ec(0,"div"),m.bd(1,_e,2,0,"div",42),m.dc()),2&e){const e=m.tc(2);m.Kb(1),m.Cc("ngIf",e.f.postalCode.errors.pattern)}}function Ge(e,t){if(1&e&&(m.Zb(0,"input",44),m.uc(1,"titlecase")),2&e){const e=m.tc(2);m.Cc("value",m.vc(1,1,e.getCountry()))}}function Je(e,t){if(1&e&&(m.ec(0,"option",51),m.dd(1),m.dc()),2&e){const e=t.$implicit;m.Cc("value",e.code),m.Kb(1),m.ed(e.name)}}function We(e,t){if(1&e&&(m.ec(0,"select",49),m.bd(1,Je,2,2,"option",50),m.dc()),2&e){const e=m.tc(2);m.Kb(1),m.Cc("ngForOf",e.countries)}}function Qe(e,t){1&e&&(m.ec(0,"div",43),m.dd(1,"Ce champ est requis."),m.dc())}function et(e,t){if(1&e&&(m.ec(0,"div"),m.bd(1,Qe,2,0,"div",42),m.dc()),2&e){const e=m.tc(2);m.Kb(1),m.Cc("ngIf",e.f.countryCode.errors.required)}}function tt(e,t){if(1&e&&m.Zb(0,"input",52),2&e){const e=m.tc(2);m.Cc("value",e.formatNumber())}}function it(e,t){if(1&e){const e=m.fc();m.ec(0,"input",53),m.qc("keyup",(function(){return m.Tc(e),m.tc(2).formatNumber()})),m.dc()}}function ct(e,t){1&e&&(m.ec(0,"div",43),m.dd(1,"Ce champ est requis."),m.dc())}function dt(e,t){1&e&&(m.ec(0,"div",43),m.dd(1,"Le format de votre num\xe9ro de t\xe9l\xe9phone est invalide. "),m.dc())}function nt(e,t){1&e&&(m.ec(0,"div",43),m.dd(1,"Ce champ ne peut contenir que des chiffres."),m.dc())}function rt(e,t){if(1&e&&(m.ec(0,"div"),m.bd(1,ct,2,0,"div",42),m.bd(2,dt,2,0,"div",42),m.bd(3,nt,2,0,"div",42),m.dc()),2&e){const e=m.tc(2);m.Kb(1),m.Cc("ngIf",e.f.telephone.errors.required),m.Kb(1),m.Cc("ngIf",e.f.telephone.errors.validPhone),m.Kb(1),m.Cc("ngIf",e.f.telephone.errors.pattern)}}function st(e,t){if(1&e){const e=m.fc();m.ec(0,"button",54),m.qc("click",(function(){return m.Tc(e),m.tc(2).updatePassword()})),m.dd(1,"Modifier mot de passe"),m.dc()}}function ot(e,t){if(1&e){const e=m.fc();m.ec(0,"button",55),m.qc("click",(function(){return m.Tc(e),m.tc(2).resetForm()})),m.dd(1,"Annuler"),m.dc()}}function at(e,t){1&e&&(m.ec(0,"button",56),m.dd(1,"Enregistrer"),m.dc())}function lt(e,t){if(1&e){const e=m.fc();m.ec(0,"div",4),m.ec(1,"div",5),m.ec(2,"div",6),m.bd(3,Oe,2,0,"div",7),m.ec(4,"h1",8),m.dd(5,"Mon compte"),m.dc(),m.dc(),m.ec(6,"div",6),m.ec(7,"h3",9),m.dd(8,"Information"),m.dc(),m.ec(9,"form",10),m.qc("ngSubmit",(function(){return m.Tc(e),m.tc().onSubmit()})),m.ec(10,"div",11),m.ec(11,"div",12),m.ec(12,"label"),m.dd(13,"Pr\xe9nom"),m.dc(),m.Zb(14,"input",13),m.bd(15,Le,3,2,"div",14),m.dc(),m.ec(16,"div",12),m.ec(17,"label"),m.dd(18,"Nom"),m.dc(),m.Zb(19,"input",15),m.bd(20,Re,3,2,"div",14),m.dc(),m.dc(),m.ec(21,"div",11),m.ec(22,"div",12),m.ec(23,"label"),m.dd(24,"Nom d'utilisateur"),m.dc(),m.ec(25,"input",16),m.qc("keyup",(function(){m.Tc(e);const t=m.tc();return t.f.username.setValue(t.f.username.value.toLowerCase())})),m.dc(),m.bd(26,He,4,3,"div",14),m.dc(),m.ec(27,"div",17),m.ec(28,"label"),m.dd(29,"Email"),m.dc(),m.Zb(30,"input",18),m.bd(31,Ye,3,2,"div",14),m.dc(),m.dc(),m.ec(32,"div",11),m.ec(33,"div",19),m.ec(34,"label"),m.dd(35,"Type d'identification"),m.dc(),m.bd(36,Xe,1,1,"input",20),m.bd(37,Ze,7,1,"select",21),m.dc(),m.ec(38,"div",19),m.ec(39,"label"),m.dd(40,"Num\xe9ro d'identification"),m.dc(),m.Zb(41,"input",22),m.dc(),m.dc(),m.ec(42,"div",23),m.ec(43,"label"),m.dd(44,"Adresse"),m.dc(),m.Zb(45,"input",24),m.dc(),m.ec(46,"div",25),m.ec(47,"div",26),m.ec(48,"label"),m.dd(49,"Ville"),m.dc(),m.Zb(50,"input",27),m.dc(),m.ec(51,"div",26),m.ec(52,"label"),m.dd(53,"D\xe9partement"),m.dc(),m.Zb(54,"input",28),m.dc(),m.ec(55,"div",29),m.ec(56,"label"),m.dd(57,"Code postal"),m.dc(),m.Zb(58,"input",30),m.bd(59,Be,2,1,"div",14),m.dc(),m.dc(),m.ec(60,"div",31),m.ec(61,"div",12),m.ec(62,"label"),m.dd(63,"Pays"),m.dc(),m.bd(64,Ge,2,3,"input",20),m.bd(65,We,2,1,"select",32),m.bd(66,et,2,1,"div",14),m.dc(),m.ec(67,"div",12),m.ec(68,"label"),m.dd(69,"T\xe9l\xe9phone"),m.dc(),m.ec(70,"div",33),m.ec(71,"div",34),m.Zb(72,"i"),m.uc(73,"lowercase"),m.dd(74),m.dc(),m.bd(75,tt,1,1,"input",35),m.bd(76,it,1,0,"input",36),m.dc(),m.bd(77,rt,4,3,"div",14),m.dc(),m.dc(),m.ec(78,"div"),m.bd(79,st,2,0,"button",37),m.bd(80,ot,2,0,"button",38),m.bd(81,at,2,0,"button",39),m.dc(),m.dc(),m.dc(),m.dc(),m.dc()}if(2&e){const e=m.tc();m.Kb(3),m.Cc("ngIf",!e.editing),m.Kb(6),m.Cc("formGroup",e.userForm),m.Kb(2),m.Mb(e.editing?"required field":"field"),m.Cc("ngClass",e.submitted&&"INVALID"===e.f.firstName.status?"error":""),m.Kb(3),m.Cc("readonly",!e.editing),m.Kb(1),m.Cc("ngIf",e.submitted&&e.f.firstName.errors),m.Kb(1),m.Mb(e.editing?"required field":"field"),m.Cc("ngClass",e.submitted&&"INVALID"===e.f.lastName.status?"error":""),m.Kb(3),m.Cc("readonly",!e.editing),m.Kb(1),m.Cc("ngIf",e.submitted&&e.f.lastName.errors),m.Kb(2),m.Mb(e.editing?"required field":"field"),m.Cc("ngClass",e.submitted&&"INVALID"===e.f.username.status?"error":""),m.Kb(3),m.Cc("readonly",!e.editing),m.Kb(1),m.Cc("ngIf",e.submitted&&e.f.username.errors),m.Kb(1),m.Cc("ngClass",e.submitted&&"INVALID"===e.f.email.status?"error":""),m.Kb(3),m.Cc("readonly",!e.editing),m.Kb(1),m.Cc("ngIf",e.submitted&&e.f.email.errors),m.Kb(5),m.Cc("ngIf",!e.editing),m.Kb(1),m.Cc("ngIf",e.editing),m.Kb(4),m.Cc("readonly",!e.editing),m.Kb(4),m.Cc("readonly",!e.editing),m.Kb(5),m.Cc("readonly",!e.editing),m.Kb(4),m.Cc("readonly",!e.editing),m.Kb(1),m.Cc("ngClass",e.submitted&&e.f.postalCode.errors?"error":""),m.Kb(3),m.Cc("readonly",!e.editing),m.Kb(1),m.Cc("ngIf",e.submitted&&e.f.postalCode.errors),m.Kb(2),m.Mb(e.editing?"required field":"field"),m.Cc("ngClass",e.submitted&&e.f.countryCode.errors?"error":""),m.Kb(3),m.Cc("ngIf",!e.editing),m.Kb(1),m.Cc("ngIf",e.editing),m.Kb(1),m.Cc("ngIf",e.submitted&&e.f.countryCode.errors),m.Kb(1),m.Mb(e.editing?"required field":"field"),m.Cc("ngClass",e.submitted&&e.f.telephone.errors?"error":""),m.Kb(5),m.Nb("",m.vc(73,53,e.f.countryCode.value)," flag"),m.Kb(2),m.fd("",e.getDialCode()," "),m.Kb(1),m.Cc("ngIf",!e.editing),m.Kb(1),m.Cc("ngIf",e.editing),m.Kb(1),m.Cc("ngIf",e.submitted&&e.f.telephone.errors),m.Kb(2),m.Cc("ngIf",!e.editing),m.Kb(1),m.Cc("ngIf",e.editing),m.Kb(1),m.Cc("ngIf",e.editing)}}const ut=[{path:"mytickets",component:me},{path:"myaccount",component:(()=>{class e{constructor(e,t,i,c,d,r){this.userService=e,this.dialog=t,this.fb=i,this.router=c,this.authService=d,this.errorHandler=r,this.editing=!1,this.loading=!0,this.countries=(new u.a).countries,this.submitted=!1,this.scavenger=new n.Scavenger(this)}get f(){return this.userForm.controls}ngOnDestroy(){}ngOnInit(){this.getUser()}updatePassword(){this.dialog.open(xe,{width:"360px",height:"max-content",id:"user-details-ticket-dialog",hasBackdrop:!0,disableClose:!0,closeOnNavigation:!0,data:{username:this.user.credential.username}}).afterClosed().subscribe(e=>{e&&this.router.navigate(["/"])})}getIdType(){return void 0===this.user.idType||null===this.f.idType.value?"":"cni"===this.f.idType.value.toLowerCase()?"Carte National d'Identit\xe9":"passport"===this.f.idType.value.toLowerCase()?"Passeport":""}formatNumber(){return Object(f.b)(this.f.telephone.value,this.f.countryCode.value.toUpperCase())}getCountry(){return this.countries.find(e=>e.code===this.user.countryCode).name}resetForm(){this.loading=!0,this.submitted=!1,this.userForm.reset(),this.createForm(),this.editing=!1,this.loading=!1}getDialCode(){return this.countries.find(e=>e.code===this.f.countryCode.value).dial_code}onSubmit(){if(this.submitted=!0,this.userForm.invalid)return;this.loading=!0;let e=new ve.b;e=Object.assign(e,this.userForm.value),this.userService.updateUser(e).pipe(this.scavenger.collect(),Object(g.a)(2)).subscribe(e=>{e.ok&&(this.user.credential.username===this.f.username.value?b.a.fire("Done","La modification du profile a reussi","success").then(e=>{e&&location.reload()}):b.a.fire("Done","La modification du profil a r\xe9ussi. En raison de la modification de votre nom d'utilisateur, vous serez d\xe9connect\xe9. Veuillez vous reconnecter avec votre nouveau nom d'utilisateur.","success").then(e=>{e&&this.authService.logout()}))},e=>{this.errorHandler.handleError(e),this.loading=!1})}createForm(){this.userForm=this.fb.group({firstName:[this.user.firstName,[k.x.required,k.x.minLength(2)]],lastName:[this.user.lastName,[k.x.required,k.x.minLength(2)]],email:[this.user.email,Object(Ce.b)([k.x.maxLength(200),k.x.email])],username:[this.user.credential.username,[k.x.required,k.x.minLength(6),k.x.maxLength(20)]],idType:[this.user.idType],idNumber:[this.user.idNumber],line:[this.user.line],city:[this.user.city],state:[this.user.state],postalCode:[this.user.postalCode,Object(Ce.b)([k.x.pattern(/^[0-9]+$/)])],countryCode:[this.user.countryCode,[k.x.required]],telephone:[this.user.telephone,[k.x.required,k.x.pattern(/^[0-9]+$/)]]},{validator:Object(Ce.c)("countryCode","telephone")})}getUser(){this.userService.getUser().pipe(Object(g.a)(2),this.scavenger.collect()).subscribe(e=>{this.user=e,this.createForm()},e=>b.a.fire("Error","Une erreure s'est produite lors de la recup\xe9ration de votre profile. Veuillez r\xe9\xe9ssayer SVP","error").then(e=>{e&&location.reload()}),()=>this.loading=!1)}}return e.\u0275fac=function(t){return new(t||e)(m.Yb(te),m.Yb(l.b),m.Yb(k.d),m.Yb(d.c),m.Yb(ye.a),m.Yb(T.a))},e.\u0275cmp=m.Sb({type:e,selectors:[["app-my-account"]],decls:2,vars:2,consts:[["class","ui active dimmer h-100 w-100",4,"ngIf"],["class","ui main container mb-4 mt-4",4,"ngIf"],[1,"ui","active","dimmer","h-100","w-100"],[1,"ui","active","huge","text","inverted","loader"],[1,"ui","main","container","mb-4","mt-4"],[1,"ui","card","fluid"],[1,"content"],["class","right floated meta",4,"ngIf"],[1,"header"],[1,"ui","dividing","sub","header"],["autocomplete","on",1,"ui","form",3,"formGroup","ngSubmit"],[1,"two","equal","width","fields"],[3,"ngClass"],["autocapitalize","words","formControlName","firstName","type","text",3,"readonly"],[4,"ngIf"],["autocapitalize","words","formControlName","lastName","type","text",3,"readonly"],["autocomplete","off","formControlName","username","type","text",3,"readonly","keyup"],[1,"field",3,"ngClass"],["formControlName","email","placeholder","Not set","type","email",3,"readonly"],[1,"field"],["placeholder","Not set","readonly","","type","text",3,"value",4,"ngIf"],["class","ui dropdown selectable","formControlName","idType","name","idType",4,"ngIf"],["formControlName","idNumber","placeholder","Not set","type","text",3,"readonly"],[1,"field","fluid"],["autocapitalize","words","formControlName","line","placeholder","Not set","type","text",3,"readonly"],[1,"three","fields"],[1,"six","wide","field"],["autocapitalize","words","formControlName","city","placeholder","Not set","type","text",3,"readonly"],["autocapitalize","words","formControlName","state","placeholder","Not set","type","text",3,"readonly"],[1,"four","wide","field",3,"ngClass"],["formControlName","postalCode","placeholder","Not set","type","text",3,"readonly"],[1,"ui","two","equal","width","fields"],["class","ui dropdown selection share-tel mr-2  mb-0 h6","formControlName","countryCode",4,"ngIf"],[1,"ui","left","labeled","input"],[1,"ui","olive","label"],["readonly","","type","tel",3,"value",4,"ngIf"],["formControlName","telephone","type","tel",3,"keyup",4,"ngIf"],["class","ui right floated violet button",3,"click",4,"ngIf"],["class","ui right floated red button",3,"click",4,"ngIf"],["class","ui right floated blue button","type","submit",4,"ngIf"],[1,"right","floated","meta"],["matTooltip","Modifier",1,"violet","large","edit","outline","icon","cursor-pointer",3,"click"],["class","invalid-message",4,"ngIf"],[1,"invalid-message"],["placeholder","Not set","readonly","","type","text",3,"value"],["formControlName","idType","name","idType",1,"ui","dropdown","selectable"],["selected","",3,"value"],["value","CNI"],["value","password"],["formControlName","countryCode",1,"ui","dropdown","selection","share-tel","mr-2","mb-0","h6"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["readonly","","type","tel",3,"value"],["formControlName","telephone","type","tel",3,"keyup"],[1,"ui","right","floated","violet","button",3,"click"],[1,"ui","right","floated","red","button",3,"click"],["type","submit",1,"ui","right","floated","blue","button"]],template:function(e,t){1&e&&(m.bd(0,qe,3,0,"div",0),m.bd(1,lt,82,55,"div",1)),2&e&&(m.Cc("ngIf",t.loading),m.Kb(1),m.Cc("ngIf",!t.loading))},directives:[c.r,k.z,k.o,k.h,c.p,k.c,k.n,k.f,Me.a,k.w,k.r,k.y,c.q],pipes:[c.o,c.A],styles:[""]}),e})()}];let ft=(()=>{class e{}return e.\u0275mod=m.Wb({type:e}),e.\u0275inj=m.Vb({factory:function(t){return new(t||e)},imports:[[d.g.forChild(ut)],d.g]}),e})(),ht=(()=>{class e{}return e.\u0275mod=m.Wb({type:e}),e.\u0275inj=m.Vb({factory:function(t){return new(t||e)},providers:[],imports:[[c.c,ft,l.f,k.i,Me.b,k.u]]}),e})()}}]);