function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var c=0;c<t.length;c++){var i=t[c];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function _createClass(e,t,c){return t&&_defineProperties(e.prototype,t),c&&_defineProperties(e,c),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{lKKO:function(e,t,c){"use strict";c.r(t),c.d(t,"AccountModule",(function(){return kt}));var i,n=c("ofXK"),r=c("tyNb"),a=c("+0XT"),d=c("moCM"),o=c("4+6U"),s=c("EhJz"),u=c("wd/R"),l=c("0IaG"),f=c("MsxN"),h=c("PoRY"),g=c("PSD3"),v=c.n(g),p=c("un/a"),m=c("MlvY"),b=c("fXoL"),C=c("gcxx"),y=c("QnqH"),k=c("jzuh"),I=c("tk/3"),K=((i=function(){function e(t,c){_classCallCheck(this,e),this.cookieService=t,this.http=c,this.url=new y.a}return _createClass(e,[{key:"doSharing",value:function(e,t,c){return this.http.post("".concat(this.url.mainHost,"/tickets/").concat(t,"/sharing"),e,{params:{username:this.getUsername(),dial:c},observe:"response"})}},{key:"getSharing",value:function(e,t){return this.http.get("".concat(this.url.mainHost,"/tickets/").concat(t,"/sharing/").concat(e),{params:{username:this.getUsername()}})}},{key:"revokeTicket",value:function(e,t){return this.http.get("".concat(this.url.mainHost,"/tickets/").concat(t,"/sharing/").concat(e,"/revoke"),{params:{username:this.getUsername()},observe:"response"})}},{key:"attributeTicket",value:function(e,t){return this.http.post("".concat(this.url.mainHost,"/tickets/").concat(e,"/sharing/").concat(t,"/attribute"),null,{params:{username:this.getUsername()},observe:"response"})}},{key:"getUsername",value:function(){return this.cookieService.getCookie("last_email")}}]),e}()).\u0275fac=function(e){return new(e||i)(b.mc(k.a),b.mc(I.b))},i.\u0275prov=b.Ub({token:i,factory:i.\u0275fac,providedIn:"root"}),i),T=c("AXpb"),w=c("3Pt+");function N(e,t){if(1&e&&(b.ec(0,"tr"),b.ec(1,"td",14),b.cd(2,"Pr\xe9nom:"),b.dc(),b.ec(3,"td"),b.cd(4),b.uc(5,"titlecase"),b.dc(),b.dc()),2&e){var c=b.tc(2);b.Kb(4),b.dd(b.vc(5,1,c.sharedTo.firstName))}}function S(e,t){if(1&e&&(b.ec(0,"tr"),b.ec(1,"td",14),b.cd(2,"Nom:"),b.dc(),b.ec(3,"td"),b.cd(4),b.uc(5,"titlecase"),b.dc(),b.dc()),2&e){var c=b.tc(2);b.Kb(4),b.dd(b.vc(5,1,c.sharedTo.lastName))}}function E(e,t){if(1&e&&(b.ec(0,"tr"),b.ec(1,"td",14),b.cd(2,"T\xe9l\xe9phone:"),b.dc(),b.ec(3,"td"),b.cd(4),b.dc(),b.dc()),2&e){var c=b.tc(2);b.Kb(4),b.dd(c.sharedTo.telephone)}}function x(e,t){if(1&e&&(b.ec(0,"tr"),b.ec(1,"td",14),b.cd(2,"Classe:"),b.dc(),b.ec(3,"td"),b.cd(4),b.dc(),b.dc()),2&e){var c=b.tc(2);b.Kb(4),b.dd(c.item.type)}}function M(e,t){if(1&e&&(b.ec(0,"tr"),b.ec(1,"td",14),b.cd(2,"Type d'\xe9v\xe9nement:"),b.dc(),b.ec(3,"td"),b.cd(4),b.uc(5,"titlecase"),b.dc(),b.dc()),2&e){var c=b.tc(2);b.Kb(4),b.dd(b.vc(5,1,c.event.eventType))}}function q(e,t){if(1&e&&(b.ec(0,"tr"),b.ec(1,"td",14),b.cd(2,"D\xe9signation:"),b.dc(),b.ec(3,"td"),b.cd(4),b.dc(),b.dc()),2&e){var c=b.tc(2);b.Kb(4),b.dd(c.event.designation)}}function O(e,t){if(1&e&&(b.ec(0,"tr"),b.ec(1,"td",14),b.cd(2,"D\xe9but:"),b.dc(),b.ec(3,"td"),b.cd(4),b.uc(5,"date"),b.dc(),b.dc()),2&e){var c=b.tc(2);b.Kb(4),b.fd("",b.xc(5,2,c.item.startingDate,"dd MMMM yyyy","UTC")," \xe1 ",c.event.startingTime,"")}}function P(e,t){if(1&e&&(b.ec(0,"tr"),b.ec(1,"td",14),b.cd(2,"Fin:"),b.dc(),b.ec(3,"td"),b.cd(4),b.uc(5,"date"),b.dc(),b.dc()),2&e){var c=b.tc(2);b.Kb(4),b.fd("",b.xc(5,2,c.item.endingDate,"dd MMMM yyyy","UTC")," \xe1 ",c.event.endingTime,"")}}function D(e,t){if(1&e&&(b.ec(0,"tr"),b.ec(1,"td",14),b.cd(2,"Type transport:"),b.dc(),b.ec(3,"td"),b.cd(4),b.uc(5,"titlecase"),b.dc(),b.dc()),2&e){var c=b.tc(2);b.Kb(4),b.fd("",c.item.transportType+": ","",b.vc(5,2,c.item.transportName),"")}}function L(e,t){if(1&e&&(b.ec(0,"tr"),b.ec(1,"td",14),b.cd(2,"Date:"),b.dc(),b.ec(3,"td"),b.cd(4),b.uc(5,"titlecase"),b.uc(6,"date"),b.dc(),b.dc()),2&e){var c=b.tc(2);b.Kb(4),b.fd("",b.vc(5,2,b.xc(6,4,c.item.departDate,"dd MMMM yyyy","UTC"))," \xe1 ",c.item.departTime,"")}}function V(e,t){if(1&e&&(b.ec(0,"tr"),b.ec(1,"td",14),b.cd(2,"D\xe9part:"),b.dc(),b.ec(3,"td"),b.cd(4),b.uc(5,"titlecase"),b.dc(),b.dc()),2&e){var c=b.tc(2);b.Kb(4),b.dd(b.vc(5,1,c.item.departLocation))}}function F(e,t){if(1&e&&(b.ec(0,"tr"),b.ec(1,"td",14),b.cd(2,"Destination:"),b.dc(),b.ec(3,"td"),b.cd(4),b.uc(5,"titlecase"),b.dc(),b.dc()),2&e){var c=b.tc(2);b.Kb(4),b.dd(b.vc(5,1,c.item.arrivalLocation))}}function R(e,t){if(1&e&&(b.ec(0,"tr"),b.ec(1,"td",14),b.cd(2,"Lieu:"),b.dc(),b.ec(3,"td"),b.cd(4),b.uc(5,"titlecase"),b.dc(),b.dc()),2&e){var c=b.tc(2);b.Kb(4),b.dd(b.vc(5,1,c.event.place.designation))}}function A(e,t){if(1&e&&(b.ec(0,"div",12),b.ec(1,"table",13),b.ec(2,"tbody"),b.ec(3,"tr"),b.ec(4,"td",14),b.cd(5,"Code billet:"),b.dc(),b.ec(6,"td"),b.cd(7),b.dc(),b.dc(),b.ad(8,N,6,3,"tr",15),b.ad(9,S,6,3,"tr",15),b.ad(10,E,5,1,"tr",15),b.ad(11,x,5,1,"tr",15),b.ad(12,M,6,3,"tr",15),b.ad(13,q,5,1,"tr",15),b.ad(14,O,6,6,"tr",15),b.ad(15,P,6,6,"tr",15),b.ad(16,D,6,4,"tr",15),b.ad(17,L,7,8,"tr",15),b.ad(18,V,6,3,"tr",15),b.ad(19,F,6,3,"tr",15),b.ad(20,R,6,3,"tr",15),b.ec(21,"tr"),b.ec(22,"td",14),b.cd(23,"ID transaction:"),b.dc(),b.ec(24,"td"),b.cd(25),b.dc(),b.dc(),b.ec(26,"tr"),b.ec(27,"td",14),b.cd(28,"Pay\xe9 avec:"),b.dc(),b.ec(29,"td"),b.cd(30),b.uc(31,"titlecase"),b.dc(),b.dc(),b.ec(32,"tr"),b.ec(33,"td",14),b.cd(34,"Date transaction:"),b.dc(),b.ec(35,"td"),b.cd(36),b.uc(37,"titlecase"),b.uc(38,"date"),b.uc(39,"date"),b.dc(),b.dc(),b.ec(40,"tr"),b.ec(41,"td",14),b.cd(42,"Prix:"),b.dc(),b.ec(43,"td"),b.cd(44),b.uc(45,"currency"),b.dc(),b.dc(),b.dc(),b.dc(),b.dc()),2&e){var c=b.tc();b.Kb(7),b.dd(c.item.isShared?"PARTAGER":c.item.codeTicket),b.Kb(1),b.Cc("ngIf",c.item.isShared),b.Kb(1),b.Cc("ngIf",c.item.isShared),b.Kb(1),b.Cc("ngIf",c.item.isShared),b.Kb(1),b.Cc("ngIf","event"===c.type&&void 0!==c.event),b.Kb(1),b.Cc("ngIf","event"===c.type&&void 0!==c.event),b.Kb(1),b.Cc("ngIf","event"===c.type&&void 0!==c.event),b.Kb(1),b.Cc("ngIf","event"==c.type&&void 0!==c.event),b.Kb(1),b.Cc("ngIf","event"===c.type&&void 0!==c.event),b.Kb(1),b.Cc("ngIf","transport"===c.type),b.Kb(1),b.Cc("ngIf","transport"===c.type),b.Kb(1),b.Cc("ngIf","transport"===c.type),b.Kb(1),b.Cc("ngIf","transport"===c.type),b.Kb(1),b.Cc("ngIf","event"===c.type&&void 0!==c.event),b.Kb(5),b.dd(c.item.transactionNumber),b.Kb(5),b.dd(null==c.item.transactionType?"Ind\xe9fini":b.vc(31,19,c.item.transactionType)),b.Kb(6),b.fd("",b.vc(37,21,b.xc(38,23,c.item.updatedAt,"dd MMMM yyyy","UTC"))," ",b.xc(39,27,c.item.updatedAt,"\xe1 HH:MM","UTC"),""),b.Kb(8),b.dd(b.yc(45,31,c.item.totalPrice,"XOF","symbol","1.1-2"))}}function _(e,t){1&e&&(b.ec(0,"div"),b.ec(1,"p",24),b.cd(2,"Ce champ est requis"),b.dc(),b.dc())}function U(e,t){1&e&&(b.ec(0,"div"),b.ec(1,"p",24),b.cd(2,"Ce champ est requis"),b.dc(),b.dc())}function j(e,t){if(1&e&&(b.ec(0,"option",25),b.cd(1),b.dc()),2&e){var c=t.$implicit;b.Cc("value",c.code),b.Kb(1),b.dd(c.dial_code)}}function H(e,t){1&e&&(b.ec(0,"p",24),b.cd(1,"Ce champ est requis"),b.dc())}function z(e,t){1&e&&(b.ec(0,"p",24),b.cd(1,"Le format de votre t\xe9l\xe9phone n'est pas valide."),b.dc())}function Y(e,t){if(1&e&&(b.ec(0,"div"),b.ad(1,H,2,0,"p",26),b.ad(2,z,2,0,"p",26),b.dc()),2&e){var c=b.tc(2);b.Kb(1),b.Cc("ngIf",c.fieldValidity.get("telephone").includes("required")),b.Kb(1),b.Cc("ngIf",c.fieldValidity.get("telephone").includes("badFormat"))}}function X(e,t){if(1&e){var c=b.fc();b.ec(0,"div",16),b.ec(1,"div",17),b.ec(2,"label"),b.cd(3,"Pr\xe9nom"),b.dc(),b.ec(4,"input",18),b.qc("focusin",(function(){return b.Tc(c),b.tc().fieldValidity.delete("firstName")}))("focusout",(function(){return b.Tc(c),b.tc().checkFields("firstName")}))("ngModelChange",(function(e){return b.Tc(c),b.tc().sharedTo.firstName=e})),b.dc(),b.ad(5,_,3,0,"div",15),b.dc(),b.ec(6,"div",17),b.ec(7,"label"),b.cd(8,"Nom"),b.dc(),b.ec(9,"input",19),b.qc("focusin",(function(){return b.Tc(c),b.tc().fieldValidity.delete("lastName")}))("focusout",(function(){return b.Tc(c),b.tc().checkFields("lastName")}))("ngModelChange",(function(e){return b.Tc(c),b.tc().sharedTo.lastName=e})),b.dc(),b.ad(10,U,3,0,"div",15),b.dc(),b.ec(11,"div",17),b.ec(12,"label"),b.cd(13,"T\xe9l\xe9phone"),b.dc(),b.ec(14,"div",20),b.ec(15,"select",21),b.qc("ngModelChange",(function(e){return b.Tc(c),b.tc().sharedTo.countryCode=e})),b.ad(16,j,2,2,"option",22),b.dc(),b.ec(17,"input",23),b.qc("focusout",(function(){return b.Tc(c),b.tc().checkFields("telephone")}))("keyup",(function(){return b.Tc(c),b.tc().formatNumber()}))("ngModelChange",(function(e){return b.Tc(c),b.tc().sharedTo.telephone=e})),b.dc(),b.dc(),b.ad(18,Y,3,2,"div",15),b.dc(),b.dc()}if(2&e){var i=b.tc();b.Kb(1),b.Cc("ngClass",i.fieldValidity.has("firstName")?"error":""),b.Kb(3),b.Cc("ngModel",i.sharedTo.firstName),b.Kb(1),b.Cc("ngIf",i.fieldValidity.has("firstName")),b.Kb(1),b.Cc("ngClass",i.fieldValidity.has("lastName")?"error":""),b.Kb(3),b.Cc("ngModel",i.sharedTo.lastName),b.Kb(1),b.Cc("ngIf",i.fieldValidity.has("lastName")),b.Kb(1),b.Cc("ngClass",i.fieldValidity.has("telephone")?"error":""),b.Kb(4),b.Cc("ngModel",i.sharedTo.countryCode),b.Kb(1),b.Cc("ngForOf",i.countries),b.Kb(1),b.Cc("ngModel",i.sharedTo.telephone),b.Kb(1),b.Cc("ngIf",i.fieldValidity.has("telephone"))}}function Z(e,t){1&e&&(b.ec(0,"button",27),b.cd(1,"Fermer"),b.dc())}function B(e,t){if(1&e){var c=b.fc();b.ec(0,"button",28),b.qc("click",(function(){return b.Tc(c),b.tc().sharing=!0})),b.cd(1,"Partager"),b.dc()}}function G(e,t){if(1&e){var c=b.fc();b.ec(0,"button",28),b.qc("click",(function(){return b.Tc(c),b.tc().revokeSharing()})),b.cd(1," Supprimer le partage "),b.dc()}}function $(e,t){if(1&e){var c=b.fc();b.ec(0,"button",29),b.qc("click",(function(){return b.Tc(c),b.tc().attributeTicket()})),b.cd(1," Attribuer le ticket "),b.dc()}}function J(e,t){if(1&e){var c=b.fc();b.ec(0,"button",30),b.qc("click",(function(){return b.Tc(c),b.tc().cancelSharing()})),b.cd(1,"Annuler"),b.dc()}}function W(e,t){if(1&e){var c=b.fc();b.ec(0,"button",28),b.qc("click",(function(){return b.Tc(c),b.tc().doSharing()})),b.cd(1,"Valider"),b.dc()}}var Q,ee,te=function e(){_classCallCheck(this,e),this.ticketId="",this.firstName="",this.lastName="",this.telephone="",this.countryCode="SN"},ce=((Q=function(){function e(t,c,i,n,r){_classCallCheck(this,e),this.dialogRef=t,this.data=c,this.eventService=i,this.sharingService=n,this.errorHandler=r,this.loading=!0,this.sharing=!1,this.sharedTo=new te,this.countries=(new f.a).countries,this.fieldValidity=new Map,this.scavenger=new a.Scavenger(this)}return _createClass(e,[{key:"ngOnDestroy",value:function(){}},{key:"ngOnInit",value:function(){this.loading=!0,this.type=this.data.type,"transport"===this.type?this.item=this.data.item:"event"===this.type&&(this.item=this.data.item,this.getEvent(this.item.eventId)),this.item.isShared?this.getSharing():this.loading=!1}},{key:"formatNumber",value:function(){this.sharedTo.telephone=Object(h.b)(this.sharedTo.telephone,this.sharedTo.countryCode)}},{key:"checkFields",value:function(e){var t=[];0===this.sharedTo[e].length?t.push("required"):"telephone"!==e||Object(h.d)(this.sharedTo.telephone,this.sharedTo.countryCode)||t.push("badFormat"),t.length>0?this.fieldValidity.set(e,t):this.fieldValidity.delete(e)}},{key:"cancelSharing",value:function(){this.sharedTo=new te,this.fieldValidity.clear(),this.sharing=!1}},{key:"doSharing",value:function(){var e=this;if(this.loading=!0,Array.of("firstName","lastName","telephone").forEach((function(t){return e.checkFields(t)})),this.fieldValidity.size>0)v.a.fire("Erreur","Veuillez corriger le formulaire!","error");else{this.sharedTo.ticketId=this.item.codeTicket,this.sharedTo.telephone=this.sharedTo.telephone.split(" ").join("");var t=this.countries.find((function(t){return t.code===e.sharedTo.countryCode})).dial_code.replace("+","");this.sharingService.doSharing(JSON.stringify(this.sharedTo),this.type,t).pipe(this.scavenger.collect(),Object(p.a)(2)).subscribe((function(t){if(200===t.status){var c=e.type="le d\xe9but de l'\xe9v\xe9nement";e.messageDialog("Partage","<p>Le partage du ticket num\xe9ro "+e.sharedTo.ticketId+" a r\xe9ussi. Un SMS de confirmation a \xe9t\xe9 envoy\xe9 a "+e.sharedTo.firstName+" "+e.sharedTo.lastName+".Vous pouvez r\xe9voquer le partage de ce ticket depuis votre espace personnel. <br/> <strong> VEUILLEZ NOTER: </strong> Vous ne pourrez plus retirer ce billet au nouveau d\xe9tenteur s'il reste moins d'une heure avant "+c+"</p>","success")}else 404===t.status&&e.errorDialog()}),(function(t){e.errorHandler.handleError(t),e.loading=!1}))}}},{key:"revokeSharing",value:function(){var e=this;this.loading=!0,this.sharingService.revokeTicket(this.item.sharingId,this.type).pipe(this.scavenger.collect()).subscribe((function(t){t.ok?e.messageDialog("Reussi","Le partage de ce ticket a \xe9t\xe9 supprim\xe9 avec succ\xe8s. Vous \xeates \xe0 nouveau son titulaire.","success"):e.errorDialog()}),(function(t){e.errorHandler.handleError(t),e.loading=!1}))}},{key:"attributeTicket",value:function(){var e=this,t="<strong>".concat(m(this.sharedTo.firstName)," ").concat(m(this.sharedTo.lastName),"</strong>");v.a.fire({title:"Attribution de ticket",html:"<p>Vous \xeates sur le point d'attribuer le ticket \xe0 "+t+". Une fois l'attribution effectu\xe9e, vous ne pourrez plus effectuer aucune action sur ce ticket. "+t+" deviendra le nouveau propri\xe9taire du ticket. Souhaitez-vous continuer ?</p>",icon:"question",allowEscapeKey:!1,allowEnterKey:!1,allowOutsideClick:!1,showCloseButton:!1,showCancelButton:!0,cancelButtonText:"Non",confirmButtonText:"Oui",focusConfirm:!0,cancelButtonColor:"red",confirmButtonColor:"green"}).then((function(t){t.value?e.doAttribution():t.dismiss&&v.a.fire("Attribution","L'attribution du ticket a \xe9t\xe9 annul\xe9!","info")}))}},{key:"doAttribution",value:function(){var e=this;this.sharingService.attributeTicket(this.type,this.item.sharingId).pipe(Object(p.a)(2),this.scavenger.collect()).subscribe((function(t){t.ok?e.messageDialog("Attribution","Le ticket a \xe9t\xe9 attribu\xe9 avec succ\xe8s.","success"):e.messageDialog("Attribution","L'attribution du ticket a \xe9chou\xe9. Veuillez r\xe9essayer SVP.","error")}),(function(t){e.errorHandler.handleError(t),e.loading=!1}))}},{key:"getEvent",value:function(e){var t=this;this.eventService.getAnEvent(e).pipe(this.scavenger.collect(),Object(p.a)(2)).subscribe((function(e){return t.event=e}),(function(e){t.errorHandler.handleError(e),t.loading=!1}),(function(){t.item.isShared?t.getSharing():t.loading=!1}))}},{key:"getSharing",value:function(){var e=this;this.sharingService.getSharing(this.item.sharingId,this.type).pipe(this.scavenger.collect(),Object(p.a)(2)).subscribe((function(t){e.sharedTo=t,e.formatNumber()}),(function(t){e.errorHandler.handleError(t),e.loading=!1}),(function(){return e.loading=!1}))}},{key:"messageDialog",value:function(e,t,c){v.a.fire({title:e,html:t,icon:c,showCloseButton:!1,allowEnterKey:!1,allowOutsideClick:!1,allowEscapeKey:!1}).then((function(e){e.value&&location.reload()}))}},{key:"errorDialog",value:function(){var e=this;v.a.fire("Erreur","Une erreur est survenue. Veuillez r\xe9essayer SVP!","error").then((function(t){t&&(e.loading=!1)}))}}]),e}()).\u0275fac=function(e){return new(e||Q)(b.Yb(l.g),b.Yb(l.a),b.Yb(C.a),b.Yb(K),b.Yb(T.a))},Q.\u0275cmp=b.Sb({type:Q,selectors:[["app-details-ticket"]],decls:16,vars:10,consts:[[1,"ui","very","raised","segments"],[1,"ui","inverted","dimmer",3,"ngClass"],[1,"ui","text","loader"],["mat-dialog-title","",1,"ui","segment"],[1,"ui","header"],["class","ui segment fluid pt-1 pb-2",4,"ngIf"],["class","ui segment form fluid pt-1 pb-2",4,"ngIf"],[1,"ui","segment","d-flex","flex-row","justify-content-end","fluid"],["class","ui orange large button right floated mr-3","mat-dialog-close","",4,"ngIf"],["class","ui green large button right floated",3,"click",4,"ngIf"],["class","ui violet large button right floated",3,"click",4,"ngIf"],["class","ui teal large button right floated",3,"click",4,"ngIf"],[1,"ui","segment","fluid","pt-1","pb-2"],[1,"ui","very","basic","table"],[1,"right","aligned"],[4,"ngIf"],[1,"ui","segment","form","fluid","pt-1","pb-2"],[1,"required","field",3,"ngClass"],["name","fName","type","text",3,"ngModel","focusin","focusout","ngModelChange"],["name","lName","type","text",3,"ngModel","focusin","focusout","ngModelChange"],[1,"ui","left","labeled","input"],["name","code",1,"ui","dropdown","selection","share-tel","mr-2","mb-0","h6",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["name","telephone","placeholder","Telephone",3,"ngModel","focusout","keyup","ngModelChange"],[1,"error"],[3,"value"],["class","error",4,"ngIf"],["mat-dialog-close","",1,"ui","orange","large","button","right","floated","mr-3"],[1,"ui","green","large","button","right","floated",3,"click"],[1,"ui","violet","large","button","right","floated",3,"click"],[1,"ui","teal","large","button","right","floated",3,"click"]],template:function(e,t){1&e&&(b.ec(0,"div",0),b.ec(1,"div",1),b.ec(2,"div",2),b.cd(3,"Chargement"),b.dc(),b.dc(),b.ec(4,"div",3),b.ec(5,"p",4),b.cd(6),b.dc(),b.dc(),b.ad(7,A,46,36,"div",5),b.ad(8,X,19,11,"div",6),b.ec(9,"div",7),b.ad(10,Z,2,0,"button",8),b.ad(11,B,2,0,"button",9),b.ad(12,G,2,0,"button",9),b.ad(13,$,2,0,"button",10),b.ad(14,J,2,0,"button",11),b.ad(15,W,2,0,"button",9),b.dc(),b.dc()),2&e&&(b.Kb(1),b.Cc("ngClass",t.loading?"active":""),b.Kb(5),b.dd(t.sharing?"Partage de ticket":"Details Billet"),b.Kb(1),b.Cc("ngIf",!t.sharing),b.Kb(1),b.Cc("ngIf",t.sharing),b.Kb(2),b.Cc("ngIf",!t.sharing),b.Kb(1),b.Cc("ngIf",!t.sharing&&!t.item.isShared),b.Kb(1),b.Cc("ngIf",!t.sharing&&t.item.isShared),b.Kb(1),b.Cc("ngIf",!t.sharing&&t.item.isShared),b.Kb(1),b.Cc("ngIf",t.sharing),b.Kb(1),b.Cc("ngIf",t.sharing))},directives:[n.p,l.h,n.r,w.c,w.n,w.q,w.w,n.q,w.r,w.y,l.d],pipes:[n.A,n.f,n.d],styles:['.ui[class*="very basic"].table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:first-child{font-weight:600;font-size:15px;padding-right:15px!important}.ui[class*="very basic"].table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{color:#444;padding:7px 0!important}.share-tel[_ngcontent-%COMP%]{min-width:auto!important;width:100px!important;padding-right:0!important}']}),Q),ie=c("xG9w"),ne=((ee=function(){function e(t,c){_classCallCheck(this,e),this.cookiesService=t,this.http=c,this.urls=new y.a}return _createClass(e,[{key:"getUser",value:function(){return this.http.get("".concat(this.urls.mainHost,"/user/search"),{params:{username:this.getUsername()}})}},{key:"getTransportTickets",value:function(){return this.http.get("".concat(this.urls.mainHost,"/user/").concat(this.getUsername(),"/tickets/transport"))}},{key:"getEventTickets",value:function(){return this.http.get("".concat(this.urls.mainHost,"/user/").concat(this.getUsername(),"/tickets/event"))}},{key:"updatePassword",value:function(e,t){return this.http.post("".concat(this.urls.mainHost,"/password"),JSON.stringify({username:this.getUsername(),oldPassword:e,newPassword:t}),{observe:"response"})}},{key:"updateUser",value:function(e){return this.http.post("".concat(this.urls.mainHost,"/user/").concat(this.getUsername(),"/profile"),JSON.stringify(e),{observe:"response"})}},{key:"getUsername",value:function(){return this.cookiesService.getCookie("last_email")}}]),e}()).\u0275fac=function(e){return new(e||ee)(b.mc(k.a),b.mc(I.b))},ee.\u0275prov=b.Ub({token:ee,factory:ee.\u0275fac,providedIn:"root"}),ee);function re(e,t){1&e&&(b.ec(0,"div",2),b.ec(1,"div",3),b.cd(2,"Chargement"),b.dc(),b.dc())}function ae(e,t){1&e&&(b.ec(0,"td",18),b.cd(1,"EXPIR\xe9e"),b.dc())}function de(e,t){1&e&&(b.ec(0,"td",19),b.cd(1,"PARTAGER"),b.dc())}function oe(e,t){if(1&e&&(b.ec(0,"td"),b.cd(1),b.uc(2,"titlecase"),b.uc(3,"date"),b.dc()),2&e){var c=b.tc().$implicit,i=b.tc(4);b.Kb(1),b.fd(" ",b.vc(2,2,b.xc(3,4,i.pipeDate(c.departDate),"dd MMMM yyyy","UTC"))," \xe1 ",c.departTime," ")}}function se(e,t){if(1&e){var c=b.fc();b.ec(0,"tr",14),b.qc("click",(function(){b.Tc(c);var e=t.$implicit;return b.tc(4).ticketDetails(e,"transport")})),b.ad(1,ae,2,0,"td",15),b.ad(2,de,2,0,"td",16),b.ad(3,oe,4,8,"td",12),b.ec(4,"td"),b.cd(5),b.uc(6,"titlecase"),b.dc(),b.ec(7,"td"),b.cd(8),b.uc(9,"titlecase"),b.dc(),b.ec(10,"td",17),b.cd(11),b.dc(),b.ec(12,"td",17),b.cd(13),b.uc(14,"titlecase"),b.dc(),b.dc()}if(2&e){var i=t.$implicit;b.Cc("ngClass","EXPIRER"===i.codeTicket?"center aligned clear":"center aligned cursor-pointer"),b.Kb(1),b.Cc("ngIf","EXPIRER"===i.codeTicket),b.Kb(1),b.Cc("ngIf","EXPIRER"!==i.codeTicket&&i.isShared),b.Kb(1),b.Cc("ngIf","EXPIRER"!==i.codeTicket&&!i.isShared),b.Kb(2),b.dd(b.vc(6,10,i.departLocation)),b.Kb(3),b.dd(b.vc(9,12,i.arrivalLocation)),b.Kb(2),b.Cc("ngClass","EXPIRER"===i.codeTicket?"strikeout":""),b.Kb(1),b.dd(i.transportType),b.Kb(1),b.Cc("ngClass","EXPIRER"===i.codeTicket?"strikeout":""),b.Kb(1),b.dd(b.vc(14,14,i.transportName))}}function ue(e,t){if(1&e&&(b.ec(0,"tbody"),b.ad(1,se,15,16,"tr",13),b.dc()),2&e){var c=b.tc(3);b.Kb(1),b.Cc("ngForOf",c.transportTickets)}}function le(e,t){1&e&&(b.ec(0,"tr",9),b.ec(1,"td",21),b.cd(2,"Aucun billet disponible"),b.dc(),b.dc())}function fe(e,t){if(1&e&&(b.ec(0,"tbody"),b.ad(1,le,3,0,"tr",20),b.dc()),2&e){var c=b.tc(3);b.Kb(1),b.Cc("ngForOf",c.transportTickets)}}function he(e,t){if(1&e&&(b.ec(0,"table",8),b.ec(1,"thead"),b.ec(2,"tr",9),b.ec(3,"th",10),b.cd(4,"Date"),b.dc(),b.ec(5,"th",11),b.cd(6,"Itineraire"),b.dc(),b.ec(7,"th",11),b.cd(8,"Transport"),b.dc(),b.dc(),b.ec(9,"tr",9),b.ec(10,"th"),b.cd(11,"D\xe9part"),b.dc(),b.ec(12,"th"),b.cd(13,"Arriv\xe9"),b.dc(),b.ec(14,"th"),b.cd(15,"Type"),b.dc(),b.ec(16,"th"),b.cd(17,"D\xe9signation"),b.dc(),b.dc(),b.dc(),b.ad(18,ue,2,1,"tbody",12),b.ad(19,fe,2,1,"tbody",12),b.dc()),2&e){var c=b.tc(2);b.Kb(18),b.Cc("ngIf",c.transportTickets&&c.transportTickets.length>0),b.Kb(1),b.Cc("ngIf",c.transportTickets&&0===c.transportTickets.length)}}function ge(e,t){1&e&&(b.ec(0,"td",19),b.cd(1,"PARTAGER"),b.dc())}function ve(e,t){if(1&e&&(b.ec(0,"td"),b.cd(1),b.uc(2,"titlecase"),b.uc(3,"date"),b.dc()),2&e){var c=b.tc().$implicit,i=b.tc(3);b.Kb(1),b.ed(" ",b.vc(2,1,b.xc(3,3,i.getLinkedEvent(c).startingDate,"dd MMMM yyyy","UTC"))," ")}}function pe(e,t){1&e&&(b.ec(0,"td",18),b.cd(1,"EXPIR\xe9e"),b.dc())}function me(e,t){if(1&e){var c=b.fc();b.ec(0,"tr",14),b.qc("click",(function(){b.Tc(c);var e=t.$implicit;return b.tc(3).ticketDetails(e,"event")})),b.ad(1,ge,2,0,"td",16),b.ad(2,ve,4,7,"td",12),b.ad(3,pe,2,0,"td",15),b.ec(4,"td"),b.cd(5),b.uc(6,"titlecase"),b.dc(),b.ec(7,"td"),b.cd(8),b.uc(9,"titlecase"),b.dc(),b.ec(10,"td"),b.cd(11),b.dc(),b.ec(12,"td"),b.cd(13),b.uc(14,"currency"),b.dc(),b.dc()}if(2&e){var i=t.$implicit,n=b.tc(3);b.Cc("ngClass","EXPIRER"===i.codeTicket?"center aligned clear":"center aligned cursor-pointer"),b.Kb(1),b.Cc("ngIf","EXPIRER"!==i.codeTicket&&i.isShared),b.Kb(1),b.Cc("ngIf","EXPIRER"!==i.codeTicket&&!i.isShared),b.Kb(1),b.Cc("ngIf","EXPIRER"===i.codeTicket),b.Kb(2),b.dd(b.vc(6,8,n.getLinkedEvent(i).designation)),b.Kb(3),b.dd(b.vc(9,10,n.getLinkedEvent(i).place.designation)),b.Kb(3),b.dd(i.type),b.Kb(2),b.dd(b.yc(14,12,i.totalPrice,"XOF","symbol","1.1-2"))}}function be(e,t){if(1&e&&(b.ec(0,"table",8),b.ec(1,"thead"),b.ec(2,"tr",9),b.ec(3,"th",22),b.cd(4,"Date"),b.dc(),b.ec(5,"th"),b.cd(6,"D\xe9signation"),b.dc(),b.ec(7,"th"),b.cd(8,"Lieu"),b.dc(),b.ec(9,"th"),b.cd(10,"Classe"),b.dc(),b.ec(11,"th"),b.cd(12,"Prix"),b.dc(),b.dc(),b.dc(),b.ec(13,"tbody"),b.ad(14,me,15,17,"tr",13),b.dc(),b.dc()),2&e){var c=b.tc(2);b.Kb(14),b.Cc("ngForOf",c.eventTickets)}}function Ce(e,t){if(1&e&&(b.ec(0,"div",4),b.ec(1,"div",5),b.ec(2,"div",6),b.cd(3,"Mes titres de transport"),b.dc(),b.ad(4,he,20,2,"table",7),b.ec(5,"div",6),b.cd(6,"Mes tickets d'evenement"),b.dc(),b.ad(7,be,15,1,"table",7),b.dc(),b.dc()),2&e){var c=b.tc();b.Kb(4),b.Cc("ngIf",c.transportTickets),b.Kb(3),b.Cc("ngIf",c.eventTickets)}}var ye,ke=((ye=function(){function e(t,c,i,n){_classCallCheck(this,e),this.userService=t,this.eventService=c,this.errorHandler=i,this.dialog=n,this.scavenger=new a.Scavenger(this)}return _createClass(e,[{key:"ngOnInit",value:function(){this.getTransportTickets(),this.getEventTickets()}},{key:"ngOnDestroy",value:function(){}},{key:"ticketDetails",value:function(e,t){this.dialog.open(ce,{width:window.innerWidth>400?"550px":"380px",height:"max-content",id:"user-details-ticket-dialog",hasBackdrop:!0,disableClose:!0,closeOnNavigation:!0,data:{type:t,item:e}}).afterClosed().subscribe((function(e){}))}},{key:"pipeDate",value:function(e){return new Date(e)}},{key:"getLinkedEvent",value:function(e){return this.events.find((function(t){return t.eventId===e.eventId}))}},{key:"checkExpiry",value:function(e){var t=new Date(e.departDate),c=e.departTime.toString().split(":");return t.setHours(Number(c[0])),t.setMinutes(Number(c[1])),Object(d.a)(Object(o.a)(t.toISOString()),new Date(Object(u.now)()))<1}},{key:"getTransportTickets",value:function(){var e=this;this.userService.getTransportTickets().pipe(this.scavenger.collect()).subscribe((function(t){t.forEach((function(t){e.checkExpiry(t)&&(t.codeTicket="EXPIRER")})),e.transportTickets=t}),(function(t){e.errorHandler.handleError(t),location.reload()}))}},{key:"getEventTickets",value:function(){var e=this;this.userService.getEventTickets().pipe(this.scavenger.collect()).subscribe((function(t){var c=ie.e(t.map((function(e){return e.eventId})));e.getEvents(c,t)}),(function(t){e.errorHandler.handleError(t),location.reload()}))}},{key:"getEvents",value:function(e,t){var c=this;this.eventService.getListedEvents(e).pipe(this.scavenger.collect()).subscribe((function(e){c.events=e,e.forEach((function(e){Object(s.a)(Object(o.a)(e.startingDate.toString()),new Date(Object(u.now)()))||(t.find((function(t){return t.eventId===e.eventId})).codeTicket="EXPIRER")}))}),(function(e){c.errorHandler.handleError(e),location.reload()}),(function(){return c.eventTickets=t}))}}]),e}()).\u0275fac=function(e){return new(e||ye)(b.Yb(ne),b.Yb(C.a),b.Yb(T.a),b.Yb(l.b))},ye.\u0275cmp=b.Sb({type:ye,selectors:[["app-my-tickets"]],decls:2,vars:2,consts:[["class","ui active dimmer h-100 w-100",4,"ngIf"],["class","container mt-3 mb-3",4,"ngIf"],[1,"ui","active","dimmer","h-100","w-100"],[1,"ui","active","huge","text","inverted","loader"],[1,"container","mt-3","mb-3"],[1,"ui","raised","segment"],[1,"ui","header","text-center"],["class","ui mini table celled very compact striped structured selectable",4,"ngIf"],[1,"ui","mini","table","celled","very","compact","striped","structured","selectable"],[1,"center","aligned"],["rowspan","2",2,"width","200px"],["colspan","2"],[4,"ngIf"],[3,"ngClass","click",4,"ngFor","ngForOf"],[3,"ngClass","click"],["class","transport-expired text-uppercase",4,"ngIf"],["class","ticket-shared",4,"ngIf"],[3,"ngClass"],[1,"transport-expired","text-uppercase"],[1,"ticket-shared"],["class","center aligned",4,"ngFor","ngForOf"],["colspan","9"],[2,"width","150px"]],template:function(e,t){1&e&&(b.ad(0,re,3,0,"div",0),b.ad(1,Ce,8,2,"div",1)),2&e&&(b.Cc("ngIf",!t.transportTickets||!t.eventTickets),b.Kb(1),b.Cc("ngIf",t.transportTickets&&t.eventTickets))},directives:[n.r,n.q,n.p],pipes:[n.A,n.f,n.d],styles:["tr.clear[_ngcontent-%COMP%]{cursor:default;pointer-events:none}.transport-expired[_ngcontent-%COMP%]{background-color:red;color:#fff;font-weight:700}.strikeout[_ngcontent-%COMP%]{-webkit-text-decoration-line:line-through;text-decoration-line:line-through}.ticket-shared[_ngcontent-%COMP%]{background-color:green;color:#fff;font-weight:700}"]}),ye),Ie=c("LG61"),Ke=c("DrXB"),Te=c("qIOU");function we(e,t){1&e&&(b.ec(0,"div",16),b.cd(1,"Ce champ est requis."),b.dc())}function Ne(e,t){if(1&e&&(b.ec(0,"div"),b.ad(1,we,2,0,"div",15),b.dc()),2&e){var c=b.tc();b.Kb(1),b.Cc("ngIf",c.f.old.errors.required)}}function Se(e,t){1&e&&(b.ec(0,"div",16),b.cd(1,"Ce champ est requis."),b.dc())}function Ee(e,t){1&e&&(b.ec(0,"div",16),b.cd(1,"Veuillez saisir au moins huit caracteres."),b.dc())}function xe(e,t){if(1&e&&(b.ec(0,"div"),b.ad(1,Se,2,0,"div",15),b.ad(2,Ee,2,0,"div",15),b.dc()),2&e){var c=b.tc();b.Kb(1),b.Cc("ngIf",c.f.new.errors.required),b.Kb(1),b.Cc("ngIf",c.f.new.errors.minlength)}}function Me(e,t){1&e&&(b.ec(0,"div",16),b.cd(1,"Ce champ est requis."),b.dc())}function qe(e,t){1&e&&(b.ec(0,"div",16),b.cd(1,"Les mot de passe ne correspondent pas!"),b.dc())}function Oe(e,t){if(1&e&&(b.ec(0,"div"),b.ad(1,Me,2,0,"div",15),b.ad(2,qe,2,0,"div",15),b.dc()),2&e){var c=b.tc();b.Kb(1),b.Cc("ngIf",c.f.confirm.errors.required),b.Kb(1),b.Cc("ngIf",c.f.confirm.errors.mustMatch)}}var Pe,De=((Pe=function(){function e(t,c,i,n,r,d){_classCallCheck(this,e),this.dialogRef=t,this.data=c,this.formBuilder=i,this.userService=n,this.authService=r,this.errorHandler=d,this.loading=!1,this.submitted=!1,this.showPassword=!1,this.scavenger=new a.Scavenger(this)}return _createClass(e,[{key:"ngOnDestroy",value:function(){}},{key:"ngOnInit",value:function(){this.resetForm=this.formBuilder.group({old:["",[w.x.required]],new:["",[w.x.required,w.x.minLength(8)]],confirm:["",w.x.required]},{validator:Object(Ke.a)("new","confirm")})}},{key:"onSubmit",value:function(){var e=this;this.submitted=!0,this.resetForm.invalid||this.userService.updatePassword(this.f.old.value,this.f.new.value).pipe(this.scavenger.collect(),Object(p.a)(2)).subscribe((function(t){"EXPECTATION_FAILED"===t.body?v.a.fire("Erreur","L'ancien mot de passe que vous avez entr\xe9 est incorrect. Veuillez le corriger!","error"):"NOT_MODIFIED"===t.body?v.a.fire("Erreur","L'ancien mot de passe et le nouveau ne peuvent pas \xeatre identiques","info"):v.a.fire({title:"R\xe9ussi",html:"Votre mot de passe a \xe9t\xe9 modifi\xe9 avec succ\xe8s. Vous serez d\xe9connect\xe9. Veuillez vous connecter en utilisant votre nouveau mot de passe.",icon:"success",allowOutsideClick:!1,allowEnterKey:!1,allowEscapeKey:!1,showCloseButton:!1,showCancelButton:!1}).then((function(t){t&&e.authService.logout()}))}),(function(t){return e.errorHandler.handleError(t)}))}},{key:"onReset",value:function(){this.submitted=!1,this.resetForm.reset()}},{key:"f",get:function(){return this.resetForm.controls}}]),e}()).\u0275fac=function(e){return new(e||Pe)(b.Yb(l.g),b.Yb(l.a),b.Yb(w.d),b.Yb(ne),b.Yb(Te.a),b.Yb(T.a))},Pe.\u0275cmp=b.Sb({type:Pe,selectors:[["app-edit-password"]],decls:29,vars:11,consts:[[1,"ui","very","raised","segments"],[1,"ui","inverted","dimmer",3,"ngClass"],[1,"ui","text","loader"],["mat-dialog-title","",1,"ui","segment"],[1,"ui","header"],[1,"ui","segment","fluid","pt-1","pb-2"],[1,"ui","form",3,"formGroup","ngSubmit"],[1,"field","required",3,"ngClass"],["formControlName","old",3,"type"],[4,"ngIf"],["formControlName","new",3,"type"],["formControlName","confirm",3,"type"],[1,"w-100"],["mat-dialog-close","",1,"ui","right","aligned","teal","button"],["type","submit",1,"ui","right","aligned","violet","button"],["class","invalid-message",4,"ngIf"],[1,"invalid-message"]],template:function(e,t){1&e&&(b.ec(0,"div",0),b.ec(1,"div",1),b.ec(2,"div",2),b.cd(3,"Chargement"),b.dc(),b.dc(),b.ec(4,"div",3),b.ec(5,"p",4),b.cd(6,"Modification du mot de passe"),b.dc(),b.dc(),b.ec(7,"div",5),b.ec(8,"form",6),b.qc("ngSubmit",(function(){return t.onSubmit()})),b.ec(9,"div",7),b.ec(10,"label"),b.cd(11,"Ancien Mot de passe"),b.dc(),b.Zb(12,"input",8),b.ad(13,Ne,2,1,"div",9),b.dc(),b.ec(14,"div",7),b.ec(15,"label"),b.cd(16,"Nouveau mot de passe"),b.dc(),b.Zb(17,"input",10),b.ad(18,xe,3,2,"div",9),b.dc(),b.ec(19,"div",7),b.ec(20,"label"),b.cd(21,"Confirmer mot de passe"),b.dc(),b.Zb(22,"input",11),b.ad(23,Oe,3,2,"div",9),b.dc(),b.ec(24,"div",12),b.ec(25,"button",13),b.cd(26,"Annuler"),b.dc(),b.ec(27,"button",14),b.cd(28,"Modifier"),b.dc(),b.dc(),b.dc(),b.dc(),b.dc()),2&e&&(b.Kb(1),b.Cc("ngClass",t.loading?"active":""),b.Kb(7),b.Cc("formGroup",t.resetForm),b.Kb(1),b.Cc("ngClass",t.submitted&&"INVALID"===t.f.old.status?"error":""),b.Kb(3),b.Cc("type",t.showPassword?"text":"password"),b.Kb(1),b.Cc("ngIf",t.submitted&&t.f.old.errors),b.Kb(1),b.Cc("ngClass",t.submitted&&"INVALID"===t.f.new.status?"error":""),b.Kb(3),b.Cc("type",t.showPassword?"text":"password"),b.Kb(1),b.Cc("ngIf",t.submitted&&t.f.new.errors),b.Kb(1),b.Cc("ngClass",t.submitted&&"INVALID"===t.f.confirm.status?"error":""),b.Kb(3),b.Cc("type",t.showPassword?"text":"password"),b.Kb(1),b.Cc("ngIf",t.f.confirm.errors&&t.submitted))},directives:[n.p,l.h,w.z,w.o,w.h,w.c,w.n,w.f,n.r,l.d],styles:[""]}),Pe),Le=c("Qu3c");function Ve(e,t){1&e&&(b.ec(0,"div",2),b.ec(1,"div",3),b.cd(2,"Chargement"),b.dc(),b.dc())}function Fe(e,t){if(1&e){var c=b.fc();b.ec(0,"div",40),b.ec(1,"i",41),b.qc("click",(function(){return b.Tc(c),b.tc(2).editing=!0})),b.dc(),b.dc()}}function Re(e,t){1&e&&(b.ec(0,"div",43),b.cd(1,"Ce champ est requis."),b.dc())}function Ae(e,t){1&e&&(b.ec(0,"div",43),b.cd(1,"Ce champ doit contenir au moins 2 caract\xe8res."),b.dc())}function _e(e,t){if(1&e&&(b.ec(0,"div"),b.ad(1,Re,2,0,"div",42),b.ad(2,Ae,2,0,"div",42),b.dc()),2&e){var c=b.tc(2);b.Kb(1),b.Cc("ngIf",c.f.firstName.errors.required),b.Kb(1),b.Cc("ngIf",c.f.firstName.errors.minlength)}}function Ue(e,t){1&e&&(b.ec(0,"div",43),b.cd(1,"Ce champ est requis."),b.dc())}function je(e,t){1&e&&(b.ec(0,"div",43),b.cd(1,"Ce champ doit contenir au moins 2 caract\xe8res."),b.dc())}function He(e,t){if(1&e&&(b.ec(0,"div"),b.ad(1,Ue,2,0,"div",42),b.ad(2,je,2,0,"div",42),b.dc()),2&e){var c=b.tc(2);b.Kb(1),b.Cc("ngIf",c.f.lastName.errors.required),b.Kb(1),b.Cc("ngIf",c.f.lastName.errors.minlength)}}function ze(e,t){1&e&&(b.ec(0,"div",43),b.cd(1,"Ce champ est requis."),b.dc())}function Ye(e,t){1&e&&(b.ec(0,"div",43),b.cd(1,"Ce champ doit contenir au moins 6 caract\xe8res."),b.dc())}function Xe(e,t){1&e&&(b.ec(0,"div",43),b.cd(1,"Ce champ ne peut contenir plus de 20 caract\xe8res."),b.dc())}function Ze(e,t){if(1&e&&(b.ec(0,"div"),b.ad(1,ze,2,0,"div",42),b.ad(2,Ye,2,0,"div",42),b.ad(3,Xe,2,0,"div",42),b.dc()),2&e){var c=b.tc(2);b.Kb(1),b.Cc("ngIf",c.f.username.errors.required),b.Kb(1),b.Cc("ngIf",c.f.username.errors.minlength),b.Kb(1),b.Cc("ngIf",c.f.username.errors.maxlength)}}function Be(e,t){1&e&&(b.ec(0,"div",43),b.cd(1,"Ce champ ne peut contenir plus de 200 caract\xe8res."),b.dc())}function Ge(e,t){1&e&&(b.ec(0,"div",43),b.cd(1,"Le format de votre email est invalide."),b.dc())}function $e(e,t){if(1&e&&(b.ec(0,"div"),b.ad(1,Be,2,0,"div",42),b.ad(2,Ge,2,0,"div",42),b.dc()),2&e){var c=b.tc(2);b.Kb(1),b.Cc("ngIf",c.f.email.errors.maxlength),b.Kb(1),b.Cc("ngIf",c.f.email.errors.email)}}function Je(e,t){if(1&e&&b.Zb(0,"input",44),2&e){var c=b.tc(2);b.Cc("value",c.getIdType())}}function We(e,t){1&e&&(b.ec(0,"select",45),b.ec(1,"option",46),b.cd(2,"S\xe9l\xe9ctionner"),b.dc(),b.ec(3,"option",47),b.cd(4,"Carte Nationale d'identit\xe9"),b.dc(),b.ec(5,"option",48),b.cd(6,"Passport"),b.dc(),b.dc()),2&e&&(b.Kb(1),b.Cc("value",null))}function Qe(e,t){1&e&&(b.ec(0,"div",43),b.cd(1,"Ce champ ne peut contenir que des chiffres."),b.dc())}function et(e,t){if(1&e&&(b.ec(0,"div"),b.ad(1,Qe,2,0,"div",42),b.dc()),2&e){var c=b.tc(2);b.Kb(1),b.Cc("ngIf",c.f.postalCode.errors.pattern)}}function tt(e,t){if(1&e&&(b.Zb(0,"input",44),b.uc(1,"titlecase")),2&e){var c=b.tc(2);b.Cc("value",b.vc(1,1,c.getCountry()))}}function ct(e,t){if(1&e&&(b.ec(0,"option",51),b.cd(1),b.dc()),2&e){var c=t.$implicit;b.Cc("value",c.code),b.Kb(1),b.dd(c.name)}}function it(e,t){if(1&e&&(b.ec(0,"select",49),b.ad(1,ct,2,2,"option",50),b.dc()),2&e){var c=b.tc(2);b.Kb(1),b.Cc("ngForOf",c.countries)}}function nt(e,t){1&e&&(b.ec(0,"div",43),b.cd(1,"Ce champ est requis."),b.dc())}function rt(e,t){if(1&e&&(b.ec(0,"div"),b.ad(1,nt,2,0,"div",42),b.dc()),2&e){var c=b.tc(2);b.Kb(1),b.Cc("ngIf",c.f.countryCode.errors.required)}}function at(e,t){if(1&e&&b.Zb(0,"input",52),2&e){var c=b.tc(2);b.Cc("value",c.formatNumber())}}function dt(e,t){if(1&e){var c=b.fc();b.ec(0,"input",53),b.qc("keyup",(function(){return b.Tc(c),b.tc(2).formatNumber()})),b.dc()}}function ot(e,t){1&e&&(b.ec(0,"div",43),b.cd(1,"Ce champ est requis."),b.dc())}function st(e,t){1&e&&(b.ec(0,"div",43),b.cd(1,"Le format de votre num\xe9ro de t\xe9l\xe9phone est invalide. "),b.dc())}function ut(e,t){1&e&&(b.ec(0,"div",43),b.cd(1,"Ce champ ne peut contenir que des chiffres."),b.dc())}function lt(e,t){if(1&e&&(b.ec(0,"div"),b.ad(1,ot,2,0,"div",42),b.ad(2,st,2,0,"div",42),b.ad(3,ut,2,0,"div",42),b.dc()),2&e){var c=b.tc(2);b.Kb(1),b.Cc("ngIf",c.f.telephone.errors.required),b.Kb(1),b.Cc("ngIf",c.f.telephone.errors.validPhone),b.Kb(1),b.Cc("ngIf",c.f.telephone.errors.pattern)}}function ft(e,t){if(1&e){var c=b.fc();b.ec(0,"button",54),b.qc("click",(function(){return b.Tc(c),b.tc(2).updatePassword()})),b.cd(1,"Modifier mot de passe"),b.dc()}}function ht(e,t){if(1&e){var c=b.fc();b.ec(0,"button",55),b.qc("click",(function(){return b.Tc(c),b.tc(2).resetForm()})),b.cd(1,"Annuler"),b.dc()}}function gt(e,t){1&e&&(b.ec(0,"button",56),b.cd(1,"Enregistrer"),b.dc())}function vt(e,t){if(1&e){var c=b.fc();b.ec(0,"div",4),b.ec(1,"div",5),b.ec(2,"div",6),b.ad(3,Fe,2,0,"div",7),b.ec(4,"h1",8),b.cd(5,"Mon compte"),b.dc(),b.dc(),b.ec(6,"div",6),b.ec(7,"h3",9),b.cd(8,"Information"),b.dc(),b.ec(9,"form",10),b.qc("ngSubmit",(function(){return b.Tc(c),b.tc().onSubmit()})),b.ec(10,"div",11),b.ec(11,"div",12),b.ec(12,"label"),b.cd(13,"Pr\xe9nom"),b.dc(),b.Zb(14,"input",13),b.ad(15,_e,3,2,"div",14),b.dc(),b.ec(16,"div",12),b.ec(17,"label"),b.cd(18,"Nom"),b.dc(),b.Zb(19,"input",15),b.ad(20,He,3,2,"div",14),b.dc(),b.dc(),b.ec(21,"div",11),b.ec(22,"div",12),b.ec(23,"label"),b.cd(24,"Nom d'utilisateur"),b.dc(),b.ec(25,"input",16),b.qc("keyup",(function(){b.Tc(c);var e=b.tc();return e.f.username.setValue(e.f.username.value.toLowerCase())})),b.dc(),b.ad(26,Ze,4,3,"div",14),b.dc(),b.ec(27,"div",17),b.ec(28,"label"),b.cd(29,"Email"),b.dc(),b.Zb(30,"input",18),b.ad(31,$e,3,2,"div",14),b.dc(),b.dc(),b.ec(32,"div",11),b.ec(33,"div",19),b.ec(34,"label"),b.cd(35,"Type d'identification"),b.dc(),b.ad(36,Je,1,1,"input",20),b.ad(37,We,7,1,"select",21),b.dc(),b.ec(38,"div",19),b.ec(39,"label"),b.cd(40,"Num\xe9ro d'identification"),b.dc(),b.Zb(41,"input",22),b.dc(),b.dc(),b.ec(42,"div",23),b.ec(43,"label"),b.cd(44,"Adresse"),b.dc(),b.Zb(45,"input",24),b.dc(),b.ec(46,"div",25),b.ec(47,"div",26),b.ec(48,"label"),b.cd(49,"Ville"),b.dc(),b.Zb(50,"input",27),b.dc(),b.ec(51,"div",26),b.ec(52,"label"),b.cd(53,"D\xe9partement"),b.dc(),b.Zb(54,"input",28),b.dc(),b.ec(55,"div",29),b.ec(56,"label"),b.cd(57,"Code postal"),b.dc(),b.Zb(58,"input",30),b.ad(59,et,2,1,"div",14),b.dc(),b.dc(),b.ec(60,"div",31),b.ec(61,"div",12),b.ec(62,"label"),b.cd(63,"Pays"),b.dc(),b.ad(64,tt,2,3,"input",20),b.ad(65,it,2,1,"select",32),b.ad(66,rt,2,1,"div",14),b.dc(),b.ec(67,"div",12),b.ec(68,"label"),b.cd(69,"T\xe9l\xe9phone"),b.dc(),b.ec(70,"div",33),b.ec(71,"div",34),b.Zb(72,"i"),b.uc(73,"lowercase"),b.cd(74),b.dc(),b.ad(75,at,1,1,"input",35),b.ad(76,dt,1,0,"input",36),b.dc(),b.ad(77,lt,4,3,"div",14),b.dc(),b.dc(),b.ec(78,"div"),b.ad(79,ft,2,0,"button",37),b.ad(80,ht,2,0,"button",38),b.ad(81,gt,2,0,"button",39),b.dc(),b.dc(),b.dc(),b.dc(),b.dc()}if(2&e){var i=b.tc();b.Kb(3),b.Cc("ngIf",!i.editing),b.Kb(6),b.Cc("formGroup",i.userForm),b.Kb(2),b.Mb(i.editing?"required field":"field"),b.Cc("ngClass",i.submitted&&"INVALID"===i.f.firstName.status?"error":""),b.Kb(3),b.Cc("readonly",!i.editing),b.Kb(1),b.Cc("ngIf",i.submitted&&i.f.firstName.errors),b.Kb(1),b.Mb(i.editing?"required field":"field"),b.Cc("ngClass",i.submitted&&"INVALID"===i.f.lastName.status?"error":""),b.Kb(3),b.Cc("readonly",!i.editing),b.Kb(1),b.Cc("ngIf",i.submitted&&i.f.lastName.errors),b.Kb(2),b.Mb(i.editing?"required field":"field"),b.Cc("ngClass",i.submitted&&"INVALID"===i.f.username.status?"error":""),b.Kb(3),b.Cc("readonly",!i.editing),b.Kb(1),b.Cc("ngIf",i.submitted&&i.f.username.errors),b.Kb(1),b.Cc("ngClass",i.submitted&&"INVALID"===i.f.email.status?"error":""),b.Kb(3),b.Cc("readonly",!i.editing),b.Kb(1),b.Cc("ngIf",i.submitted&&i.f.email.errors),b.Kb(5),b.Cc("ngIf",!i.editing),b.Kb(1),b.Cc("ngIf",i.editing),b.Kb(4),b.Cc("readonly",!i.editing),b.Kb(4),b.Cc("readonly",!i.editing),b.Kb(5),b.Cc("readonly",!i.editing),b.Kb(4),b.Cc("readonly",!i.editing),b.Kb(1),b.Cc("ngClass",i.submitted&&i.f.postalCode.errors?"error":""),b.Kb(3),b.Cc("readonly",!i.editing),b.Kb(1),b.Cc("ngIf",i.submitted&&i.f.postalCode.errors),b.Kb(2),b.Mb(i.editing?"required field":"field"),b.Cc("ngClass",i.submitted&&i.f.countryCode.errors?"error":""),b.Kb(3),b.Cc("ngIf",!i.editing),b.Kb(1),b.Cc("ngIf",i.editing),b.Kb(1),b.Cc("ngIf",i.submitted&&i.f.countryCode.errors),b.Kb(1),b.Mb(i.editing?"required field":"field"),b.Cc("ngClass",i.submitted&&i.f.telephone.errors?"error":""),b.Kb(5),b.Nb("",b.vc(73,53,i.f.countryCode.value)," flag"),b.Kb(2),b.ed("",i.getDialCode()," "),b.Kb(1),b.Cc("ngIf",!i.editing),b.Kb(1),b.Cc("ngIf",i.editing),b.Kb(1),b.Cc("ngIf",i.submitted&&i.f.telephone.errors),b.Kb(2),b.Cc("ngIf",!i.editing),b.Kb(1),b.Cc("ngIf",i.editing),b.Kb(1),b.Cc("ngIf",i.editing)}}var pt,mt,bt,Ct=[{path:"mytickets",component:ke},{path:"myaccount",component:(pt=function(){function e(t,c,i,n,r,d){_classCallCheck(this,e),this.userService=t,this.dialog=c,this.fb=i,this.router=n,this.authService=r,this.errorHandler=d,this.editing=!1,this.loading=!0,this.countries=(new f.a).countries,this.submitted=!1,this.scavenger=new a.Scavenger(this)}return _createClass(e,[{key:"ngOnDestroy",value:function(){}},{key:"ngOnInit",value:function(){this.getUser()}},{key:"updatePassword",value:function(){var e=this;this.dialog.open(De,{width:"360px",height:"max-content",id:"user-details-ticket-dialog",hasBackdrop:!0,disableClose:!0,closeOnNavigation:!0,data:{username:this.user.credential.username}}).afterClosed().subscribe((function(t){t&&e.router.navigate(["/"])}))}},{key:"getIdType",value:function(){return void 0===this.user.idType||null===this.f.idType.value?"":"cni"===this.f.idType.value.toLowerCase()?"Carte National d'Identit\xe9":"passport"===this.f.idType.value.toLowerCase()?"Passeport":""}},{key:"formatNumber",value:function(){return Object(h.b)(this.f.telephone.value,this.f.countryCode.value.toUpperCase())}},{key:"getCountry",value:function(){var e=this;return this.countries.find((function(t){return t.code===e.user.countryCode})).name}},{key:"resetForm",value:function(){this.loading=!0,this.submitted=!1,this.userForm.reset(),this.createForm(),this.editing=!1,this.loading=!1}},{key:"getDialCode",value:function(){var e=this;return this.countries.find((function(t){return t.code===e.f.countryCode.value})).dial_code}},{key:"onSubmit",value:function(){var e=this;if(this.submitted=!0,!this.userForm.invalid){this.loading=!0;var t=new Ie.b;t=Object.assign(t,this.userForm.value),this.userService.updateUser(t).pipe(this.scavenger.collect(),Object(p.a)(2)).subscribe((function(t){t.ok&&(e.user.credential.username===e.f.username.value?v.a.fire("Done","La modification du profile a reussi","success").then((function(e){e&&location.reload()})):v.a.fire("Done","La modification du profil a r\xe9ussi. En raison de la modification de votre nom d'utilisateur, vous serez d\xe9connect\xe9. Veuillez vous reconnecter avec votre nouveau nom d'utilisateur.","success").then((function(t){t&&e.authService.logout()})))}),(function(t){e.errorHandler.handleError(t),e.loading=!1}))}}},{key:"createForm",value:function(){this.userForm=this.fb.group({firstName:[this.user.firstName,[w.x.required,w.x.minLength(2)]],lastName:[this.user.lastName,[w.x.required,w.x.minLength(2)]],email:[this.user.email,Object(Ke.b)([w.x.maxLength(200),w.x.email])],username:[this.user.credential.username,[w.x.required,w.x.minLength(6),w.x.maxLength(20)]],idType:[this.user.idType],idNumber:[this.user.idNumber],line:[this.user.line],city:[this.user.city],state:[this.user.state],postalCode:[this.user.postalCode,Object(Ke.b)([w.x.pattern(/^[0-9]+$/)])],countryCode:[this.user.countryCode,[w.x.required]],telephone:[this.user.telephone,[w.x.required,w.x.pattern(/^[0-9]+$/)]]},{validator:Object(Ke.c)("countryCode","telephone")})}},{key:"getUser",value:function(){var e=this;this.userService.getUser().pipe(Object(p.a)(2),this.scavenger.collect()).subscribe((function(t){e.user=t,e.createForm()}),(function(e){return v.a.fire("Error","Une erreure s'est produite lors de la recup\xe9ration de votre profile. Veuillez r\xe9\xe9ssayer SVP","error").then((function(e){e&&location.reload()}))}),(function(){return e.loading=!1}))}},{key:"f",get:function(){return this.userForm.controls}}]),e}(),pt.\u0275fac=function(e){return new(e||pt)(b.Yb(ne),b.Yb(l.b),b.Yb(w.d),b.Yb(r.c),b.Yb(Te.a),b.Yb(T.a))},pt.\u0275cmp=b.Sb({type:pt,selectors:[["app-my-account"]],decls:2,vars:2,consts:[["class","ui active dimmer h-100 w-100",4,"ngIf"],["class","ui main container mb-4 mt-4",4,"ngIf"],[1,"ui","active","dimmer","h-100","w-100"],[1,"ui","active","huge","text","inverted","loader"],[1,"ui","main","container","mb-4","mt-4"],[1,"ui","card","fluid"],[1,"content"],["class","right floated meta",4,"ngIf"],[1,"header"],[1,"ui","dividing","sub","header"],["autocomplete","on",1,"ui","form",3,"formGroup","ngSubmit"],[1,"two","equal","width","fields"],[3,"ngClass"],["autocapitalize","words","formControlName","firstName","type","text",3,"readonly"],[4,"ngIf"],["autocapitalize","words","formControlName","lastName","type","text",3,"readonly"],["autocomplete","off","formControlName","username","type","text",3,"readonly","keyup"],[1,"field",3,"ngClass"],["formControlName","email","placeholder","Not set","type","email",3,"readonly"],[1,"field"],["placeholder","Not set","readonly","","type","text",3,"value",4,"ngIf"],["class","ui dropdown selectable","formControlName","idType","name","idType",4,"ngIf"],["formControlName","idNumber","placeholder","Not set","type","text",3,"readonly"],[1,"field","fluid"],["autocapitalize","words","formControlName","line","placeholder","Not set","type","text",3,"readonly"],[1,"three","fields"],[1,"six","wide","field"],["autocapitalize","words","formControlName","city","placeholder","Not set","type","text",3,"readonly"],["autocapitalize","words","formControlName","state","placeholder","Not set","type","text",3,"readonly"],[1,"four","wide","field",3,"ngClass"],["formControlName","postalCode","placeholder","Not set","type","text",3,"readonly"],[1,"ui","two","equal","width","fields"],["class","ui dropdown selection share-tel mr-2  mb-0 h6","formControlName","countryCode",4,"ngIf"],[1,"ui","left","labeled","input"],[1,"ui","olive","label"],["readonly","","type","tel",3,"value",4,"ngIf"],["formControlName","telephone","type","tel",3,"keyup",4,"ngIf"],["class","ui right floated violet button",3,"click",4,"ngIf"],["class","ui right floated red button",3,"click",4,"ngIf"],["class","ui right floated blue button","type","submit",4,"ngIf"],[1,"right","floated","meta"],["matTooltip","Modifier",1,"violet","large","edit","outline","icon","cursor-pointer",3,"click"],["class","invalid-message",4,"ngIf"],[1,"invalid-message"],["placeholder","Not set","readonly","","type","text",3,"value"],["formControlName","idType","name","idType",1,"ui","dropdown","selectable"],["selected","",3,"value"],["value","CNI"],["value","password"],["formControlName","countryCode",1,"ui","dropdown","selection","share-tel","mr-2","mb-0","h6"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["readonly","","type","tel",3,"value"],["formControlName","telephone","type","tel",3,"keyup"],[1,"ui","right","floated","violet","button",3,"click"],[1,"ui","right","floated","red","button",3,"click"],["type","submit",1,"ui","right","floated","blue","button"]],template:function(e,t){1&e&&(b.ad(0,Ve,3,0,"div",0),b.ad(1,vt,82,55,"div",1)),2&e&&(b.Cc("ngIf",t.loading),b.Kb(1),b.Cc("ngIf",!t.loading))},directives:[n.r,w.z,w.o,w.h,n.p,w.c,w.n,w.f,Le.a,w.w,w.r,w.y,n.q],pipes:[n.o,n.A],styles:[""]}),pt)}],yt=((bt=function e(){_classCallCheck(this,e)}).\u0275mod=b.Wb({type:bt}),bt.\u0275inj=b.Vb({factory:function(e){return new(e||bt)},imports:[[r.g.forChild(Ct)],r.g]}),bt),kt=((mt=function e(){_classCallCheck(this,e)}).\u0275mod=b.Wb({type:mt}),mt.\u0275inj=b.Vb({factory:function(e){return new(e||mt)},providers:[],imports:[[n.c,yt,l.f,w.i,Le.b,w.u]]}),mt)}}]);