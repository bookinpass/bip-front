function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function _createClass(t,e,n){return e&&_defineProperties(t.prototype,e),n&&_defineProperties(t,n),t}(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{ypLv:function(t,e,n){"use strict";n.r(e),n.d(e,"TransactionModule",(function(){return j}));var i,o=n("ofXK"),c=n("tyNb"),r=n("un/a"),a=n("BapT"),s=n("+0XT"),l=n("PSD3"),d=n.n(l),b=n("5RHE"),g=n("wOnQ"),u=n.n(g),p=n("wd/R"),v=n("fXoL"),f=n("gcxx"),h=n("AXpb"),m=n("QnqH"),y=n("tk/3"),C=n("jzuh"),w=((i=function(){function t(e,n){_classCallCheck(this,t),this.http=e,this.cookieService=n,this.urlConfig=new m.a,this.host=this.urlConfig.mainHost}return _createClass(t,[{key:"getTicketEventByRef",value:function(t){return this.http.get("".concat(this.host).concat(this.urlConfig.searchEventByRef,"/").concat(t))}},{key:"getTicketTransportByRef",value:function(t){return this.http.get("".concat(this.host).concat(this.urlConfig.searchTransportByRef,"/").concat(t))}}]),t}()).\u0275fac=function(t){return new(t||i)(v.ec(y.b),v.ec(C.a))},i.\u0275prov=v.Mb({token:i,factory:i.\u0275fac,providedIn:"root"}),i),k=n("0hV+");function x(t,e){1&t&&(v.Wb(0,"div",2),v.Wb(1,"div",3),v.Uc(2,"Chargement"),v.Vb(),v.Vb())}function V(t,e){if(1&t&&(v.Wb(0,"div",6),v.Wb(1,"h2",7),v.Uc(2,"Info de l'evenement"),v.Vb(),v.Wb(3,"div",10),v.Wb(4,"div",11),v.Wb(5,"div",12),v.Rb(6,"img",13),v.Vb(),v.Wb(7,"div",14),v.Wb(8,"a",15),v.Uc(9),v.Vb(),v.Wb(10,"div",16),v.Wb(11,"div"),v.Wb(12,"h6"),v.Uc(13,"Type"),v.Vb(),v.Uc(14),v.Vb(),v.Wb(15,"div"),v.Wb(16,"h6"),v.Uc(17,"Lieu"),v.Vb(),v.Uc(18),v.Vb(),v.Wb(19,"div"),v.Wb(20,"h6"),v.Uc(21,"D\xe9but"),v.Vb(),v.Uc(22),v.mc(23,"titlecase"),v.mc(24,"date"),v.Vb(),v.Wb(25,"div"),v.Wb(26,"h6"),v.Uc(27,"Fin"),v.Vb(),v.Uc(28),v.mc(29,"titlecase"),v.mc(30,"date"),v.Vb(),v.Vb(),v.Vb(),v.Vb(),v.Wb(31,"div",17),v.Wb(32,"h6",18),v.Uc(33),v.Vb(),v.Vb(),v.Vb(),v.Vb()),2&t){var n=v.lc(2);v.Cb(6),v.wc("src","../../../assets/images/event/",n.idEvent,".jpg",v.Nc),v.Cb(3),v.Vc(n.event.designation),v.Cb(5),v.Wc(": ",n.event.eventType,""),v.Cb(4),v.Wc(": ",n.event.place.designation,""),v.Cb(4),v.Xc(": ",v.nc(23,9,v.oc(24,11,n.event.startingDate,"EEEE, dd MMMM yyyy"))," a ",n.event.startingTime,""),v.Cb(6),v.Xc(": ",v.nc(29,14,v.oc(30,16,n.event.endingDate,"EEEE, dd MMMM yyyy"))," a ",n.event.endingTime,""),v.Cb(5),v.Vc(n.event.description)}}function M(t,e){if(1&t){var n=v.Xb();v.Wb(0,"div",21),v.ic("click",(function(){v.Lc(n);var t=e.index;return v.lc(3).downloadTicket("event",t)})),v.Wb(1,"div",22),v.Wb(2,"a",23),v.Rb(3,"i",24),v.Vb(),v.Vb(),v.Wb(4,"div",25),v.Rb(5,"img",26),v.Rb(6,"qrcode",27),v.Vb(),v.Wb(7,"div",28),v.Wb(8,"span",29),v.Uc(9),v.Vb(),v.Wb(10,"span"),v.Uc(11),v.Vb(),v.Wb(12,"span"),v.Uc(13),v.mc(14,"date"),v.Vb(),v.Wb(15,"span",29),v.Uc(16),v.mc(17,"currency"),v.Vb(),v.Vb(),v.Rb(18,"hr",30),v.Wb(19,"div",31),v.Wb(20,"div",32),v.Wb(21,"p"),v.Uc(22,"R\xe9serve sur"),v.Vb(),v.Rb(23,"img",33),v.Vb(),v.Wb(24,"div",32),v.Wb(25,"p"),v.Uc(26,"Pay\xe9 via"),v.Vb(),v.Rb(27,"img",34),v.Vb(),v.Vb(),v.Wb(28,"div",35),v.Uc(29," www.bookinpass.com "),v.Vb(),v.Vb()}if(2&t){var i=e.$implicit,o=e.index,c=v.lc(3);v.wc("id","event-ticket-container",o,""),v.Cb(5),v.wc("src","../../../assets/images/event/",c.idEvent,".jpg",v.Nc),v.Cb(1),v.uc("allowEmptyString",!1)("elementType","url")("errorCorrectionLevel","H")("margin",0)("qrdata",i.codeTicket)("version",6)("width",90),v.Cb(3),v.Vc(c.event.designation),v.Cb(2),v.Vc(c.event.place.designation),v.Cb(2),v.Xc("Le ",v.oc(14,16,c.event.startingDate,"dd MMM yyyy")," a partir de ",c.event.startingTime,""),v.Cb(3),v.Xc("Ticket ",i.type.toLowerCase(),", ",v.qc(17,19,i.totalPrice,"XOF","symbol-narrow","1.1-2")," "),v.Cb(11),v.uc("src",c.getLogoPath(i.transactionType),v.Nc)}}function O(t,e){if(1&t&&(v.Wb(0,"div",19),v.Sc(1,M,30,24,"div",20),v.Vb()),2&t){var n=v.lc(2);v.Cb(1),v.uc("ngForOf",n.eventTickets)}}function P(t,e){if(1&t){var n=v.Xb();v.Wb(0,"div",21),v.ic("click",(function(){v.Lc(n);var t=e.index;return v.lc(3).downloadTicket("event",t)})),v.Wb(1,"div",36),v.Rb(2,"img",37),v.Rb(3,"qrcode",38),v.Vb(),v.Wb(4,"p",39),v.Wb(5,"span",40),v.Uc(6,"Date"),v.Vb(),v.Uc(7),v.mc(8,"titlecase"),v.mc(9,"date"),v.Vb(),v.Wb(10,"p",39),v.Wb(11,"span",40),v.Uc(12,"Prix"),v.Vb(),v.Uc(13),v.mc(14,"currency"),v.Vb(),v.Wb(15,"p",41),v.Uc(16,"Ce ticket est non remboursable"),v.Vb(),v.Rb(17,"hr",42),v.Wb(18,"div",31),v.Wb(19,"div",32),v.Wb(20,"p"),v.Uc(21,"R\xe9serve sur"),v.Vb(),v.Rb(22,"img",33),v.Vb(),v.Wb(23,"div",32),v.Wb(24,"p"),v.Uc(25,"Pay\xe9 via"),v.Vb(),v.Rb(26,"img",34),v.Vb(),v.Vb(),v.Wb(27,"div",35),v.Uc(28," www.bookinpass.com "),v.Vb(),v.Vb()}if(2&t){var i=e.$implicit,o=e.index,c=v.lc(3);v.wc("id","transport-ticket-container",o,""),v.Cb(3),v.uc("allowEmptyString",!1)("elementType","url")("errorCorrectionLevel","H")("margin",0)("qrdata",i.codeTicket)("version",6)("width",90),v.Cb(4),v.Xc(": ",v.nc(8,12,v.oc(9,14,i.departDate,"dd MMMM yyyy"))," \xe0 ",i.departTime,""),v.Cb(6),v.Wc(": ",v.qc(14,17,i.totalPrice,"XOF","symbol-narrow","1.1-1")," "),v.Cb(13),v.uc("src",c.getLogoPath(i.transactionType),v.Nc)}}function W(t,e){if(1&t&&(v.Wb(0,"div",19),v.Sc(1,P,29,22,"div",20),v.Vb()),2&t){var n=v.lc(2);v.Cb(1),v.uc("ngForOf",n.transportTickets)}}function _(t,e){if(1&t){var n=v.Xb();v.Wb(0,"div",4),v.Sc(1,V,34,19,"div",5),v.Wb(2,"div",6),v.Wb(3,"div"),v.Wb(4,"h2",7),v.Uc(5,"Mes billets"),v.Vb(),v.Wb(6,"div",8),v.ic("click",(function(){return v.Lc(n),v.lc().download()})),v.Uc(7,"Telecharger"),v.Vb(),v.Vb(),v.Sc(8,O,2,1,"div",9),v.Sc(9,W,2,1,"div",9),v.Vb(),v.Vb()}if(2&t){var i=v.lc();v.Cb(1),v.uc("ngIf","event_sport"===i.type),v.Cb(7),v.uc("ngIf","event_sport"===i.type),v.Cb(1),v.uc("ngIf","transport"===i.type)}}var T,E,U,S=[{path:"",component:(T=function(){function t(e,n,i,o,r){var a=this;_classCallCheck(this,t),this.eventService=e,this.router=n,this.activatedRoute=i,this.errorHandler=o,this.ticketService=r,this.loading=!0,this.scavenger=new s.Scavenger(this),n.events.subscribe((function(t){t instanceof c.b&&a.activatedRoute.queryParamMap.subscribe((function(t){a.status=t.params.status,a.idTransaction=t.params.ref,a.items=Number(t.params.items),a.idEvent=t.params.id,a.type=t.params.type}),(function(t){return t}))}))}return _createClass(t,[{key:"ngOnInit",value:function(){var t;"succeed"===this.status?(t=1===this.items?"L'achat de votre ticket a r\xe9ussi. Vous pouvez proceder au t\xe9l\xe9chargement de votre ticket. Si vous souhaitez partager votre ticket avec un de vos proches, veuillez vous rendre dans votre espace personnel.":"Vous venez d'acqu\xe9rir "+this.items+' billets. Vous pouvez t\xe9l\xe9charger vos billets. <strong class="underlined">NOTE:</strong> Tous les billets sont actuellement enregistr\xe9s sous votre nom. Une autre personne ne peut en faire usage que si vous la partagez. Veuillez vous rendre dans votre espace personnel pour partager ces billets.',d.a.fire({title:"Transaction accept\xe9e ",html:t,icon:"success",allowEscapeKey:!1,allowOutsideClick:!1,focusConfirm:!0,showCloseButton:!1}),"event_sport"===this.type.toLowerCase()?this.getEventSportDetails():"transport"===this.type.toLowerCase()&&this.getTransportTickets()):this.failedStatus()}},{key:"ngOnDestroy",value:function(){}},{key:"getLogoPath",value:function(t){var e="../../../assets/images/icons/";switch(t.toLowerCase()){case"orange money":case"om":e=e.concat("OM.jpg");break;case"wari":e.concat("wari.png");break;case"joni joni":case"jj":e=e.concat("");break;case"paypal":case"pp":e=e.concat("paypal.png");break;default:e=""}return e}},{key:"download",value:function(){var t=this;this.loading=!0;for(var e="event_sport"===this.type?"event":"transport"===this.type?"transport":"",n=0;n<this.items;++n){var i=document.getElementById(e+"-ticket-container"+n);console.log(i),null==i?d.a.fire("Erreur","Une erreure s'est produite lors de la tentative de telechargement des tickets!","error").then((function(e){e&&(t.loading=!1)})):u()(i).then((function(e){var n=2*e.height/e.width,i=e.toDataURL("image/jpeg"),o=new b("p","in","a8");o.addImage(i,"jepg",0,0,2,n,null,"slow"),o.save("".concat(new Date(Object(p.now)()).toISOString(),".pdf"),{returnPromise:!0}).then((function(){t.loading=!1}))}))}}},{key:"downloadTicket",value:function(t,e){console.log(t,e)}},{key:"failedStatus",value:function(){}},{key:"getEventSportDetails",value:function(){var t=this;this.eventService.getAnEvent(this.idEvent).pipe(this.scavenger.collect(),Object(r.a)(3)).subscribe((function(e){return t.event=e}),(function(e){404===e.status?(new a.a).ErrorSwalWithReturn("Invalid ID","Cet ID ne correspond \xe0 aucun \xe9v\xe9nement").then((function(e){e&&t.router.navigate([""])})):t.errorHandler.handleError(e)}),(function(){return t.getEventTickets()}))}},{key:"getEventTickets",value:function(){var t=this;this.ticketService.getTicketEventByRef(this.idTransaction).pipe(this.scavenger.collect(),Object(r.a)(3)).subscribe((function(e){e.length!==t.items?setTimeout((function(){return t.getEventTickets()}),1e3):(t.eventTickets=e,t.eventTickets.sort((function(t,e){return t.totalPrice<e.totalPrice?-1:t.totalPrice>e.totalPrice?1:0})),t.loading=!1)}))}},{key:"getTransportTickets",value:function(){var t=this;this.ticketService.getTicketTransportByRef(this.idTransaction).pipe(this.scavenger.collect(),Object(r.a)(3)).subscribe((function(e){e.length!==t.items?setTimeout((function(){return t.getTransportTickets()}),1e3):(t.transportTickets=e,t.loading=!1)}))}}]),t}(),T.\u0275fac=function(t){return new(t||T)(v.Qb(f.a),v.Qb(c.c),v.Qb(c.a),v.Qb(h.a),v.Qb(w))},T.\u0275cmp=v.Kb({type:T,selectors:[["app-transaction"]],decls:2,vars:2,consts:[["class","ui active dimmer h-100 w-100",4,"ngIf"],["class","ui main container segments mb-4 mt-4",4,"ngIf"],[1,"ui","active","dimmer","h-100","w-100"],[1,"ui","active","huge","text","inverted","loader"],[1,"ui","main","container","segments","mb-4","mt-4"],["class","ui raised segment",4,"ngIf"],[1,"ui","raised","segment"],[1,"ui","dividing","header"],[1,"ui","right","floated","button","download-button",3,"click"],["class","my-tickets-container",4,"ngIf"],[1,"ui","items"],[1,"item"],[1,"ui","small","rectangle","image"],["alt","",3,"src"],[1,"content"],[1,"header","event-title"],[1,"description","d-flex","flex-column"],[1,"item","d-flex","flex-column"],[1,"font-weight-normal"],[1,"my-tickets-container"],["class","d-flex flex-column ticket-container",3,"id","click",4,"ngFor","ngForOf"],[1,"d-flex","flex-column","ticket-container",3,"id","click"],[1,"overlay"],["title","Telecharger",1,"icon"],[1,"download","inverted","icon"],[1,"ticket-header"],["alt","event image","height","100","width","220",3,"src"],[3,"allowEmptyString","elementType","errorCorrectionLevel","margin","qrdata","version","width"],[1,"ticket-body"],[1,"text-uppercase"],[1,"w-100"],[1,"d-flex","flex-row","justify-content-around"],[1,"d-flex","flex-column","justify-content-start","align-items-center","logo-container"],["alt","logo bip","src","../../../assets/images/logo/bip-logo-ticket.jpg"],["alt","logo vendeur",3,"src"],[1,"d-flex","flex-row","justify-content-end","ticket-footer"],[1,"ticket-header","bus"],["alt","sen-dd bus img","height","100","src","../../../assets/images/icons/sen-dd2.jpg","width","220",1,"bus"],[1,"bus",3,"allowEmptyString","elementType","errorCorrectionLevel","margin","qrdata","version","width"],[1,"h7","font-weight-bold","mb-1","ml-2"],[1,"underlined"],[1,"h7","font-weight-bold","mb-1","text-center",2,"color","#FF6600"],[2,"width","100% !important"]],template:function(t,e){1&t&&(v.Sc(0,x,3,0,"div",0),v.Sc(1,_,10,3,"div",1)),2&t&&(v.uc("ngIf",e.loading),v.Cb(1),v.uc("ngIf",!e.loading))},directives:[o.q,o.p,k.a],pipes:[o.z,o.f,o.d],styles:[".content[_ngcontent-%COMP%] > .description[_ngcontent-%COMP%] > div[_ngcontent-%COMP%], .event-title[_ngcontent-%COMP%]{font-family:Font Awesome\\ 5 Free Solid,Open Sans,Ubuntu,Roboto,Helvetica Neue,sans-serif!important}.content[_ngcontent-%COMP%] > .description[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{font-size:14px;font-weight:400;display:flex;flex-flow:row;margin-bottom:3px}.content[_ngcontent-%COMP%] > .description[_ngcontent-%COMP%] > div[_ngcontent-%COMP%] > h6[_ngcontent-%COMP%]{font-weight:500;text-decoration:underline;margin-bottom:0}.download-button[_ngcontent-%COMP%]{background-color:#f60;color:#fff;position:absolute;right:0;top:4px}.my-tickets-container[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-between;flex-wrap:wrap;min-width:100%}.ticket-container[_ngcontent-%COMP%]{margin:0 0 20px;border:.3px solid #dedede;width:-webkit-max-content;width:-moz-max-content;width:max-content;height:-webkit-max-content;height:-moz-max-content;height:max-content;cursor:pointer;position:relative}.ticket-header[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:flex-start;align-items:center;height:170px}.ticket-header.bus[_ngcontent-%COMP%]{height:175px}.ticket-header[_ngcontent-%COMP%] > img[_ngcontent-%COMP%]:not(.bus){z-index:1;width:220px;height:100px}.ticket-header[_ngcontent-%COMP%] > qrcode[_ngcontent-%COMP%]{z-index:2;position:relative;bottom:20px}hr[_ngcontent-%COMP%]{margin:0 2px;border-color:#000}.ticket-body[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:flex-start;align-items:center}.ticket-body[_ngcontent-%COMP%] > span[_ngcontent-%COMP%]{margin-bottom:1px;width:100%;font-size:12px;line-height:17px;text-align:center}.ticket-body[_ngcontent-%COMP%] > span[_ngcontent-%COMP%]:first-child, .ticket-body[_ngcontent-%COMP%] > span[_ngcontent-%COMP%]:last-child{font-size:12px;font-weight:600}.ticket-body[_ngcontent-%COMP%] > span[_ngcontent-%COMP%]:last-child{color:#f60}.logo-container[_ngcontent-%COMP%] > p[_ngcontent-%COMP%]{margin-bottom:1px;font-size:12px}.logo-container[_ngcontent-%COMP%]:first-child > img[_ngcontent-%COMP%]{width:100px;height:45px}.logo-container[_ngcontent-%COMP%]:last-child > img[_ngcontent-%COMP%]{width:45px;height:45px}.ticket-footer[_ngcontent-%COMP%]{background-color:#000;height:20px;color:#fff;font-size:12px;margin-top:2px;padding-right:10px;font-family:open sans,sans-serif;font-weight:500;width:100%}.overlay[_ngcontent-%COMP%]{position:absolute;top:0;bottom:0;left:0;right:0;height:100%;width:100%;opacity:0;transition:.3s ease;z-index:4;background-color:#111}.ticket-container[_ngcontent-%COMP%]:hover   .overlay[_ngcontent-%COMP%]{opacity:.75}.icon[_ngcontent-%COMP%]{color:#f60;font-size:50px;position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);-ms-transform:translate(-50%,-50%);text-align:center}@media screen and (max-width:768px){.my-tickets-container[_ngcontent-%COMP%]{justify-content:space-evenly}}@media print{.ticket-container[_ngcontent-%COMP%]{margin:0!important;page-break-after:always}}"]}),T)}],R=((U=function t(){_classCallCheck(this,t)}).\u0275mod=v.Ob({type:U}),U.\u0275inj=v.Nb({factory:function(t){return new(t||U)},imports:[[c.g.forChild(S)],c.g]}),U),j=((E=function t(){_classCallCheck(this,t)}).\u0275mod=v.Ob({type:E}),E.\u0275inj=v.Nb({factory:function(t){return new(t||E)},imports:[[o.c,R,k.b]]}),E)}}]);