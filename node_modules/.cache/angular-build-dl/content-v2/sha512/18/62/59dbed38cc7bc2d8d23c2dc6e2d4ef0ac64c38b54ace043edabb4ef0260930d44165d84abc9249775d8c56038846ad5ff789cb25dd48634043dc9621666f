(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{lKKO:function(e,t,c){"use strict";c.r(t),c.d(t,"AccountModule",(function(){return ht}));var i=c("ofXK"),n=c("tyNb"),r=c("+0XT"),d=c("moCM"),s=c("4+6U"),o=c("EhJz"),a=c("wd/R"),l=c("0IaG"),u=c("MsxN"),f=c("PoRY"),h=c("PSD3"),g=c.n(h),p=c("un/a"),m=c("MlvY"),b=c("fXoL"),v=c("gcxx"),C=c("QnqH"),y=c("jzuh"),I=c("tk/3");let K=(()=>{class e{constructor(e,t){this.cookieService=e,this.http=t,this.url=new C.a}doSharing(e,t,c){return this.http.post(`${this.url.mainHost}/tickets/${t}/sharing`,e,{params:{username:this.getUsername(),dial:c},observe:"response"})}getSharing(e,t){return this.http.get(`${this.url.mainHost}/tickets/${t}/sharing/${e}`,{params:{username:this.getUsername()}})}revokeTicket(e,t){return this.http.get(`${this.url.mainHost}/tickets/${t}/sharing/${e}/revoke`,{params:{username:this.getUsername()},observe:"response"})}attributeTicket(e,t){return this.http.post(`${this.url.mainHost}/tickets/${e}/sharing/${t}/attribute`,null,{params:{username:this.getUsername()},observe:"response"})}getUsername(){return this.cookieService.getCookie("last_email")}}return e.\u0275fac=function(t){return new(t||e)(b.mc(y.a),b.mc(I.b))},e.\u0275prov=b.Ub({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var T=c("AXpb"),k=c("3Pt+");function w(e,t){if(1&e&&(b.ec(0,"tr"),b.ec(1,"td",14),b.cd(2,"Pr\xe9nom:"),b.dc(),b.ec(3,"td"),b.cd(4),b.uc(5,"titlecase"),b.dc(),b.dc()),2&e){const e=b.tc(2);b.Kb(4),b.dd(b.vc(5,1,e.sharedTo.firstName))}}function N(e,t){if(1&e&&(b.ec(0,"tr"),b.ec(1,"td",14),b.cd(2,"Nom:"),b.dc(),b.ec(3,"td"),b.cd(4),b.uc(5,"titlecase"),b.dc(),b.dc()),2&e){const e=b.tc(2);b.Kb(4),b.dd(b.vc(5,1,e.sharedTo.lastName))}}function S(e,t){if(1&e&&(b.ec(0,"tr"),b.ec(1,"td",14),b.cd(2,"T\xe9l\xe9phone:"),b.dc(),b.ec(3,"td"),b.cd(4),b.dc(),b.dc()),2&e){const e=b.tc(2);b.Kb(4),b.dd(e.sharedTo.telephone)}}function E(e,t){if(1&e&&(b.ec(0,"tr"),b.ec(1,"td",14),b.cd(2,"Classe:"),b.dc(),b.ec(3,"td"),b.cd(4),b.dc(),b.dc()),2&e){const e=b.tc(2);b.Kb(4),b.dd(e.item.type)}}function x(e,t){if(1&e&&(b.ec(0,"tr"),b.ec(1,"td",14),b.cd(2,"Type d'\xe9v\xe9nement:"),b.dc(),b.ec(3,"td"),b.cd(4),b.uc(5,"titlecase"),b.dc(),b.dc()),2&e){const e=b.tc(2);b.Kb(4),b.dd(b.vc(5,1,e.event.eventType))}}function M(e,t){if(1&e&&(b.ec(0,"tr"),b.ec(1,"td",14),b.cd(2,"D\xe9signation:"),b.dc(),b.ec(3,"td"),b.cd(4),b.dc(),b.dc()),2&e){const e=b.tc(2);b.Kb(4),b.dd(e.event.designation)}}function q(e,t){if(1&e&&(b.ec(0,"tr"),b.ec(1,"td",14),b.cd(2,"D\xe9but:"),b.dc(),b.ec(3,"td"),b.cd(4),b.uc(5,"date"),b.dc(),b.dc()),2&e){const e=b.tc(2);b.Kb(4),b.fd("",b.xc(5,2,e.item.startingDate,"dd MMMM yyyy","UTC")," \xe1 ",e.event.startingTime,"")}}function O(e,t){if(1&e&&(b.ec(0,"tr"),b.ec(1,"td",14),b.cd(2,"Fin:"),b.dc(),b.ec(3,"td"),b.cd(4),b.uc(5,"date"),b.dc(),b.dc()),2&e){const e=b.tc(2);b.Kb(4),b.fd("",b.xc(5,2,e.item.endingDate,"dd MMMM yyyy","UTC")," \xe1 ",e.event.endingTime,"")}}function D(e,t){if(1&e&&(b.ec(0,"tr"),b.ec(1,"td",14),b.cd(2,"Type transport:"),b.dc(),b.ec(3,"td"),b.cd(4),b.uc(5,"titlecase"),b.dc(),b.dc()),2&e){const e=b.tc(2);b.Kb(4),b.fd("",e.item.transportType+": ","",b.vc(5,2,e.item.transportName),"")}}function P(e,t){if(1&e&&(b.ec(0,"tr"),b.ec(1,"td",14),b.cd(2,"Date:"),b.dc(),b.ec(3,"td"),b.cd(4),b.uc(5,"titlecase"),b.uc(6,"date"),b.dc(),b.dc()),2&e){const e=b.tc(2);b.Kb(4),b.fd("",b.vc(5,2,b.xc(6,4,e.item.departDate,"dd MMMM yyyy","UTC"))," \xe1 ",e.item.departTime,"")}}function L(e,t){if(1&e&&(b.ec(0,"tr"),b.ec(1,"td",14),b.cd(2,"D\xe9part:"),b.dc(),b.ec(3,"td"),b.cd(4),b.uc(5,"titlecase"),b.dc(),b.dc()),2&e){const e=b.tc(2);b.Kb(4),b.dd(b.vc(5,1,e.item.departLocation))}}function V(e,t){if(1&e&&(b.ec(0,"tr"),b.ec(1,"td",14),b.cd(2,"Destination:"),b.dc(),b.ec(3,"td"),b.cd(4),b.uc(5,"titlecase"),b.dc(),b.dc()),2&e){const e=b.tc(2);b.Kb(4),b.dd(b.vc(5,1,e.item.arrivalLocation))}}function F(e,t){if(1&e&&(b.ec(0,"tr"),b.ec(1,"td",14),b.cd(2,"Lieu:"),b.dc(),b.ec(3,"td"),b.cd(4),b.uc(5,"titlecase"),b.dc(),b.dc()),2&e){const e=b.tc(2);b.Kb(4),b.dd(b.vc(5,1,e.event.place.designation))}}function R(e,t){if(1&e&&(b.ec(0,"div",12),b.ec(1,"table",13),b.ec(2,"tbody"),b.ec(3,"tr"),b.ec(4,"td",14),b.cd(5,"Code billet:"),b.dc(),b.ec(6,"td"),b.cd(7),b.dc(),b.dc(),b.ad(8,w,6,3,"tr",15),b.ad(9,N,6,3,"tr",15),b.ad(10,S,5,1,"tr",15),b.ad(11,E,5,1,"tr",15),b.ad(12,x,6,3,"tr",15),b.ad(13,M,5,1,"tr",15),b.ad(14,q,6,6,"tr",15),b.ad(15,O,6,6,"tr",15),b.ad(16,D,6,4,"tr",15),b.ad(17,P,7,8,"tr",15),b.ad(18,L,6,3,"tr",15),b.ad(19,V,6,3,"tr",15),b.ad(20,F,6,3,"tr",15),b.ec(21,"tr"),b.ec(22,"td",14),b.cd(23,"ID transaction:"),b.dc(),b.ec(24,"td"),b.cd(25),b.dc(),b.dc(),b.ec(26,"tr"),b.ec(27,"td",14),b.cd(28,"Pay\xe9 avec:"),b.dc(),b.ec(29,"td"),b.cd(30),b.uc(31,"titlecase"),b.dc(),b.dc(),b.ec(32,"tr"),b.ec(33,"td",14),b.cd(34,"Date transaction:"),b.dc(),b.ec(35,"td"),b.cd(36),b.uc(37,"titlecase"),b.uc(38,"date"),b.uc(39,"date"),b.dc(),b.dc(),b.ec(40,"tr"),b.ec(41,"td",14),b.cd(42,"Prix:"),b.dc(),b.ec(43,"td"),b.cd(44),b.uc(45,"currency"),b.dc(),b.dc(),b.dc(),b.dc(),b.dc()),2&e){const e=b.tc();b.Kb(7),b.dd(e.item.isShared?"PARTAGER":e.item.codeTicket),b.Kb(1),b.Cc("ngIf",e.item.isShared),b.Kb(1),b.Cc("ngIf",e.item.isShared),b.Kb(1),b.Cc("ngIf",e.item.isShared),b.Kb(1),b.Cc("ngIf","event"===e.type&&void 0!==e.event),b.Kb(1),b.Cc("ngIf","event"===e.type&&void 0!==e.event),b.Kb(1),b.Cc("ngIf","event"===e.type&&void 0!==e.event),b.Kb(1),b.Cc("ngIf","event"==e.type&&void 0!==e.event),b.Kb(1),b.Cc("ngIf","event"===e.type&&void 0!==e.event),b.Kb(1),b.Cc("ngIf","transport"===e.type),b.Kb(1),b.Cc("ngIf","transport"===e.type),b.Kb(1),b.Cc("ngIf","transport"===e.type),b.Kb(1),b.Cc("ngIf","transport"===e.type),b.Kb(1),b.Cc("ngIf","event"===e.type&&void 0!==e.event),b.Kb(5),b.dd(e.item.transactionNumber),b.Kb(5),b.dd(null==e.item.transactionType?"Ind\xe9fini":b.vc(31,19,e.item.transactionType)),b.Kb(6),b.fd("",b.vc(37,21,b.xc(38,23,e.item.updatedAt,"dd MMMM yyyy","UTC"))," ",b.xc(39,27,e.item.updatedAt,"\xe1 HH:MM","UTC"),""),b.Kb(8),b.dd(b.yc(45,31,e.item.totalPrice,"XOF","symbol","1.1-2"))}}function A(e,t){1&e&&(b.ec(0,"div"),b.ec(1,"p",24),b.cd(2,"Ce champ est requis"),b.dc(),b.dc())}function U(e,t){1&e&&(b.ec(0,"div"),b.ec(1,"p",24),b.cd(2,"Ce champ est requis"),b.dc(),b.dc())}function $(e,t){if(1&e&&(b.ec(0,"option",25),b.cd(1),b.dc()),2&e){const e=t.$implicit;b.Cc("value",e.code),b.Kb(1),b.dd(e.dial_code)}}function H(e,t){1&e&&(b.ec(0,"p",24),b.cd(1,"Ce champ est requis"),b.dc())}function j(e,t){1&e&&(b.ec(0,"p",24),b.cd(1,"Le format de votre t\xe9l\xe9phone n'est pas valide."),b.dc())}function z(e,t){if(1&e&&(b.ec(0,"div"),b.ad(1,H,2,0,"p",26),b.ad(2,j,2,0,"p",26),b.dc()),2&e){const e=b.tc(2);b.Kb(1),b.Cc("ngIf",e.fieldValidity.get("telephone").includes("required")),b.Kb(1),b.Cc("ngIf",e.fieldValidity.get("telephone").includes("badFormat"))}}function Y(e,t){if(1&e){const e=b.fc();b.ec(0,"div",16),b.ec(1,"div",17),b.ec(2,"label"),b.cd(3,"Pr\xe9nom"),b.dc(),b.ec(4,"input",18),b.qc("focusin",(function(){return b.Tc(e),b.tc().fieldValidity.delete("firstName")}))("focusout",(function(){return b.Tc(e),b.tc().checkFields("firstName")}))("ngModelChange",(function(t){return b.Tc(e),b.tc().sharedTo.firstName=t})),b.dc(),b.ad(5,A,3,0,"div",15),b.dc(),b.ec(6,"div",17),b.ec(7,"label"),b.cd(8,"Nom"),b.dc(),b.ec(9,"input",19),b.qc("focusin",(function(){return b.Tc(e),b.tc().fieldValidity.delete("lastName")}))("focusout",(function(){return b.Tc(e),b.tc().checkFields("lastName")}))("ngModelChange",(function(t){return b.Tc(e),b.tc().sharedTo.lastName=t})),b.dc(),b.ad(10,U,3,0,"div",15),b.dc(),b.ec(11,"div",17),b.ec(12,"label"),b.cd(13,"T\xe9l\xe9phone"),b.dc(),b.ec(14,"div",20),b.ec(15,"select",21),b.qc("ngModelChange",(function(t){return b.Tc(e),b.tc().sharedTo.countryCode=t})),b.ad(16,$,2,2,"option",22),b.dc(),b.ec(17,"input",23),b.qc("focusout",(function(){return b.Tc(e),b.tc().checkFields("telephone")}))("keyup",(function(){return b.Tc(e),b.tc().formatNumber()}))("ngModelChange",(function(t){return b.Tc(e),b.tc().sharedTo.telephone=t})),b.dc(),b.dc(),b.ad(18,z,3,2,"div",15),b.dc(),b.dc()}if(2&e){const e=b.tc();b.Kb(1),b.Cc("ngClass",e.fieldValidity.has("firstName")?"error":""),b.Kb(3),b.Cc("ngModel",e.sharedTo.firstName),b.Kb(1),b.Cc("ngIf",e.fieldValidity.has("firstName")),b.Kb(1),b.Cc("ngClass",e.fieldValidity.has("lastName")?"error":""),b.Kb(3),b.Cc("ngModel",e.sharedTo.lastName),b.Kb(1),b.Cc("ngIf",e.fieldValidity.has("lastName")),b.Kb(1),b.Cc("ngClass",e.fieldValidity.has("telephone")?"error":""),b.Kb(4),b.Cc("ngModel",e.sharedTo.countryCode),b.Kb(1),b.Cc("ngForOf",e.countries),b.Kb(1),b.Cc("ngModel",e.sharedTo.telephone),b.Kb(1),b.Cc("ngIf",e.fieldValidity.has("telephone"))}}function X(e,t){1&e&&(b.ec(0,"button",27),b.cd(1,"Fermer"),b.dc())}function Z(e,t){if(1&e){const e=b.fc();b.ec(0,"button",28),b.qc("click",(function(){return b.Tc(e),b.tc().sharing=!0})),b.cd(1,"Partager"),b.dc()}}function _(e,t){if(1&e){const e=b.fc();b.ec(0,"button",28),b.qc("click",(function(){return b.Tc(e),b.tc().revokeSharing()})),b.cd(1," Supprimer le partage "),b.dc()}}function B(e,t){if(1&e){const e=b.fc();b.ec(0,"button",29),b.qc("click",(function(){return b.Tc(e),b.tc().attributeTicket()})),b.cd(1," Attribuer le ticket "),b.dc()}}function G(e,t){if(1&e){const e=b.fc();b.ec(0,"button",30),b.qc("click",(function(){return b.Tc(e),b.tc().cancelSharing()})),b.cd(1,"Annuler"),b.dc()}}function J(e,t){if(1&e){const e=b.fc();b.ec(0,"button",28),b.qc("click",(function(){return b.Tc(e),b.tc().doSharing()})),b.cd(1,"Valider"),b.dc()}}class W{constructor(){this.ticketId="",this.firstName="",this.lastName="",this.telephone="",this.countryCode="SN"}}let Q=(()=>{class e{constructor(e,t,c,i,n){this.dialogRef=e,this.data=t,this.eventService=c,this.sharingService=i,this.errorHandler=n,this.loading=!0,this.sharing=!1,this.sharedTo=new W,this.countries=(new u.a).countries,this.fieldValidity=new Map,this.scavenger=new r.Scavenger(this)}ngOnDestroy(){}ngOnInit(){this.loading=!0,this.type=this.data.type,"transport"===this.type?this.item=this.data.item:"event"===this.type&&(this.item=this.data.item,this.getEvent(this.item.eventId)),this.item.isShared?this.getSharing():this.loading=!1}formatNumber(){this.sharedTo.telephone=Object(f.b)(this.sharedTo.telephone,this.sharedTo.countryCode)}checkFields(e){const t=[];0===this.sharedTo[e].length?t.push("required"):"telephone"!==e||Object(f.d)(this.sharedTo.telephone,this.sharedTo.countryCode)||t.push("badFormat"),t.length>0?this.fieldValidity.set(e,t):this.fieldValidity.delete(e)}cancelSharing(){this.sharedTo=new W,this.fieldValidity.clear(),this.sharing=!1}doSharing(){if(this.loading=!0,Array.of("firstName","lastName","telephone").forEach(e=>this.checkFields(e)),this.fieldValidity.size>0)g.a.fire("Erreur","Veuillez corriger le formulaire!","error");else{this.sharedTo.ticketId=this.item.codeTicket,this.sharedTo.telephone=this.sharedTo.telephone.split(" ").join("");const e=this.countries.find(e=>e.code===this.sharedTo.countryCode).dial_code.replace("+","");this.sharingService.doSharing(JSON.stringify(this.sharedTo),this.type,e).pipe(this.scavenger.collect(),Object(p.a)(2)).subscribe(e=>{if(200===e.status){const e=this.type="le d\xe9but de l'\xe9v\xe9nement";this.messageDialog("Partage","<p>Le partage du ticket num\xe9ro "+this.sharedTo.ticketId+" a r\xe9ussi. Un SMS de confirmation a \xe9t\xe9 envoy\xe9 a "+this.sharedTo.firstName+" "+this.sharedTo.lastName+".Vous pouvez r\xe9voquer le partage de ce ticket depuis votre espace personnel. <br/> <strong> VEUILLEZ NOTER: </strong> Vous ne pourrez plus retirer ce billet au nouveau d\xe9tenteur s'il reste moins d'une heure avant "+e+"</p>","success")}else 404===e.status&&this.errorDialog()},e=>{this.errorHandler.handleError(e),this.loading=!1})}}revokeSharing(){this.loading=!0,this.sharingService.revokeTicket(this.item.sharingId,this.type).pipe(this.scavenger.collect()).subscribe(e=>{e.ok?this.messageDialog("Reussi","Le partage de ce ticket a \xe9t\xe9 supprim\xe9 avec succ\xe8s. Vous \xeates \xe0 nouveau son titulaire.","success"):this.errorDialog()},e=>{this.errorHandler.handleError(e),this.loading=!1})}attributeTicket(){const e=`<strong>${m(this.sharedTo.firstName)} ${m(this.sharedTo.lastName)}</strong>`;g.a.fire({title:"Attribution de ticket",html:"<p>Vous \xeates sur le point d'attribuer le ticket \xe0 "+e+". Une fois l'attribution effectu\xe9e, vous ne pourrez plus effectuer aucune action sur ce ticket. "+e+" deviendra le nouveau propri\xe9taire du ticket. Souhaitez-vous continuer ?</p>",icon:"question",allowEscapeKey:!1,allowEnterKey:!1,allowOutsideClick:!1,showCloseButton:!1,showCancelButton:!0,cancelButtonText:"Non",confirmButtonText:"Oui",focusConfirm:!0,cancelButtonColor:"red",confirmButtonColor:"green"}).then(e=>{e.value?this.doAttribution():e.dismiss&&g.a.fire("Attribution","L'attribution du ticket a \xe9t\xe9 annul\xe9!","info")})}doAttribution(){this.sharingService.attributeTicket(this.type,this.item.sharingId).pipe(Object(p.a)(2),this.scavenger.collect()).subscribe(e=>{e.ok?this.messageDialog("Attribution","Le ticket a \xe9t\xe9 attribu\xe9 avec succ\xe8s.","success"):this.messageDialog("Attribution","L'attribution du ticket a \xe9chou\xe9. Veuillez r\xe9essayer SVP.","error")},e=>{this.errorHandler.handleError(e),this.loading=!1})}getEvent(e){this.eventService.getAnEvent(e).pipe(this.scavenger.collect(),Object(p.a)(2)).subscribe(e=>this.event=e,e=>{this.errorHandler.handleError(e),this.loading=!1},()=>{this.item.isShared?this.getSharing():this.loading=!1})}getSharing(){this.sharingService.getSharing(this.item.sharingId,this.type).pipe(this.scavenger.collect(),Object(p.a)(2)).subscribe(e=>{this.sharedTo=e,this.formatNumber()},e=>{this.errorHandler.handleError(e),this.loading=!1},()=>this.loading=!1)}messageDialog(e,t,c){g.a.fire({title:e,html:t,icon:c,showCloseButton:!1,allowEnterKey:!1,allowOutsideClick:!1,allowEscapeKey:!1}).then(e=>{e.value&&location.reload()})}errorDialog(){g.a.fire("Erreur","Une erreur est survenue. Veuillez r\xe9essayer SVP!","error").then(e=>{e&&(this.loading=!1)})}}return e.\u0275fac=function(t){return new(t||e)(b.Yb(l.g),b.Yb(l.a),b.Yb(v.a),b.Yb(K),b.Yb(T.a))},e.\u0275cmp=b.Sb({type:e,selectors:[["app-details-ticket"]],decls:16,vars:10,consts:[[1,"ui","very","raised","segments"],[1,"ui","inverted","dimmer",3,"ngClass"],[1,"ui","text","loader"],["mat-dialog-title","",1,"ui","segment"],[1,"ui","header"],["class","ui segment fluid pt-1 pb-2",4,"ngIf"],["class","ui segment form fluid pt-1 pb-2",4,"ngIf"],[1,"ui","segment","d-flex","flex-row","justify-content-end","fluid"],["class","ui orange large button right floated mr-3","mat-dialog-close","",4,"ngIf"],["class","ui green large button right floated",3,"click",4,"ngIf"],["class","ui violet large button right floated",3,"click",4,"ngIf"],["class","ui teal large button right floated",3,"click",4,"ngIf"],[1,"ui","segment","fluid","pt-1","pb-2"],[1,"ui","very","basic","table"],[1,"right","aligned"],[4,"ngIf"],[1,"ui","segment","form","fluid","pt-1","pb-2"],[1,"required","field",3,"ngClass"],["name","fName","type","text",3,"ngModel","focusin","focusout","ngModelChange"],["name","lName","type","text",3,"ngModel","focusin","focusout","ngModelChange"],[1,"ui","left","labeled","input"],["name","code",1,"ui","dropdown","selection","share-tel","mr-2","mb-0","h6",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["name","telephone","placeholder","Telephone",3,"ngModel","focusout","keyup","ngModelChange"],[1,"error"],[3,"value"],["class","error",4,"ngIf"],["mat-dialog-close","",1,"ui","orange","large","button","right","floated","mr-3"],[1,"ui","green","large","button","right","floated",3,"click"],[1,"ui","violet","large","button","right","floated",3,"click"],[1,"ui","teal","large","button","right","floated",3,"click"]],template:function(e,t){1&e&&(b.ec(0,"div",0),b.ec(1,"div",1),b.ec(2,"div",2),b.cd(3,"Chargement"),b.dc(),b.dc(),b.ec(4,"div",3),b.ec(5,"p",4),b.cd(6),b.dc(),b.dc(),b.ad(7,R,46,36,"div",5),b.ad(8,Y,19,11,"div",6),b.ec(9,"div",7),b.ad(10,X,2,0,"button",8),b.ad(11,Z,2,0,"button",9),b.ad(12,_,2,0,"button",9),b.ad(13,B,2,0,"button",10),b.ad(14,G,2,0,"button",11),b.ad(15,J,2,0,"button",9),b.dc(),b.dc()),2&e&&(b.Kb(1),b.Cc("ngClass",t.loading?"active":""),b.Kb(5),b.dd(t.sharing?"Partage de ticket":"Details Billet"),b.Kb(1),b.Cc("ngIf",!t.sharing),b.Kb(1),b.Cc("ngIf",t.sharing),b.Kb(2),b.Cc("ngIf",!t.sharing),b.Kb(1),b.Cc("ngIf",!t.sharing&&!t.item.isShared),b.Kb(1),b.Cc("ngIf",!t.sharing&&t.item.isShared),b.Kb(1),b.Cc("ngIf",!t.sharing&&t.item.isShared),b.Kb(1),b.Cc("ngIf",t.sharing),b.Kb(1),b.Cc("ngIf",t.sharing))},directives:[i.p,l.h,i.r,k.c,k.n,k.q,k.w,i.q,k.r,k.y,l.d],pipes:[i.A,i.f,i.d],styles:['.ui[class*="very basic"].table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:first-child{font-weight:600;font-size:15px;padding-right:15px!important}.ui[class*="very basic"].table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{color:#444;padding:7px 0!important}.share-tel[_ngcontent-%COMP%]{min-width:auto!important;width:100px!important;padding-right:0!important}']}),e})();var ee=c("xG9w");let te=(()=>{class e{constructor(e,t){this.cookiesService=e,this.http=t,this.urls=new C.a}getUser(){return this.http.get(`${this.urls.mainHost}/user/search`,{params:{username:this.getUsername()}})}getTransportTickets(){return this.http.get(`${this.urls.mainHost}/user/${this.getUsername()}/tickets/transport`)}getEventTickets(){return this.http.get(`${this.urls.mainHost}/user/${this.getUsername()}/tickets/event`)}updatePassword(e,t){return this.http.post(`${this.urls.mainHost}/password`,JSON.stringify({username:this.getUsername(),oldPassword:e,newPassword:t}),{observe:"response"})}updateUser(e){return this.http.post(`${this.urls.mainHost}/user/${this.getUsername()}/profile`,JSON.stringify(e),{observe:"response"})}getUsername(){return this.cookiesService.getCookie("last_email")}}return e.\u0275fac=function(t){return new(t||e)(b.mc(y.a),b.mc(I.b))},e.\u0275prov=b.Ub({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();function ce(e,t){1&e&&(b.ec(0,"div",2),b.ec(1,"div",3),b.cd(2,"Chargement"),b.dc(),b.dc())}function ie(e,t){1&e&&(b.ec(0,"td",18),b.cd(1,"EXPIR\xe9e"),b.dc())}function ne(e,t){1&e&&(b.ec(0,"td",19),b.cd(1,"PARTAGER"),b.dc())}function re(e,t){if(1&e&&(b.ec(0,"td"),b.cd(1),b.uc(2,"titlecase"),b.uc(3,"date"),b.dc()),2&e){const e=b.tc().$implicit,t=b.tc(4);b.Kb(1),b.fd(" ",b.vc(2,2,b.xc(3,4,t.pipeDate(e.departDate),"dd MMMM yyyy","UTC"))," \xe1 ",e.departTime," ")}}function de(e,t){if(1&e){const e=b.fc();b.ec(0,"tr",14),b.qc("click",(function(){b.Tc(e);const c=t.$implicit;return b.tc(4).ticketDetails(c,"transport")})),b.ad(1,ie,2,0,"td",15),b.ad(2,ne,2,0,"td",16),b.ad(3,re,4,8,"td",12),b.ec(4,"td"),b.cd(5),b.uc(6,"titlecase"),b.dc(),b.ec(7,"td"),b.cd(8),b.uc(9,"titlecase"),b.dc(),b.ec(10,"td",17),b.cd(11),b.dc(),b.ec(12,"td",17),b.cd(13),b.uc(14,"titlecase"),b.dc(),b.dc()}if(2&e){const e=t.$implicit;b.Cc("ngClass","EXPIRER"===e.codeTicket?"center aligned clear":"center aligned cursor-pointer"),b.Kb(1),b.Cc("ngIf","EXPIRER"===e.codeTicket),b.Kb(1),b.Cc("ngIf","EXPIRER"!==e.codeTicket&&e.isShared),b.Kb(1),b.Cc("ngIf","EXPIRER"!==e.codeTicket&&!e.isShared),b.Kb(2),b.dd(b.vc(6,10,e.departLocation)),b.Kb(3),b.dd(b.vc(9,12,e.arrivalLocation)),b.Kb(2),b.Cc("ngClass","EXPIRER"===e.codeTicket?"strikeout":""),b.Kb(1),b.dd(e.transportType),b.Kb(1),b.Cc("ngClass","EXPIRER"===e.codeTicket?"strikeout":""),b.Kb(1),b.dd(b.vc(14,14,e.transportName))}}function se(e,t){if(1&e&&(b.ec(0,"tbody"),b.ad(1,de,15,16,"tr",13),b.dc()),2&e){const e=b.tc(3);b.Kb(1),b.Cc("ngForOf",e.transportTickets)}}function oe(e,t){1&e&&(b.ec(0,"tr",9),b.ec(1,"td",21),b.cd(2,"Aucun billet disponible"),b.dc(),b.dc())}function ae(e,t){if(1&e&&(b.ec(0,"tbody"),b.ad(1,oe,3,0,"tr",20),b.dc()),2&e){const e=b.tc(3);b.Kb(1),b.Cc("ngForOf",e.transportTickets)}}function le(e,t){if(1&e&&(b.ec(0,"table",8),b.ec(1,"thead"),b.ec(2,"tr",9),b.ec(3,"th",10),b.cd(4,"Date"),b.dc(),b.ec(5,"th",11),b.cd(6,"Itineraire"),b.dc(),b.ec(7,"th",11),b.cd(8,"Transport"),b.dc(),b.dc(),b.ec(9,"tr",9),b.ec(10,"th"),b.cd(11,"D\xe9part"),b.dc(),b.ec(12,"th"),b.cd(13,"Arriv\xe9"),b.dc(),b.ec(14,"th"),b.cd(15,"Type"),b.dc(),b.ec(16,"th"),b.cd(17,"D\xe9signation"),b.dc(),b.dc(),b.dc(),b.ad(18,se,2,1,"tbody",12),b.ad(19,ae,2,1,"tbody",12),b.dc()),2&e){const e=b.tc(2);b.Kb(18),b.Cc("ngIf",e.transportTickets&&e.transportTickets.length>0),b.Kb(1),b.Cc("ngIf",e.transportTickets&&0===e.transportTickets.length)}}function ue(e,t){1&e&&(b.ec(0,"td",19),b.cd(1,"PARTAGER"),b.dc())}function fe(e,t){if(1&e&&(b.ec(0,"td"),b.cd(1),b.uc(2,"titlecase"),b.uc(3,"date"),b.dc()),2&e){const e=b.tc().$implicit,t=b.tc(3);b.Kb(1),b.ed(" ",b.vc(2,1,b.xc(3,3,t.getLinkedEvent(e).startingDate,"dd MMMM yyyy","UTC"))," ")}}function he(e,t){1&e&&(b.ec(0,"td",18),b.cd(1,"EXPIR\xe9e"),b.dc())}function ge(e,t){if(1&e){const e=b.fc();b.ec(0,"tr",14),b.qc("click",(function(){b.Tc(e);const c=t.$implicit;return b.tc(3).ticketDetails(c,"event")})),b.ad(1,ue,2,0,"td",16),b.ad(2,fe,4,7,"td",12),b.ad(3,he,2,0,"td",15),b.ec(4,"td"),b.cd(5),b.uc(6,"titlecase"),b.dc(),b.ec(7,"td"),b.cd(8),b.uc(9,"titlecase"),b.dc(),b.ec(10,"td"),b.cd(11),b.dc(),b.ec(12,"td"),b.cd(13),b.uc(14,"currency"),b.dc(),b.dc()}if(2&e){const e=t.$implicit,c=b.tc(3);b.Cc("ngClass","EXPIRER"===e.codeTicket?"center aligned clear":"center aligned cursor-pointer"),b.Kb(1),b.Cc("ngIf","EXPIRER"!==e.codeTicket&&e.isShared),b.Kb(1),b.Cc("ngIf","EXPIRER"!==e.codeTicket&&!e.isShared),b.Kb(1),b.Cc("ngIf","EXPIRER"===e.codeTicket),b.Kb(2),b.dd(b.vc(6,8,c.getLinkedEvent(e).designation)),b.Kb(3),b.dd(b.vc(9,10,c.getLinkedEvent(e).place.designation)),b.Kb(3),b.dd(e.type),b.Kb(2),b.dd(b.yc(14,12,e.totalPrice,"XOF","symbol","1.1-2"))}}function pe(e,t){if(1&e&&(b.ec(0,"table",8),b.ec(1,"thead"),b.ec(2,"tr",9),b.ec(3,"th",22),b.cd(4,"Date"),b.dc(),b.ec(5,"th"),b.cd(6,"D\xe9signation"),b.dc(),b.ec(7,"th"),b.cd(8,"Lieu"),b.dc(),b.ec(9,"th"),b.cd(10,"Classe"),b.dc(),b.ec(11,"th"),b.cd(12,"Prix"),b.dc(),b.dc(),b.dc(),b.ec(13,"tbody"),b.ad(14,ge,15,17,"tr",13),b.dc(),b.dc()),2&e){const e=b.tc(2);b.Kb(14),b.Cc("ngForOf",e.eventTickets)}}function me(e,t){if(1&e&&(b.ec(0,"div",4),b.ec(1,"div",5),b.ec(2,"div",6),b.cd(3,"Mes titres de transport"),b.dc(),b.ad(4,le,20,2,"table",7),b.ec(5,"div",6),b.cd(6,"Mes tickets d'evenement"),b.dc(),b.ad(7,pe,15,1,"table",7),b.dc(),b.dc()),2&e){const e=b.tc();b.Kb(4),b.Cc("ngIf",e.transportTickets),b.Kb(3),b.Cc("ngIf",e.eventTickets)}}let be=(()=>{class e{constructor(e,t,c,i){this.userService=e,this.eventService=t,this.errorHandler=c,this.dialog=i,this.scavenger=new r.Scavenger(this)}ngOnInit(){this.getTransportTickets(),this.getEventTickets()}ngOnDestroy(){}ticketDetails(e,t){this.dialog.open(Q,{width:window.innerWidth>400?"550px":"380px",height:"max-content",id:"user-details-ticket-dialog",hasBackdrop:!0,disableClose:!0,closeOnNavigation:!0,data:{type:t,item:e}}).afterClosed().subscribe(e=>{})}pipeDate(e){return new Date(e)}getLinkedEvent(e){return this.events.find(t=>t.eventId===e.eventId)}checkExpiry(e){const t=new Date(e.departDate),c=e.departTime.toString().split(":");return t.setHours(Number(c[0])),t.setMinutes(Number(c[1])),Object(d.a)(Object(s.a)(t.toISOString()),new Date(Object(a.now)()))<1}getTransportTickets(){this.userService.getTransportTickets().pipe(this.scavenger.collect()).subscribe(e=>{e.forEach(e=>{this.checkExpiry(e)&&(e.codeTicket="EXPIRER")}),this.transportTickets=e},e=>{this.errorHandler.handleError(e),location.reload()})}getEventTickets(){this.userService.getEventTickets().pipe(this.scavenger.collect()).subscribe(e=>{const t=ee.e(e.map(e=>e.eventId));this.getEvents(t,e)},e=>{this.errorHandler.handleError(e),location.reload()})}getEvents(e,t){this.eventService.getListedEvents(e).pipe(this.scavenger.collect()).subscribe(e=>{this.events=e,e.forEach(e=>{Object(o.a)(Object(s.a)(e.startingDate.toString()),new Date(Object(a.now)()))||(t.find(t=>t.eventId===e.eventId).codeTicket="EXPIRER")})},e=>{this.errorHandler.handleError(e),location.reload()},()=>this.eventTickets=t)}}return e.\u0275fac=function(t){return new(t||e)(b.Yb(te),b.Yb(v.a),b.Yb(T.a),b.Yb(l.b))},e.\u0275cmp=b.Sb({type:e,selectors:[["app-my-tickets"]],decls:2,vars:2,consts:[["class","ui active dimmer h-100 w-100",4,"ngIf"],["class","container mt-3 mb-3",4,"ngIf"],[1,"ui","active","dimmer","h-100","w-100"],[1,"ui","active","huge","text","inverted","loader"],[1,"container","mt-3","mb-3"],[1,"ui","raised","segment"],[1,"ui","header","text-center"],["class","ui mini table celled very compact striped structured selectable",4,"ngIf"],[1,"ui","mini","table","celled","very","compact","striped","structured","selectable"],[1,"center","aligned"],["rowspan","2",2,"width","200px"],["colspan","2"],[4,"ngIf"],[3,"ngClass","click",4,"ngFor","ngForOf"],[3,"ngClass","click"],["class","transport-expired text-uppercase",4,"ngIf"],["class","ticket-shared",4,"ngIf"],[3,"ngClass"],[1,"transport-expired","text-uppercase"],[1,"ticket-shared"],["class","center aligned",4,"ngFor","ngForOf"],["colspan","9"],[2,"width","150px"]],template:function(e,t){1&e&&(b.ad(0,ce,3,0,"div",0),b.ad(1,me,8,2,"div",1)),2&e&&(b.Cc("ngIf",!t.transportTickets||!t.eventTickets),b.Kb(1),b.Cc("ngIf",t.transportTickets&&t.eventTickets))},directives:[i.r,i.q,i.p],pipes:[i.A,i.f,i.d],styles:["tr.clear[_ngcontent-%COMP%]{cursor:default;pointer-events:none}.transport-expired[_ngcontent-%COMP%]{background-color:red;color:#fff;font-weight:700}.strikeout[_ngcontent-%COMP%]{-webkit-text-decoration-line:line-through;text-decoration-line:line-through}.ticket-shared[_ngcontent-%COMP%]{background-color:green;color:#fff;font-weight:700}"]}),e})();var ve=c("LG61"),Ce=c("DrXB"),ye=c("qIOU");function Ie(e,t){1&e&&(b.ec(0,"div",16),b.cd(1,"Ce champ est requis."),b.dc())}function Ke(e,t){if(1&e&&(b.ec(0,"div"),b.ad(1,Ie,2,0,"div",15),b.dc()),2&e){const e=b.tc();b.Kb(1),b.Cc("ngIf",e.f.old.errors.required)}}function Te(e,t){1&e&&(b.ec(0,"div",16),b.cd(1,"Ce champ est requis."),b.dc())}function ke(e,t){1&e&&(b.ec(0,"div",16),b.cd(1,"Veuillez saisir au moins huit caracteres."),b.dc())}function we(e,t){if(1&e&&(b.ec(0,"div"),b.ad(1,Te,2,0,"div",15),b.ad(2,ke,2,0,"div",15),b.dc()),2&e){const e=b.tc();b.Kb(1),b.Cc("ngIf",e.f.new.errors.required),b.Kb(1),b.Cc("ngIf",e.f.new.errors.minlength)}}function Ne(e,t){1&e&&(b.ec(0,"div",16),b.cd(1,"Ce champ est requis."),b.dc())}function Se(e,t){1&e&&(b.ec(0,"div",16),b.cd(1,"Les mot de passe ne correspondent pas!"),b.dc())}function Ee(e,t){if(1&e&&(b.ec(0,"div"),b.ad(1,Ne,2,0,"div",15),b.ad(2,Se,2,0,"div",15),b.dc()),2&e){const e=b.tc();b.Kb(1),b.Cc("ngIf",e.f.confirm.errors.required),b.Kb(1),b.Cc("ngIf",e.f.confirm.errors.mustMatch)}}let xe=(()=>{class e{constructor(e,t,c,i,n,d){this.dialogRef=e,this.data=t,this.formBuilder=c,this.userService=i,this.authService=n,this.errorHandler=d,this.loading=!1,this.submitted=!1,this.showPassword=!1,this.scavenger=new r.Scavenger(this)}get f(){return this.resetForm.controls}ngOnDestroy(){}ngOnInit(){this.resetForm=this.formBuilder.group({old:["",[k.x.required]],new:["",[k.x.required,k.x.minLength(8)]],confirm:["",k.x.required]},{validator:Object(Ce.a)("new","confirm")})}onSubmit(){this.submitted=!0,this.resetForm.invalid||this.userService.updatePassword(this.f.old.value,this.f.new.value).pipe(this.scavenger.collect(),Object(p.a)(2)).subscribe(e=>{"EXPECTATION_FAILED"===e.body?g.a.fire("Erreur","L'ancien mot de passe que vous avez entr\xe9 est incorrect. Veuillez le corriger!","error"):"NOT_MODIFIED"===e.body?g.a.fire("Erreur","L'ancien mot de passe et le nouveau ne peuvent pas \xeatre identiques","info"):g.a.fire({title:"R\xe9ussi",html:"Votre mot de passe a \xe9t\xe9 modifi\xe9 avec succ\xe8s. Vous serez d\xe9connect\xe9. Veuillez vous connecter en utilisant votre nouveau mot de passe.",icon:"success",allowOutsideClick:!1,allowEnterKey:!1,allowEscapeKey:!1,showCloseButton:!1,showCancelButton:!1}).then(e=>{e&&this.authService.logout()})},e=>this.errorHandler.handleError(e))}onReset(){this.submitted=!1,this.resetForm.reset()}}return e.\u0275fac=function(t){return new(t||e)(b.Yb(l.g),b.Yb(l.a),b.Yb(k.d),b.Yb(te),b.Yb(ye.a),b.Yb(T.a))},e.\u0275cmp=b.Sb({type:e,selectors:[["app-edit-password"]],decls:29,vars:11,consts:[[1,"ui","very","raised","segments"],[1,"ui","inverted","dimmer",3,"ngClass"],[1,"ui","text","loader"],["mat-dialog-title","",1,"ui","segment"],[1,"ui","header"],[1,"ui","segment","fluid","pt-1","pb-2"],[1,"ui","form",3,"formGroup","ngSubmit"],[1,"field","required",3,"ngClass"],["formControlName","old",3,"type"],[4,"ngIf"],["formControlName","new",3,"type"],["formControlName","confirm",3,"type"],[1,"w-100"],["mat-dialog-close","",1,"ui","right","aligned","teal","button"],["type","submit",1,"ui","right","aligned","violet","button"],["class","invalid-message",4,"ngIf"],[1,"invalid-message"]],template:function(e,t){1&e&&(b.ec(0,"div",0),b.ec(1,"div",1),b.ec(2,"div",2),b.cd(3,"Chargement"),b.dc(),b.dc(),b.ec(4,"div",3),b.ec(5,"p",4),b.cd(6,"Modification du mot de passe"),b.dc(),b.dc(),b.ec(7,"div",5),b.ec(8,"form",6),b.qc("ngSubmit",(function(){return t.onSubmit()})),b.ec(9,"div",7),b.ec(10,"label"),b.cd(11,"Ancien Mot de passe"),b.dc(),b.Zb(12,"input",8),b.ad(13,Ke,2,1,"div",9),b.dc(),b.ec(14,"div",7),b.ec(15,"label"),b.cd(16,"Nouveau mot de passe"),b.dc(),b.Zb(17,"input",10),b.ad(18,we,3,2,"div",9),b.dc(),b.ec(19,"div",7),b.ec(20,"label"),b.cd(21,"Confirmer mot de passe"),b.dc(),b.Zb(22,"input",11),b.ad(23,Ee,3,2,"div",9),b.dc(),b.ec(24,"div",12),b.ec(25,"button",13),b.cd(26,"Annuler"),b.dc(),b.ec(27,"button",14),b.cd(28,"Modifier"),b.dc(),b.dc(),b.dc(),b.dc(),b.dc()),2&e&&(b.Kb(1),b.Cc("ngClass",t.loading?"active":""),b.Kb(7),b.Cc("formGroup",t.resetForm),b.Kb(1),b.Cc("ngClass",t.submitted&&"INVALID"===t.f.old.status?"error":""),b.Kb(3),b.Cc("type",t.showPassword?"text":"password"),b.Kb(1),b.Cc("ngIf",t.submitted&&t.f.old.errors),b.Kb(1),b.Cc("ngClass",t.submitted&&"INVALID"===t.f.new.status?"error":""),b.Kb(3),b.Cc("type",t.showPassword?"text":"password"),b.Kb(1),b.Cc("ngIf",t.submitted&&t.f.new.errors),b.Kb(1),b.Cc("ngClass",t.submitted&&"INVALID"===t.f.confirm.status?"error":""),b.Kb(3),b.Cc("type",t.showPassword?"text":"password"),b.Kb(1),b.Cc("ngIf",t.f.confirm.errors&&t.submitted))},directives:[i.p,l.h,k.z,k.o,k.h,k.c,k.n,k.f,i.r,l.d],styles:[""]}),e})();var Me=c("Qu3c");function qe(e,t){1&e&&(b.ec(0,"div",2),b.ec(1,"div",3),b.cd(2,"Chargement"),b.dc(),b.dc())}function Oe(e,t){if(1&e){const e=b.fc();b.ec(0,"div",40),b.ec(1,"i",41),b.qc("click",(function(){return b.Tc(e),b.tc(2).editing=!0})),b.dc(),b.dc()}}function De(e,t){1&e&&(b.ec(0,"div",43),b.cd(1,"Ce champ est requis."),b.dc())}function Pe(e,t){1&e&&(b.ec(0,"div",43),b.cd(1,"Ce champ doit contenir au moins 2 caract\xe8res."),b.dc())}function Le(e,t){if(1&e&&(b.ec(0,"div"),b.ad(1,De,2,0,"div",42),b.ad(2,Pe,2,0,"div",42),b.dc()),2&e){const e=b.tc(2);b.Kb(1),b.Cc("ngIf",e.f.firstName.errors.required),b.Kb(1),b.Cc("ngIf",e.f.firstName.errors.minlength)}}function Ve(e,t){1&e&&(b.ec(0,"div",43),b.cd(1,"Ce champ est requis."),b.dc())}function Fe(e,t){1&e&&(b.ec(0,"div",43),b.cd(1,"Ce champ doit contenir au moins 2 caract\xe8res."),b.dc())}function Re(e,t){if(1&e&&(b.ec(0,"div"),b.ad(1,Ve,2,0,"div",42),b.ad(2,Fe,2,0,"div",42),b.dc()),2&e){const e=b.tc(2);b.Kb(1),b.Cc("ngIf",e.f.lastName.errors.required),b.Kb(1),b.Cc("ngIf",e.f.lastName.errors.minlength)}}function Ae(e,t){1&e&&(b.ec(0,"div",43),b.cd(1,"Ce champ est requis."),b.dc())}function Ue(e,t){1&e&&(b.ec(0,"div",43),b.cd(1,"Ce champ doit contenir au moins 6 caract\xe8res."),b.dc())}function $e(e,t){1&e&&(b.ec(0,"div",43),b.cd(1,"Ce champ ne peut contenir plus de 20 caract\xe8res."),b.dc())}function He(e,t){if(1&e&&(b.ec(0,"div"),b.ad(1,Ae,2,0,"div",42),b.ad(2,Ue,2,0,"div",42),b.ad(3,$e,2,0,"div",42),b.dc()),2&e){const e=b.tc(2);b.Kb(1),b.Cc("ngIf",e.f.username.errors.required),b.Kb(1),b.Cc("ngIf",e.f.username.errors.minlength),b.Kb(1),b.Cc("ngIf",e.f.username.errors.maxlength)}}function je(e,t){1&e&&(b.ec(0,"div",43),b.cd(1,"Ce champ ne peut contenir plus de 200 caract\xe8res."),b.dc())}function ze(e,t){1&e&&(b.ec(0,"div",43),b.cd(1,"Le format de votre email est invalide."),b.dc())}function Ye(e,t){if(1&e&&(b.ec(0,"div"),b.ad(1,je,2,0,"div",42),b.ad(2,ze,2,0,"div",42),b.dc()),2&e){const e=b.tc(2);b.Kb(1),b.Cc("ngIf",e.f.email.errors.maxlength),b.Kb(1),b.Cc("ngIf",e.f.email.errors.email)}}function Xe(e,t){if(1&e&&b.Zb(0,"input",44),2&e){const e=b.tc(2);b.Cc("value",e.getIdType())}}function Ze(e,t){1&e&&(b.ec(0,"select",45),b.ec(1,"option",46),b.cd(2,"S\xe9l\xe9ctionner"),b.dc(),b.ec(3,"option",47),b.cd(4,"Carte Nationale d'identit\xe9"),b.dc(),b.ec(5,"option",48),b.cd(6,"Passport"),b.dc(),b.dc()),2&e&&(b.Kb(1),b.Cc("value",null))}function _e(e,t){1&e&&(b.ec(0,"div",43),b.cd(1,"Ce champ ne peut contenir que des chiffres."),b.dc())}function Be(e,t){if(1&e&&(b.ec(0,"div"),b.ad(1,_e,2,0,"div",42),b.dc()),2&e){const e=b.tc(2);b.Kb(1),b.Cc("ngIf",e.f.postalCode.errors.pattern)}}function Ge(e,t){if(1&e&&(b.Zb(0,"input",44),b.uc(1,"titlecase")),2&e){const e=b.tc(2);b.Cc("value",b.vc(1,1,e.getCountry()))}}function Je(e,t){if(1&e&&(b.ec(0,"option",51),b.cd(1),b.dc()),2&e){const e=t.$implicit;b.Cc("value",e.code),b.Kb(1),b.dd(e.name)}}function We(e,t){if(1&e&&(b.ec(0,"select",49),b.ad(1,Je,2,2,"option",50),b.dc()),2&e){const e=b.tc(2);b.Kb(1),b.Cc("ngForOf",e.countries)}}function Qe(e,t){1&e&&(b.ec(0,"div",43),b.cd(1,"Ce champ est requis."),b.dc())}function et(e,t){if(1&e&&(b.ec(0,"div"),b.ad(1,Qe,2,0,"div",42),b.dc()),2&e){const e=b.tc(2);b.Kb(1),b.Cc("ngIf",e.f.countryCode.errors.required)}}function tt(e,t){if(1&e&&b.Zb(0,"input",52),2&e){const e=b.tc(2);b.Cc("value",e.formatNumber())}}function ct(e,t){if(1&e){const e=b.fc();b.ec(0,"input",53),b.qc("keyup",(function(){return b.Tc(e),b.tc(2).formatNumber()})),b.dc()}}function it(e,t){1&e&&(b.ec(0,"div",43),b.cd(1,"Ce champ est requis."),b.dc())}function nt(e,t){1&e&&(b.ec(0,"div",43),b.cd(1,"Le format de votre num\xe9ro de t\xe9l\xe9phone est invalide. "),b.dc())}function rt(e,t){1&e&&(b.ec(0,"div",43),b.cd(1,"Ce champ ne peut contenir que des chiffres."),b.dc())}function dt(e,t){if(1&e&&(b.ec(0,"div"),b.ad(1,it,2,0,"div",42),b.ad(2,nt,2,0,"div",42),b.ad(3,rt,2,0,"div",42),b.dc()),2&e){const e=b.tc(2);b.Kb(1),b.Cc("ngIf",e.f.telephone.errors.required),b.Kb(1),b.Cc("ngIf",e.f.telephone.errors.validPhone),b.Kb(1),b.Cc("ngIf",e.f.telephone.errors.pattern)}}function st(e,t){if(1&e){const e=b.fc();b.ec(0,"button",54),b.qc("click",(function(){return b.Tc(e),b.tc(2).updatePassword()})),b.cd(1,"Modifier mot de passe"),b.dc()}}function ot(e,t){if(1&e){const e=b.fc();b.ec(0,"button",55),b.qc("click",(function(){return b.Tc(e),b.tc(2).resetForm()})),b.cd(1,"Annuler"),b.dc()}}function at(e,t){1&e&&(b.ec(0,"button",56),b.cd(1,"Enregistrer"),b.dc())}function lt(e,t){if(1&e){const e=b.fc();b.ec(0,"div",4),b.ec(1,"div",5),b.ec(2,"div",6),b.ad(3,Oe,2,0,"div",7),b.ec(4,"h1",8),b.cd(5,"Mon compte"),b.dc(),b.dc(),b.ec(6,"div",6),b.ec(7,"h3",9),b.cd(8,"Information"),b.dc(),b.ec(9,"form",10),b.qc("ngSubmit",(function(){return b.Tc(e),b.tc().onSubmit()})),b.ec(10,"div",11),b.ec(11,"div",12),b.ec(12,"label"),b.cd(13,"Pr\xe9nom"),b.dc(),b.Zb(14,"input",13),b.ad(15,Le,3,2,"div",14),b.dc(),b.ec(16,"div",12),b.ec(17,"label"),b.cd(18,"Nom"),b.dc(),b.Zb(19,"input",15),b.ad(20,Re,3,2,"div",14),b.dc(),b.dc(),b.ec(21,"div",11),b.ec(22,"div",12),b.ec(23,"label"),b.cd(24,"Nom d'utilisateur"),b.dc(),b.ec(25,"input",16),b.qc("keyup",(function(){b.Tc(e);const t=b.tc();return t.f.username.setValue(t.f.username.value.toLowerCase())})),b.dc(),b.ad(26,He,4,3,"div",14),b.dc(),b.ec(27,"div",17),b.ec(28,"label"),b.cd(29,"Email"),b.dc(),b.Zb(30,"input",18),b.ad(31,Ye,3,2,"div",14),b.dc(),b.dc(),b.ec(32,"div",11),b.ec(33,"div",19),b.ec(34,"label"),b.cd(35,"Type d'identification"),b.dc(),b.ad(36,Xe,1,1,"input",20),b.ad(37,Ze,7,1,"select",21),b.dc(),b.ec(38,"div",19),b.ec(39,"label"),b.cd(40,"Num\xe9ro d'identification"),b.dc(),b.Zb(41,"input",22),b.dc(),b.dc(),b.ec(42,"div",23),b.ec(43,"label"),b.cd(44,"Adresse"),b.dc(),b.Zb(45,"input",24),b.dc(),b.ec(46,"div",25),b.ec(47,"div",26),b.ec(48,"label"),b.cd(49,"Ville"),b.dc(),b.Zb(50,"input",27),b.dc(),b.ec(51,"div",26),b.ec(52,"label"),b.cd(53,"D\xe9partement"),b.dc(),b.Zb(54,"input",28),b.dc(),b.ec(55,"div",29),b.ec(56,"label"),b.cd(57,"Code postal"),b.dc(),b.Zb(58,"input",30),b.ad(59,Be,2,1,"div",14),b.dc(),b.dc(),b.ec(60,"div",31),b.ec(61,"div",12),b.ec(62,"label"),b.cd(63,"Pays"),b.dc(),b.ad(64,Ge,2,3,"input",20),b.ad(65,We,2,1,"select",32),b.ad(66,et,2,1,"div",14),b.dc(),b.ec(67,"div",12),b.ec(68,"label"),b.cd(69,"T\xe9l\xe9phone"),b.dc(),b.ec(70,"div",33),b.ec(71,"div",34),b.Zb(72,"i"),b.uc(73,"lowercase"),b.cd(74),b.dc(),b.ad(75,tt,1,1,"input",35),b.ad(76,ct,1,0,"input",36),b.dc(),b.ad(77,dt,4,3,"div",14),b.dc(),b.dc(),b.ec(78,"div"),b.ad(79,st,2,0,"button",37),b.ad(80,ot,2,0,"button",38),b.ad(81,at,2,0,"button",39),b.dc(),b.dc(),b.dc(),b.dc(),b.dc()}if(2&e){const e=b.tc();b.Kb(3),b.Cc("ngIf",!e.editing),b.Kb(6),b.Cc("formGroup",e.userForm),b.Kb(2),b.Mb(e.editing?"required field":"field"),b.Cc("ngClass",e.submitted&&"INVALID"===e.f.firstName.status?"error":""),b.Kb(3),b.Cc("readonly",!e.editing),b.Kb(1),b.Cc("ngIf",e.submitted&&e.f.firstName.errors),b.Kb(1),b.Mb(e.editing?"required field":"field"),b.Cc("ngClass",e.submitted&&"INVALID"===e.f.lastName.status?"error":""),b.Kb(3),b.Cc("readonly",!e.editing),b.Kb(1),b.Cc("ngIf",e.submitted&&e.f.lastName.errors),b.Kb(2),b.Mb(e.editing?"required field":"field"),b.Cc("ngClass",e.submitted&&"INVALID"===e.f.username.status?"error":""),b.Kb(3),b.Cc("readonly",!e.editing),b.Kb(1),b.Cc("ngIf",e.submitted&&e.f.username.errors),b.Kb(1),b.Cc("ngClass",e.submitted&&"INVALID"===e.f.email.status?"error":""),b.Kb(3),b.Cc("readonly",!e.editing),b.Kb(1),b.Cc("ngIf",e.submitted&&e.f.email.errors),b.Kb(5),b.Cc("ngIf",!e.editing),b.Kb(1),b.Cc("ngIf",e.editing),b.Kb(4),b.Cc("readonly",!e.editing),b.Kb(4),b.Cc("readonly",!e.editing),b.Kb(5),b.Cc("readonly",!e.editing),b.Kb(4),b.Cc("readonly",!e.editing),b.Kb(1),b.Cc("ngClass",e.submitted&&e.f.postalCode.errors?"error":""),b.Kb(3),b.Cc("readonly",!e.editing),b.Kb(1),b.Cc("ngIf",e.submitted&&e.f.postalCode.errors),b.Kb(2),b.Mb(e.editing?"required field":"field"),b.Cc("ngClass",e.submitted&&e.f.countryCode.errors?"error":""),b.Kb(3),b.Cc("ngIf",!e.editing),b.Kb(1),b.Cc("ngIf",e.editing),b.Kb(1),b.Cc("ngIf",e.submitted&&e.f.countryCode.errors),b.Kb(1),b.Mb(e.editing?"required field":"field"),b.Cc("ngClass",e.submitted&&e.f.telephone.errors?"error":""),b.Kb(5),b.Nb("",b.vc(73,53,e.f.countryCode.value)," flag"),b.Kb(2),b.ed("",e.getDialCode()," "),b.Kb(1),b.Cc("ngIf",!e.editing),b.Kb(1),b.Cc("ngIf",e.editing),b.Kb(1),b.Cc("ngIf",e.submitted&&e.f.telephone.errors),b.Kb(2),b.Cc("ngIf",!e.editing),b.Kb(1),b.Cc("ngIf",e.editing),b.Kb(1),b.Cc("ngIf",e.editing)}}const ut=[{path:"mytickets",component:be},{path:"myaccount",component:(()=>{class e{constructor(e,t,c,i,n,d){this.userService=e,this.dialog=t,this.fb=c,this.router=i,this.authService=n,this.errorHandler=d,this.editing=!1,this.loading=!0,this.countries=(new u.a).countries,this.submitted=!1,this.scavenger=new r.Scavenger(this)}get f(){return this.userForm.controls}ngOnDestroy(){}ngOnInit(){this.getUser()}updatePassword(){this.dialog.open(xe,{width:"360px",height:"max-content",id:"user-details-ticket-dialog",hasBackdrop:!0,disableClose:!0,closeOnNavigation:!0,data:{username:this.user.credential.username}}).afterClosed().subscribe(e=>{e&&this.router.navigate(["/"])})}getIdType(){return void 0===this.user.idType||null===this.f.idType.value?"":"cni"===this.f.idType.value.toLowerCase()?"Carte National d'Identit\xe9":"passport"===this.f.idType.value.toLowerCase()?"Passeport":""}formatNumber(){return Object(f.b)(this.f.telephone.value,this.f.countryCode.value.toUpperCase())}getCountry(){return this.countries.find(e=>e.code===this.user.countryCode).name}resetForm(){this.loading=!0,this.submitted=!1,this.userForm.reset(),this.createForm(),this.editing=!1,this.loading=!1}getDialCode(){return this.countries.find(e=>e.code===this.f.countryCode.value).dial_code}onSubmit(){if(this.submitted=!0,this.userForm.invalid)return;this.loading=!0;let e=new ve.b;e=Object.assign(e,this.userForm.value),this.userService.updateUser(e).pipe(this.scavenger.collect(),Object(p.a)(2)).subscribe(e=>{e.ok&&(this.user.credential.username===this.f.username.value?g.a.fire("Done","La modification du profile a reussi","success").then(e=>{e&&location.reload()}):g.a.fire("Done","La modification du profil a r\xe9ussi. En raison de la modification de votre nom d'utilisateur, vous serez d\xe9connect\xe9. Veuillez vous reconnecter avec votre nouveau nom d'utilisateur.","success").then(e=>{e&&this.authService.logout()}))},e=>{this.errorHandler.handleError(e),this.loading=!1})}createForm(){this.userForm=this.fb.group({firstName:[this.user.firstName,[k.x.required,k.x.minLength(2)]],lastName:[this.user.lastName,[k.x.required,k.x.minLength(2)]],email:[this.user.email,Object(Ce.b)([k.x.maxLength(200),k.x.email])],username:[this.user.credential.username,[k.x.required,k.x.minLength(6),k.x.maxLength(20)]],idType:[this.user.idType],idNumber:[this.user.idNumber],line:[this.user.line],city:[this.user.city],state:[this.user.state],postalCode:[this.user.postalCode,Object(Ce.b)([k.x.pattern(/^[0-9]+$/)])],countryCode:[this.user.countryCode,[k.x.required]],telephone:[this.user.telephone,[k.x.required,k.x.pattern(/^[0-9]+$/)]]},{validator:Object(Ce.c)("countryCode","telephone")})}getUser(){this.userService.getUser().pipe(Object(p.a)(2),this.scavenger.collect()).subscribe(e=>{this.user=e,this.createForm()},e=>g.a.fire("Error","Une erreure s'est produite lors de la recup\xe9ration de votre profile. Veuillez r\xe9\xe9ssayer SVP","error").then(e=>{e&&location.reload()}),()=>this.loading=!1)}}return e.\u0275fac=function(t){return new(t||e)(b.Yb(te),b.Yb(l.b),b.Yb(k.d),b.Yb(n.c),b.Yb(ye.a),b.Yb(T.a))},e.\u0275cmp=b.Sb({type:e,selectors:[["app-my-account"]],decls:2,vars:2,consts:[["class","ui active dimmer h-100 w-100",4,"ngIf"],["class","ui main container mb-4 mt-4",4,"ngIf"],[1,"ui","active","dimmer","h-100","w-100"],[1,"ui","active","huge","text","inverted","loader"],[1,"ui","main","container","mb-4","mt-4"],[1,"ui","card","fluid"],[1,"content"],["class","right floated meta",4,"ngIf"],[1,"header"],[1,"ui","dividing","sub","header"],["autocomplete","on",1,"ui","form",3,"formGroup","ngSubmit"],[1,"two","equal","width","fields"],[3,"ngClass"],["autocapitalize","words","formControlName","firstName","type","text",3,"readonly"],[4,"ngIf"],["autocapitalize","words","formControlName","lastName","type","text",3,"readonly"],["autocomplete","off","formControlName","username","type","text",3,"readonly","keyup"],[1,"field",3,"ngClass"],["formControlName","email","placeholder","Not set","type","email",3,"readonly"],[1,"field"],["placeholder","Not set","readonly","","type","text",3,"value",4,"ngIf"],["class","ui dropdown selectable","formControlName","idType","name","idType",4,"ngIf"],["formControlName","idNumber","placeholder","Not set","type","text",3,"readonly"],[1,"field","fluid"],["autocapitalize","words","formControlName","line","placeholder","Not set","type","text",3,"readonly"],[1,"three","fields"],[1,"six","wide","field"],["autocapitalize","words","formControlName","city","placeholder","Not set","type","text",3,"readonly"],["autocapitalize","words","formControlName","state","placeholder","Not set","type","text",3,"readonly"],[1,"four","wide","field",3,"ngClass"],["formControlName","postalCode","placeholder","Not set","type","text",3,"readonly"],[1,"ui","two","equal","width","fields"],["class","ui dropdown selection share-tel mr-2  mb-0 h6","formControlName","countryCode",4,"ngIf"],[1,"ui","left","labeled","input"],[1,"ui","olive","label"],["readonly","","type","tel",3,"value",4,"ngIf"],["formControlName","telephone","type","tel",3,"keyup",4,"ngIf"],["class","ui right floated violet button",3,"click",4,"ngIf"],["class","ui right floated red button",3,"click",4,"ngIf"],["class","ui right floated blue button","type","submit",4,"ngIf"],[1,"right","floated","meta"],["matTooltip","Modifier",1,"violet","large","edit","outline","icon","cursor-pointer",3,"click"],["class","invalid-message",4,"ngIf"],[1,"invalid-message"],["placeholder","Not set","readonly","","type","text",3,"value"],["formControlName","idType","name","idType",1,"ui","dropdown","selectable"],["selected","",3,"value"],["value","CNI"],["value","password"],["formControlName","countryCode",1,"ui","dropdown","selection","share-tel","mr-2","mb-0","h6"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["readonly","","type","tel",3,"value"],["formControlName","telephone","type","tel",3,"keyup"],[1,"ui","right","floated","violet","button",3,"click"],[1,"ui","right","floated","red","button",3,"click"],["type","submit",1,"ui","right","floated","blue","button"]],template:function(e,t){1&e&&(b.ad(0,qe,3,0,"div",0),b.ad(1,lt,82,55,"div",1)),2&e&&(b.Cc("ngIf",t.loading),b.Kb(1),b.Cc("ngIf",!t.loading))},directives:[i.r,k.z,k.o,k.h,i.p,k.c,k.n,k.f,Me.a,k.w,k.r,k.y,i.q],pipes:[i.o,i.A],styles:[""]}),e})()}];let ft=(()=>{class e{}return e.\u0275mod=b.Wb({type:e}),e.\u0275inj=b.Vb({factory:function(t){return new(t||e)},imports:[[n.g.forChild(ut)],n.g]}),e})(),ht=(()=>{class e{}return e.\u0275mod=b.Wb({type:e}),e.\u0275inj=b.Vb({factory:function(t){return new(t||e)},providers:[],imports:[[i.c,ft,l.f,k.i,Me.b,k.u]]}),e})()}}]);