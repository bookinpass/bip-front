function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var i=0;i<t.length;i++){var c=t[i];c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(e,c.key,c)}}function _createClass(e,t,i){return t&&_defineProperties(e.prototype,t),i&&_defineProperties(e,i),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{lKKO:function(e,t,i){"use strict";i.r(t),i.d(t,"AccountModule",(function(){return kt}));var c,n=i("ofXK"),r=i("tyNb"),d=i("+0XT"),o=i("moCM"),a=i("4+6U"),s=i("EhJz"),u=i("wd/R"),l=i("0IaG"),f=i("MsxN"),h=i("PoRY"),b=i("PSD3"),g=i.n(b),v=i("un/a"),p=i("MlvY"),m=i("fXoL"),C=i("gcxx"),y=i("QnqH"),k=i("jzuh"),I=i("tk/3"),K=((c=function(){function e(t,i){_classCallCheck(this,e),this.cookieService=t,this.http=i,this.url=new y.a}return _createClass(e,[{key:"doSharing",value:function(e,t,i){return this.http.post("".concat(this.url.mainHost,"/tickets/").concat(t,"/sharing"),e,{params:{username:this.getUsername(),dial:i},observe:"response"})}},{key:"getSharing",value:function(e,t){return this.http.get("".concat(this.url.mainHost,"/tickets/").concat(t,"/sharing/").concat(e),{params:{username:this.getUsername()}})}},{key:"revokeTicket",value:function(e,t){return this.http.get("".concat(this.url.mainHost,"/tickets/").concat(t,"/sharing/").concat(e,"/revoke"),{params:{username:this.getUsername()},observe:"response"})}},{key:"attributeTicket",value:function(e,t){return this.http.post("".concat(this.url.mainHost,"/tickets/").concat(e,"/sharing/").concat(t,"/attribute"),null,{params:{username:this.getUsername()},observe:"response"})}},{key:"getUsername",value:function(){return this.cookieService.getCookie("last_email")}}]),e}()).\u0275fac=function(e){return new(e||c)(m.mc(k.a),m.mc(I.b))},c.\u0275prov=m.Ub({token:c,factory:c.\u0275fac,providedIn:"root"}),c),T=i("AXpb"),w=i("3Pt+");function N(e,t){if(1&e&&(m.ec(0,"tr"),m.ec(1,"td",14),m.dd(2,"Pr\xe9nom:"),m.dc(),m.ec(3,"td"),m.dd(4),m.uc(5,"titlecase"),m.dc(),m.dc()),2&e){var i=m.tc(2);m.Kb(4),m.ed(m.vc(5,1,i.sharedTo.firstName))}}function S(e,t){if(1&e&&(m.ec(0,"tr"),m.ec(1,"td",14),m.dd(2,"Nom:"),m.dc(),m.ec(3,"td"),m.dd(4),m.uc(5,"titlecase"),m.dc(),m.dc()),2&e){var i=m.tc(2);m.Kb(4),m.ed(m.vc(5,1,i.sharedTo.lastName))}}function E(e,t){if(1&e&&(m.ec(0,"tr"),m.ec(1,"td",14),m.dd(2,"T\xe9l\xe9phone:"),m.dc(),m.ec(3,"td"),m.dd(4),m.dc(),m.dc()),2&e){var i=m.tc(2);m.Kb(4),m.ed(i.sharedTo.telephone)}}function x(e,t){if(1&e&&(m.ec(0,"tr"),m.ec(1,"td",14),m.dd(2,"Classe:"),m.dc(),m.ec(3,"td"),m.dd(4),m.dc(),m.dc()),2&e){var i=m.tc(2);m.Kb(4),m.ed(i.item.type)}}function M(e,t){if(1&e&&(m.ec(0,"tr"),m.ec(1,"td",14),m.dd(2,"Type d'\xe9v\xe9nement:"),m.dc(),m.ec(3,"td"),m.dd(4),m.uc(5,"titlecase"),m.dc(),m.dc()),2&e){var i=m.tc(2);m.Kb(4),m.ed(m.vc(5,1,i.event.eventType))}}function q(e,t){if(1&e&&(m.ec(0,"tr"),m.ec(1,"td",14),m.dd(2,"D\xe9signation:"),m.dc(),m.ec(3,"td"),m.dd(4),m.dc(),m.dc()),2&e){var i=m.tc(2);m.Kb(4),m.ed(i.event.designation)}}function O(e,t){if(1&e&&(m.ec(0,"tr"),m.ec(1,"td",14),m.dd(2,"D\xe9but:"),m.dc(),m.ec(3,"td"),m.dd(4),m.uc(5,"date"),m.dc(),m.dc()),2&e){var i=m.tc(2);m.Kb(4),m.gd("",m.xc(5,2,i.item.startingDate,"dd MMMM yyyy","UTC")," \xe1 ",i.event.startingTime,"")}}function P(e,t){if(1&e&&(m.ec(0,"tr"),m.ec(1,"td",14),m.dd(2,"Fin:"),m.dc(),m.ec(3,"td"),m.dd(4),m.uc(5,"date"),m.dc(),m.dc()),2&e){var i=m.tc(2);m.Kb(4),m.gd("",m.xc(5,2,i.item.endingDate,"dd MMMM yyyy","UTC")," \xe1 ",i.event.endingTime,"")}}function D(e,t){if(1&e&&(m.ec(0,"tr"),m.ec(1,"td",14),m.dd(2,"Type transport:"),m.dc(),m.ec(3,"td"),m.dd(4),m.uc(5,"titlecase"),m.dc(),m.dc()),2&e){var i=m.tc(2);m.Kb(4),m.gd("",i.item.transportType+": ","",m.vc(5,2,i.item.transportName),"")}}function L(e,t){if(1&e&&(m.ec(0,"tr"),m.ec(1,"td",14),m.dd(2,"Date:"),m.dc(),m.ec(3,"td"),m.dd(4),m.uc(5,"titlecase"),m.uc(6,"date"),m.dc(),m.dc()),2&e){var i=m.tc(2);m.Kb(4),m.gd("",m.vc(5,2,m.xc(6,4,i.item.departDate,"dd MMMM yyyy","UTC"))," \xe1 ",i.item.departTime,"")}}function V(e,t){if(1&e&&(m.ec(0,"tr"),m.ec(1,"td",14),m.dd(2,"D\xe9part:"),m.dc(),m.ec(3,"td"),m.dd(4),m.uc(5,"titlecase"),m.dc(),m.dc()),2&e){var i=m.tc(2);m.Kb(4),m.ed(m.vc(5,1,i.item.departLocation))}}function F(e,t){if(1&e&&(m.ec(0,"tr"),m.ec(1,"td",14),m.dd(2,"Destination:"),m.dc(),m.ec(3,"td"),m.dd(4),m.uc(5,"titlecase"),m.dc(),m.dc()),2&e){var i=m.tc(2);m.Kb(4),m.ed(m.vc(5,1,i.item.arrivalLocation))}}function R(e,t){if(1&e&&(m.ec(0,"tr"),m.ec(1,"td",14),m.dd(2,"Lieu:"),m.dc(),m.ec(3,"td"),m.dd(4),m.uc(5,"titlecase"),m.dc(),m.dc()),2&e){var i=m.tc(2);m.Kb(4),m.ed(m.vc(5,1,i.event.place.designation))}}function A(e,t){if(1&e&&(m.ec(0,"div",12),m.ec(1,"table",13),m.ec(2,"tbody"),m.ec(3,"tr"),m.ec(4,"td",14),m.dd(5,"Code billet:"),m.dc(),m.ec(6,"td"),m.dd(7),m.dc(),m.dc(),m.bd(8,N,6,3,"tr",15),m.bd(9,S,6,3,"tr",15),m.bd(10,E,5,1,"tr",15),m.bd(11,x,5,1,"tr",15),m.bd(12,M,6,3,"tr",15),m.bd(13,q,5,1,"tr",15),m.bd(14,O,6,6,"tr",15),m.bd(15,P,6,6,"tr",15),m.bd(16,D,6,4,"tr",15),m.bd(17,L,7,8,"tr",15),m.bd(18,V,6,3,"tr",15),m.bd(19,F,6,3,"tr",15),m.bd(20,R,6,3,"tr",15),m.ec(21,"tr"),m.ec(22,"td",14),m.dd(23,"ID transaction:"),m.dc(),m.ec(24,"td"),m.dd(25),m.dc(),m.dc(),m.ec(26,"tr"),m.ec(27,"td",14),m.dd(28,"Pay\xe9 avec:"),m.dc(),m.ec(29,"td"),m.dd(30),m.uc(31,"titlecase"),m.dc(),m.dc(),m.ec(32,"tr"),m.ec(33,"td",14),m.dd(34,"Date transaction:"),m.dc(),m.ec(35,"td"),m.dd(36),m.uc(37,"titlecase"),m.uc(38,"date"),m.uc(39,"date"),m.dc(),m.dc(),m.ec(40,"tr"),m.ec(41,"td",14),m.dd(42,"Prix:"),m.dc(),m.ec(43,"td"),m.dd(44),m.uc(45,"currency"),m.dc(),m.dc(),m.dc(),m.dc(),m.dc()),2&e){var i=m.tc();m.Kb(7),m.ed(i.item.isShared?"PARTAGER":i.item.codeTicket),m.Kb(1),m.Cc("ngIf",i.item.isShared),m.Kb(1),m.Cc("ngIf",i.item.isShared),m.Kb(1),m.Cc("ngIf",i.item.isShared),m.Kb(1),m.Cc("ngIf","event"===i.type&&void 0!==i.event),m.Kb(1),m.Cc("ngIf","event"===i.type&&void 0!==i.event),m.Kb(1),m.Cc("ngIf","event"===i.type&&void 0!==i.event),m.Kb(1),m.Cc("ngIf","event"==i.type&&void 0!==i.event),m.Kb(1),m.Cc("ngIf","event"===i.type&&void 0!==i.event),m.Kb(1),m.Cc("ngIf","transport"===i.type),m.Kb(1),m.Cc("ngIf","transport"===i.type),m.Kb(1),m.Cc("ngIf","transport"===i.type),m.Kb(1),m.Cc("ngIf","transport"===i.type),m.Kb(1),m.Cc("ngIf","event"===i.type&&void 0!==i.event),m.Kb(5),m.ed(i.item.transactionNumber),m.Kb(5),m.ed(null==i.item.transactionType?"Ind\xe9fini":m.vc(31,19,i.item.transactionType)),m.Kb(6),m.gd("",m.vc(37,21,m.xc(38,23,i.item.updatedAt,"dd MMMM yyyy","UTC"))," ",m.xc(39,27,i.item.updatedAt,"\xe1 HH:MM","UTC"),""),m.Kb(8),m.ed(m.yc(45,31,i.item.totalPrice,"XOF","symbol","1.1-2"))}}function _(e,t){1&e&&(m.ec(0,"div"),m.ec(1,"p",24),m.dd(2,"Ce champ est requis"),m.dc(),m.dc())}function U(e,t){1&e&&(m.ec(0,"div"),m.ec(1,"p",24),m.dd(2,"Ce champ est requis"),m.dc(),m.dc())}function j(e,t){if(1&e&&(m.ec(0,"option",25),m.dd(1),m.dc()),2&e){var i=t.$implicit;m.Cc("value",i.code),m.Kb(1),m.ed(i.dial_code)}}function H(e,t){1&e&&(m.ec(0,"p",24),m.dd(1,"Ce champ est requis"),m.dc())}function z(e,t){1&e&&(m.ec(0,"p",24),m.dd(1,"Le format de votre t\xe9l\xe9phone n'est pas valide."),m.dc())}function Y(e,t){if(1&e&&(m.ec(0,"div"),m.bd(1,H,2,0,"p",26),m.bd(2,z,2,0,"p",26),m.dc()),2&e){var i=m.tc(2);m.Kb(1),m.Cc("ngIf",i.fieldValidity.get("telephone").includes("required")),m.Kb(1),m.Cc("ngIf",i.fieldValidity.get("telephone").includes("badFormat"))}}function X(e,t){if(1&e){var i=m.fc();m.ec(0,"div",16),m.ec(1,"div",17),m.ec(2,"label"),m.dd(3,"Pr\xe9nom"),m.dc(),m.ec(4,"input",18),m.qc("focusin",(function(){return m.Tc(i),m.tc().fieldValidity.delete("firstName")}))("focusout",(function(){return m.Tc(i),m.tc().checkFields("firstName")}))("ngModelChange",(function(e){return m.Tc(i),m.tc().sharedTo.firstName=e})),m.dc(),m.bd(5,_,3,0,"div",15),m.dc(),m.ec(6,"div",17),m.ec(7,"label"),m.dd(8,"Nom"),m.dc(),m.ec(9,"input",19),m.qc("focusin",(function(){return m.Tc(i),m.tc().fieldValidity.delete("lastName")}))("focusout",(function(){return m.Tc(i),m.tc().checkFields("lastName")}))("ngModelChange",(function(e){return m.Tc(i),m.tc().sharedTo.lastName=e})),m.dc(),m.bd(10,U,3,0,"div",15),m.dc(),m.ec(11,"div",17),m.ec(12,"label"),m.dd(13,"T\xe9l\xe9phone"),m.dc(),m.ec(14,"div",20),m.ec(15,"select",21),m.qc("ngModelChange",(function(e){return m.Tc(i),m.tc().sharedTo.countryCode=e})),m.bd(16,j,2,2,"option",22),m.dc(),m.ec(17,"input",23),m.qc("focusout",(function(){return m.Tc(i),m.tc().checkFields("telephone")}))("keyup",(function(){return m.Tc(i),m.tc().formatNumber()}))("ngModelChange",(function(e){return m.Tc(i),m.tc().sharedTo.telephone=e})),m.dc(),m.dc(),m.bd(18,Y,3,2,"div",15),m.dc(),m.dc()}if(2&e){var c=m.tc();m.Kb(1),m.Cc("ngClass",c.fieldValidity.has("firstName")?"error":""),m.Kb(3),m.Cc("ngModel",c.sharedTo.firstName),m.Kb(1),m.Cc("ngIf",c.fieldValidity.has("firstName")),m.Kb(1),m.Cc("ngClass",c.fieldValidity.has("lastName")?"error":""),m.Kb(3),m.Cc("ngModel",c.sharedTo.lastName),m.Kb(1),m.Cc("ngIf",c.fieldValidity.has("lastName")),m.Kb(1),m.Cc("ngClass",c.fieldValidity.has("telephone")?"error":""),m.Kb(4),m.Cc("ngModel",c.sharedTo.countryCode),m.Kb(1),m.Cc("ngForOf",c.countries),m.Kb(1),m.Cc("ngModel",c.sharedTo.telephone),m.Kb(1),m.Cc("ngIf",c.fieldValidity.has("telephone"))}}function Z(e,t){1&e&&(m.ec(0,"button",27),m.dd(1,"Fermer"),m.dc())}function B(e,t){if(1&e){var i=m.fc();m.ec(0,"button",28),m.qc("click",(function(){return m.Tc(i),m.tc().sharing=!0})),m.dd(1,"Partager"),m.dc()}}function G(e,t){if(1&e){var i=m.fc();m.ec(0,"button",28),m.qc("click",(function(){return m.Tc(i),m.tc().revokeSharing()})),m.dd(1," Supprimer le partage "),m.dc()}}function $(e,t){if(1&e){var i=m.fc();m.ec(0,"button",29),m.qc("click",(function(){return m.Tc(i),m.tc().attributeTicket()})),m.dd(1," Attribuer le ticket "),m.dc()}}function J(e,t){if(1&e){var i=m.fc();m.ec(0,"button",30),m.qc("click",(function(){return m.Tc(i),m.tc().cancelSharing()})),m.dd(1,"Annuler"),m.dc()}}function W(e,t){if(1&e){var i=m.fc();m.ec(0,"button",28),m.qc("click",(function(){return m.Tc(i),m.tc().doSharing()})),m.dd(1,"Valider"),m.dc()}}var Q,ee,te=function e(){_classCallCheck(this,e),this.ticketId="",this.firstName="",this.lastName="",this.telephone="",this.countryCode="SN"},ie=((Q=function(){function e(t,i,c,n,r){_classCallCheck(this,e),this.dialogRef=t,this.data=i,this.eventService=c,this.sharingService=n,this.errorHandler=r,this.loading=!0,this.sharing=!1,this.sharedTo=new te,this.countries=(new f.a).countries,this.fieldValidity=new Map,this.scavenger=new d.Scavenger(this)}return _createClass(e,[{key:"ngOnDestroy",value:function(){}},{key:"ngOnInit",value:function(){this.loading=!0,this.type=this.data.type,"transport"===this.type?this.item=this.data.item:"event"===this.type&&(this.item=this.data.item,this.getEvent(this.item.eventId)),this.item.isShared?this.getSharing():this.loading=!1}},{key:"formatNumber",value:function(){this.sharedTo.telephone=Object(h.b)(this.sharedTo.telephone,this.sharedTo.countryCode)}},{key:"checkFields",value:function(e){var t=[];0===this.sharedTo[e].length?t.push("required"):"telephone"!==e||Object(h.d)(this.sharedTo.telephone,this.sharedTo.countryCode)||t.push("badFormat"),t.length>0?this.fieldValidity.set(e,t):this.fieldValidity.delete(e)}},{key:"cancelSharing",value:function(){this.sharedTo=new te,this.fieldValidity.clear(),this.sharing=!1}},{key:"doSharing",value:function(){var e=this;if(this.loading=!0,Array.of("firstName","lastName","telephone").forEach((function(t){return e.checkFields(t)})),this.fieldValidity.size>0)g.a.fire("Erreur","Veuillez corriger le formulaire!","error");else{this.sharedTo.ticketId=this.item.codeTicket,this.sharedTo.telephone=this.sharedTo.telephone.split(" ").join("");var t=this.countries.find((function(t){return t.code===e.sharedTo.countryCode})).dial_code.replace("+","");this.sharingService.doSharing(JSON.stringify(this.sharedTo),this.type,t).pipe(this.scavenger.collect(),Object(v.a)(2)).subscribe((function(t){if(200===t.status){var i=e.type="le d\xe9but de l'\xe9v\xe9nement";e.messageDialog("Partage","<p>Le partage du ticket num\xe9ro "+e.sharedTo.ticketId+" a r\xe9ussi. Un SMS de confirmation a \xe9t\xe9 envoy\xe9 a "+e.sharedTo.firstName+" "+e.sharedTo.lastName+".Vous pouvez r\xe9voquer le partage de ce ticket depuis votre espace personnel. <br/> <strong> VEUILLEZ NOTER: </strong> Vous ne pourrez plus retirer ce billet au nouveau d\xe9tenteur s'il reste moins d'une heure avant "+i+"</p>","success")}else 404===t.status&&e.errorDialog()}),(function(t){e.errorHandler.handleError(t),e.loading=!1}))}}},{key:"revokeSharing",value:function(){var e=this;this.loading=!0,this.sharingService.revokeTicket(this.item.sharingId,this.type).pipe(this.scavenger.collect()).subscribe((function(t){t.ok?e.messageDialog("Reussi","Le partage de ce ticket a \xe9t\xe9 supprim\xe9 avec succ\xe8s. Vous \xeates \xe0 nouveau son titulaire.","success"):e.errorDialog()}),(function(t){e.errorHandler.handleError(t),e.loading=!1}))}},{key:"attributeTicket",value:function(){var e=this,t="<strong>".concat(p(this.sharedTo.firstName)," ").concat(p(this.sharedTo.lastName),"</strong>");g.a.fire({title:"Attribution de ticket",html:"<p>Vous \xeates sur le point d'attribuer le ticket \xe0 "+t+". Une fois l'attribution effectu\xe9e, vous ne pourrez plus effectuer aucune action sur ce ticket. "+t+" deviendra le nouveau propri\xe9taire du ticket. Souhaitez-vous continuer ?</p>",icon:"question",allowEscapeKey:!1,allowEnterKey:!1,allowOutsideClick:!1,showCloseButton:!1,showCancelButton:!0,cancelButtonText:"Non",confirmButtonText:"Oui",focusConfirm:!0,cancelButtonColor:"red",confirmButtonColor:"green"}).then((function(t){t.value?e.doAttribution():t.dismiss&&g.a.fire("Attribution","L'attribution du ticket a \xe9t\xe9 annul\xe9!","info")}))}},{key:"doAttribution",value:function(){var e=this;this.sharingService.attributeTicket(this.type,this.item.sharingId).pipe(Object(v.a)(2),this.scavenger.collect()).subscribe((function(t){t.ok?e.messageDialog("Attribution","Le ticket a \xe9t\xe9 attribu\xe9 avec succ\xe8s.","success"):e.messageDialog("Attribution","L'attribution du ticket a \xe9chou\xe9. Veuillez r\xe9essayer SVP.","error")}),(function(t){e.errorHandler.handleError(t),e.loading=!1}))}},{key:"getEvent",value:function(e){var t=this;this.eventService.getAnEvent(e).pipe(this.scavenger.collect(),Object(v.a)(2)).subscribe((function(e){return t.event=e}),(function(e){t.errorHandler.handleError(e),t.loading=!1}),(function(){t.item.isShared?t.getSharing():t.loading=!1}))}},{key:"getSharing",value:function(){var e=this;this.sharingService.getSharing(this.item.sharingId,this.type).pipe(this.scavenger.collect(),Object(v.a)(2)).subscribe((function(t){e.sharedTo=t,e.formatNumber()}),(function(t){e.errorHandler.handleError(t),e.loading=!1}),(function(){return e.loading=!1}))}},{key:"messageDialog",value:function(e,t,i){g.a.fire({title:e,html:t,icon:i,showCloseButton:!1,allowEnterKey:!1,allowOutsideClick:!1,allowEscapeKey:!1}).then((function(e){e.value&&location.reload()}))}},{key:"errorDialog",value:function(){var e=this;g.a.fire("Erreur","Une erreur est survenue. Veuillez r\xe9essayer SVP!","error").then((function(t){t&&(e.loading=!1)}))}}]),e}()).\u0275fac=function(e){return new(e||Q)(m.Yb(l.g),m.Yb(l.a),m.Yb(C.a),m.Yb(K),m.Yb(T.a))},Q.\u0275cmp=m.Sb({type:Q,selectors:[["app-details-ticket"]],decls:16,vars:10,consts:[[1,"ui","very","raised","segments"],[1,"ui","inverted","dimmer",3,"ngClass"],[1,"ui","text","loader"],["mat-dialog-title","",1,"ui","segment"],[1,"ui","header"],["class","ui segment fluid pt-1 pb-2",4,"ngIf"],["class","ui segment form fluid pt-1 pb-2",4,"ngIf"],[1,"ui","segment","d-flex","flex-row","justify-content-end","fluid"],["class","ui orange large button right floated mr-3","mat-dialog-close","",4,"ngIf"],["class","ui green large button right floated",3,"click",4,"ngIf"],["class","ui violet large button right floated",3,"click",4,"ngIf"],["class","ui teal large button right floated",3,"click",4,"ngIf"],[1,"ui","segment","fluid","pt-1","pb-2"],[1,"ui","very","basic","table"],[1,"right","aligned"],[4,"ngIf"],[1,"ui","segment","form","fluid","pt-1","pb-2"],[1,"required","field",3,"ngClass"],["name","fName","type","text",3,"ngModel","focusin","focusout","ngModelChange"],["name","lName","type","text",3,"ngModel","focusin","focusout","ngModelChange"],[1,"ui","left","labeled","input"],["name","code",1,"ui","dropdown","selection","share-tel","mr-2","mb-0","h6",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["name","telephone","placeholder","Telephone",3,"ngModel","focusout","keyup","ngModelChange"],[1,"error"],[3,"value"],["class","error",4,"ngIf"],["mat-dialog-close","",1,"ui","orange","large","button","right","floated","mr-3"],[1,"ui","green","large","button","right","floated",3,"click"],[1,"ui","violet","large","button","right","floated",3,"click"],[1,"ui","teal","large","button","right","floated",3,"click"]],template:function(e,t){1&e&&(m.ec(0,"div",0),m.ec(1,"div",1),m.ec(2,"div",2),m.dd(3,"Chargement"),m.dc(),m.dc(),m.ec(4,"div",3),m.ec(5,"p",4),m.dd(6),m.dc(),m.dc(),m.bd(7,A,46,36,"div",5),m.bd(8,X,19,11,"div",6),m.ec(9,"div",7),m.bd(10,Z,2,0,"button",8),m.bd(11,B,2,0,"button",9),m.bd(12,G,2,0,"button",9),m.bd(13,$,2,0,"button",10),m.bd(14,J,2,0,"button",11),m.bd(15,W,2,0,"button",9),m.dc(),m.dc()),2&e&&(m.Kb(1),m.Cc("ngClass",t.loading?"active":""),m.Kb(5),m.ed(t.sharing?"Partage de ticket":"Details Billet"),m.Kb(1),m.Cc("ngIf",!t.sharing),m.Kb(1),m.Cc("ngIf",t.sharing),m.Kb(2),m.Cc("ngIf",!t.sharing),m.Kb(1),m.Cc("ngIf",!t.sharing&&!t.item.isShared),m.Kb(1),m.Cc("ngIf",!t.sharing&&t.item.isShared),m.Kb(1),m.Cc("ngIf",!t.sharing&&t.item.isShared),m.Kb(1),m.Cc("ngIf",t.sharing),m.Kb(1),m.Cc("ngIf",t.sharing))},directives:[n.p,l.h,n.r,w.c,w.n,w.q,w.w,n.q,w.r,w.y,l.d],pipes:[n.A,n.f,n.d],styles:['.ui[class*="very basic"].table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:first-child{font-weight:600;font-size:15px;padding-right:15px!important}.ui[class*="very basic"].table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{color:#444;padding:7px 0!important}.share-tel[_ngcontent-%COMP%]{min-width:auto!important;width:100px!important;padding-right:0!important}']}),Q),ce=i("xG9w"),ne=((ee=function(){function e(t,i){_classCallCheck(this,e),this.cookiesService=t,this.http=i,this.urls=new y.a}return _createClass(e,[{key:"getUser",value:function(){return this.http.get("".concat(this.urls.mainHost,"/user/search"),{params:{username:this.getUsername()}})}},{key:"getTransportTickets",value:function(){return this.http.get("".concat(this.urls.mainHost,"/user/").concat(this.getUsername(),"/tickets/transport"))}},{key:"getEventTickets",value:function(){return this.http.get("".concat(this.urls.mainHost,"/user/").concat(this.getUsername(),"/tickets/event"))}},{key:"updatePassword",value:function(e,t){return this.http.post("".concat(this.urls.mainHost,"/password"),JSON.stringify({username:this.getUsername(),oldPassword:e,newPassword:t}),{observe:"response"})}},{key:"updateUser",value:function(e){return this.http.post("".concat(this.urls.mainHost,"/user/").concat(this.getUsername(),"/profile"),JSON.stringify(e),{observe:"response"})}},{key:"getUsername",value:function(){return this.cookiesService.getCookie("last_email")}}]),e}()).\u0275fac=function(e){return new(e||ee)(m.mc(k.a),m.mc(I.b))},ee.\u0275prov=m.Ub({token:ee,factory:ee.\u0275fac,providedIn:"root"}),ee);function re(e,t){1&e&&(m.ec(0,"div",2),m.ec(1,"div",3),m.dd(2,"Chargement"),m.dc(),m.dc())}function de(e,t){1&e&&(m.ec(0,"td",18),m.dd(1,"EXPIR\xe9e"),m.dc())}function oe(e,t){1&e&&(m.ec(0,"td",19),m.dd(1,"PARTAGER"),m.dc())}function ae(e,t){if(1&e&&(m.ec(0,"td"),m.dd(1),m.uc(2,"titlecase"),m.uc(3,"date"),m.dc()),2&e){var i=m.tc().$implicit,c=m.tc(4);m.Kb(1),m.gd(" ",m.vc(2,2,m.xc(3,4,c.pipeDate(i.departDate),"dd MMMM yyyy","UTC"))," \xe1 ",i.departTime," ")}}function se(e,t){if(1&e){var i=m.fc();m.ec(0,"tr",14),m.qc("click",(function(){m.Tc(i);var e=t.$implicit;return m.tc(4).ticketDetails(e,"transport")})),m.bd(1,de,2,0,"td",15),m.bd(2,oe,2,0,"td",16),m.bd(3,ae,4,8,"td",12),m.ec(4,"td"),m.dd(5),m.uc(6,"titlecase"),m.dc(),m.ec(7,"td"),m.dd(8),m.uc(9,"titlecase"),m.dc(),m.ec(10,"td",17),m.dd(11),m.dc(),m.ec(12,"td",17),m.dd(13),m.uc(14,"titlecase"),m.dc(),m.dc()}if(2&e){var c=t.$implicit;m.Cc("ngClass","EXPIRER"===c.codeTicket?"center aligned clear":"center aligned cursor-pointer"),m.Kb(1),m.Cc("ngIf","EXPIRER"===c.codeTicket),m.Kb(1),m.Cc("ngIf","EXPIRER"!==c.codeTicket&&c.isShared),m.Kb(1),m.Cc("ngIf","EXPIRER"!==c.codeTicket&&!c.isShared),m.Kb(2),m.ed(m.vc(6,10,c.departLocation)),m.Kb(3),m.ed(m.vc(9,12,c.arrivalLocation)),m.Kb(2),m.Cc("ngClass","EXPIRER"===c.codeTicket?"strikeout":""),m.Kb(1),m.ed(c.transportType),m.Kb(1),m.Cc("ngClass","EXPIRER"===c.codeTicket?"strikeout":""),m.Kb(1),m.ed(m.vc(14,14,c.transportName))}}function ue(e,t){if(1&e&&(m.ec(0,"tbody"),m.bd(1,se,15,16,"tr",13),m.dc()),2&e){var i=m.tc(3);m.Kb(1),m.Cc("ngForOf",i.transportTickets)}}function le(e,t){1&e&&(m.ec(0,"tr",9),m.ec(1,"td",21),m.dd(2,"Aucun billet disponible"),m.dc(),m.dc())}function fe(e,t){if(1&e&&(m.ec(0,"tbody"),m.bd(1,le,3,0,"tr",20),m.dc()),2&e){var i=m.tc(3);m.Kb(1),m.Cc("ngForOf",i.transportTickets)}}function he(e,t){if(1&e&&(m.ec(0,"table",8),m.ec(1,"thead"),m.ec(2,"tr",9),m.ec(3,"th",10),m.dd(4,"Date"),m.dc(),m.ec(5,"th",11),m.dd(6,"Itineraire"),m.dc(),m.ec(7,"th",11),m.dd(8,"Transport"),m.dc(),m.dc(),m.ec(9,"tr",9),m.ec(10,"th"),m.dd(11,"D\xe9part"),m.dc(),m.ec(12,"th"),m.dd(13,"Arriv\xe9"),m.dc(),m.ec(14,"th"),m.dd(15,"Type"),m.dc(),m.ec(16,"th"),m.dd(17,"D\xe9signation"),m.dc(),m.dc(),m.dc(),m.bd(18,ue,2,1,"tbody",12),m.bd(19,fe,2,1,"tbody",12),m.dc()),2&e){var i=m.tc(2);m.Kb(18),m.Cc("ngIf",i.transportTickets&&i.transportTickets.length>0),m.Kb(1),m.Cc("ngIf",i.transportTickets&&0===i.transportTickets.length)}}function be(e,t){1&e&&(m.ec(0,"td",19),m.dd(1,"PARTAGER"),m.dc())}function ge(e,t){if(1&e&&(m.ec(0,"td"),m.dd(1),m.uc(2,"titlecase"),m.uc(3,"date"),m.dc()),2&e){var i=m.tc().$implicit,c=m.tc(3);m.Kb(1),m.fd(" ",m.vc(2,1,m.xc(3,3,c.getLinkedEvent(i).startingDate,"dd MMMM yyyy","UTC"))," ")}}function ve(e,t){1&e&&(m.ec(0,"td",18),m.dd(1,"EXPIR\xe9e"),m.dc())}function pe(e,t){if(1&e){var i=m.fc();m.ec(0,"tr",14),m.qc("click",(function(){m.Tc(i);var e=t.$implicit;return m.tc(3).ticketDetails(e,"event")})),m.bd(1,be,2,0,"td",16),m.bd(2,ge,4,7,"td",12),m.bd(3,ve,2,0,"td",15),m.ec(4,"td"),m.dd(5),m.uc(6,"titlecase"),m.dc(),m.ec(7,"td"),m.dd(8),m.uc(9,"titlecase"),m.dc(),m.ec(10,"td"),m.dd(11),m.dc(),m.ec(12,"td"),m.dd(13),m.uc(14,"currency"),m.dc(),m.dc()}if(2&e){var c=t.$implicit,n=m.tc(3);m.Cc("ngClass","EXPIRER"===c.codeTicket?"center aligned clear":"center aligned cursor-pointer"),m.Kb(1),m.Cc("ngIf","EXPIRER"!==c.codeTicket&&c.isShared),m.Kb(1),m.Cc("ngIf","EXPIRER"!==c.codeTicket&&!c.isShared),m.Kb(1),m.Cc("ngIf","EXPIRER"===c.codeTicket),m.Kb(2),m.ed(m.vc(6,8,n.getLinkedEvent(c).designation)),m.Kb(3),m.ed(m.vc(9,10,n.getLinkedEvent(c).place.designation)),m.Kb(3),m.ed(c.type),m.Kb(2),m.ed(m.yc(14,12,c.totalPrice,"XOF","symbol","1.1-2"))}}function me(e,t){if(1&e&&(m.ec(0,"table",8),m.ec(1,"thead"),m.ec(2,"tr",9),m.ec(3,"th",22),m.dd(4,"Date"),m.dc(),m.ec(5,"th"),m.dd(6,"D\xe9signation"),m.dc(),m.ec(7,"th"),m.dd(8,"Lieu"),m.dc(),m.ec(9,"th"),m.dd(10,"Classe"),m.dc(),m.ec(11,"th"),m.dd(12,"Prix"),m.dc(),m.dc(),m.dc(),m.ec(13,"tbody"),m.bd(14,pe,15,17,"tr",13),m.dc(),m.dc()),2&e){var i=m.tc(2);m.Kb(14),m.Cc("ngForOf",i.eventTickets)}}function Ce(e,t){if(1&e&&(m.ec(0,"div",4),m.ec(1,"div",5),m.ec(2,"div",6),m.dd(3,"Mes titres de transport"),m.dc(),m.bd(4,he,20,2,"table",7),m.ec(5,"div",6),m.dd(6,"Mes tickets d'evenement"),m.dc(),m.bd(7,me,15,1,"table",7),m.dc(),m.dc()),2&e){var i=m.tc();m.Kb(4),m.Cc("ngIf",i.transportTickets),m.Kb(3),m.Cc("ngIf",i.eventTickets)}}var ye,ke=((ye=function(){function e(t,i,c,n){_classCallCheck(this,e),this.userService=t,this.eventService=i,this.errorHandler=c,this.dialog=n,this.scavenger=new d.Scavenger(this)}return _createClass(e,[{key:"ngOnInit",value:function(){this.getTransportTickets(),this.getEventTickets()}},{key:"ngOnDestroy",value:function(){}},{key:"ticketDetails",value:function(e,t){this.dialog.open(ie,{width:window.innerWidth>400?"550px":"380px",height:"max-content",id:"user-details-ticket-dialog",hasBackdrop:!0,disableClose:!0,closeOnNavigation:!0,data:{type:t,item:e}}).afterClosed().subscribe((function(e){}))}},{key:"pipeDate",value:function(e){return new Date(e)}},{key:"getLinkedEvent",value:function(e){return this.events.find((function(t){return t.eventId===e.eventId}))}},{key:"checkExpiry",value:function(e){var t=new Date(e.departDate),i=e.departTime.toString().split(":");return t.setHours(Number(i[0])),t.setMinutes(Number(i[1])),Object(o.a)(Object(a.a)(t.toISOString()),new Date(Object(u.now)()))<1}},{key:"getTransportTickets",value:function(){var e=this;this.userService.getTransportTickets().pipe(this.scavenger.collect()).subscribe((function(t){t.forEach((function(t){e.checkExpiry(t)&&(t.codeTicket="EXPIRER")})),e.transportTickets=t}),(function(t){e.errorHandler.handleError(t),location.reload()}))}},{key:"getEventTickets",value:function(){var e=this;this.userService.getEventTickets().pipe(this.scavenger.collect()).subscribe((function(t){var i=ce.e(t.map((function(e){return e.eventId})));e.getEvents(i,t)}),(function(t){e.errorHandler.handleError(t),location.reload()}))}},{key:"getEvents",value:function(e,t){var i=this;this.eventService.getListedEvents(e).pipe(this.scavenger.collect()).subscribe((function(e){i.events=e,e.forEach((function(e){Object(s.a)(Object(a.a)(e.startingDate.toString()),new Date(Object(u.now)()))||(t.find((function(t){return t.eventId===e.eventId})).codeTicket="EXPIRER")}))}),(function(e){i.errorHandler.handleError(e),location.reload()}),(function(){return i.eventTickets=t}))}}]),e}()).\u0275fac=function(e){return new(e||ye)(m.Yb(ne),m.Yb(C.a),m.Yb(T.a),m.Yb(l.b))},ye.\u0275cmp=m.Sb({type:ye,selectors:[["app-my-tickets"]],decls:2,vars:2,consts:[["class","ui active dimmer h-100 w-100",4,"ngIf"],["class","container mt-3 mb-3",4,"ngIf"],[1,"ui","active","dimmer","h-100","w-100"],[1,"ui","active","huge","text","inverted","loader"],[1,"container","mt-3","mb-3"],[1,"ui","raised","segment"],[1,"ui","header","text-center"],["class","ui mini table celled very compact striped structured selectable",4,"ngIf"],[1,"ui","mini","table","celled","very","compact","striped","structured","selectable"],[1,"center","aligned"],["rowspan","2",2,"width","200px"],["colspan","2"],[4,"ngIf"],[3,"ngClass","click",4,"ngFor","ngForOf"],[3,"ngClass","click"],["class","transport-expired text-uppercase",4,"ngIf"],["class","ticket-shared",4,"ngIf"],[3,"ngClass"],[1,"transport-expired","text-uppercase"],[1,"ticket-shared"],["class","center aligned",4,"ngFor","ngForOf"],["colspan","9"],[2,"width","150px"]],template:function(e,t){1&e&&(m.bd(0,re,3,0,"div",0),m.bd(1,Ce,8,2,"div",1)),2&e&&(m.Cc("ngIf",!t.transportTickets||!t.eventTickets),m.Kb(1),m.Cc("ngIf",t.transportTickets&&t.eventTickets))},directives:[n.r,n.q,n.p],pipes:[n.A,n.f,n.d],styles:["tr.clear[_ngcontent-%COMP%]{cursor:default;pointer-events:none}.transport-expired[_ngcontent-%COMP%]{background-color:red;color:#fff;font-weight:700}.strikeout[_ngcontent-%COMP%]{-webkit-text-decoration-line:line-through;text-decoration-line:line-through}.ticket-shared[_ngcontent-%COMP%]{background-color:green;color:#fff;font-weight:700}"]}),ye),Ie=i("LG61"),Ke=i("DrXB"),Te=i("qIOU");function we(e,t){1&e&&(m.ec(0,"div",16),m.dd(1,"Ce champ est requis."),m.dc())}function Ne(e,t){if(1&e&&(m.ec(0,"div"),m.bd(1,we,2,0,"div",15),m.dc()),2&e){var i=m.tc();m.Kb(1),m.Cc("ngIf",i.f.old.errors.required)}}function Se(e,t){1&e&&(m.ec(0,"div",16),m.dd(1,"Ce champ est requis."),m.dc())}function Ee(e,t){1&e&&(m.ec(0,"div",16),m.dd(1,"Veuillez saisir au moins huit caracteres."),m.dc())}function xe(e,t){if(1&e&&(m.ec(0,"div"),m.bd(1,Se,2,0,"div",15),m.bd(2,Ee,2,0,"div",15),m.dc()),2&e){var i=m.tc();m.Kb(1),m.Cc("ngIf",i.f.new.errors.required),m.Kb(1),m.Cc("ngIf",i.f.new.errors.minlength)}}function Me(e,t){1&e&&(m.ec(0,"div",16),m.dd(1,"Ce champ est requis."),m.dc())}function qe(e,t){1&e&&(m.ec(0,"div",16),m.dd(1,"Les mot de passe ne correspondent pas!"),m.dc())}function Oe(e,t){if(1&e&&(m.ec(0,"div"),m.bd(1,Me,2,0,"div",15),m.bd(2,qe,2,0,"div",15),m.dc()),2&e){var i=m.tc();m.Kb(1),m.Cc("ngIf",i.f.confirm.errors.required),m.Kb(1),m.Cc("ngIf",i.f.confirm.errors.mustMatch)}}var Pe,De=((Pe=function(){function e(t,i,c,n,r,o){_classCallCheck(this,e),this.dialogRef=t,this.data=i,this.formBuilder=c,this.userService=n,this.authService=r,this.errorHandler=o,this.loading=!1,this.submitted=!1,this.showPassword=!1,this.scavenger=new d.Scavenger(this)}return _createClass(e,[{key:"ngOnDestroy",value:function(){}},{key:"ngOnInit",value:function(){this.resetForm=this.formBuilder.group({old:["",[w.x.required]],new:["",[w.x.required,w.x.minLength(8)]],confirm:["",w.x.required]},{validator:Object(Ke.a)("new","confirm")})}},{key:"onSubmit",value:function(){var e=this;this.submitted=!0,this.resetForm.invalid||this.userService.updatePassword(this.f.old.value,this.f.new.value).pipe(this.scavenger.collect(),Object(v.a)(2)).subscribe((function(t){"EXPECTATION_FAILED"===t.body?g.a.fire("Erreur","L'ancien mot de passe que vous avez entr\xe9 est incorrect. Veuillez le corriger!","error"):"NOT_MODIFIED"===t.body?g.a.fire("Erreur","L'ancien mot de passe et le nouveau ne peuvent pas \xeatre identiques","info"):g.a.fire({title:"R\xe9ussi",html:"Votre mot de passe a \xe9t\xe9 modifi\xe9 avec succ\xe8s. Vous serez d\xe9connect\xe9. Veuillez vous connecter en utilisant votre nouveau mot de passe.",icon:"success",allowOutsideClick:!1,allowEnterKey:!1,allowEscapeKey:!1,showCloseButton:!1,showCancelButton:!1}).then((function(t){t&&e.authService.logout()}))}),(function(t){return e.errorHandler.handleError(t)}))}},{key:"onReset",value:function(){this.submitted=!1,this.resetForm.reset()}},{key:"f",get:function(){return this.resetForm.controls}}]),e}()).\u0275fac=function(e){return new(e||Pe)(m.Yb(l.g),m.Yb(l.a),m.Yb(w.d),m.Yb(ne),m.Yb(Te.a),m.Yb(T.a))},Pe.\u0275cmp=m.Sb({type:Pe,selectors:[["app-edit-password"]],decls:29,vars:11,consts:[[1,"ui","very","raised","segments"],[1,"ui","inverted","dimmer",3,"ngClass"],[1,"ui","text","loader"],["mat-dialog-title","",1,"ui","segment"],[1,"ui","header"],[1,"ui","segment","fluid","pt-1","pb-2"],[1,"ui","form",3,"formGroup","ngSubmit"],[1,"field","required",3,"ngClass"],["formControlName","old",3,"type"],[4,"ngIf"],["formControlName","new",3,"type"],["formControlName","confirm",3,"type"],[1,"w-100"],["mat-dialog-close","",1,"ui","right","aligned","teal","button"],["type","submit",1,"ui","right","aligned","violet","button"],["class","invalid-message",4,"ngIf"],[1,"invalid-message"]],template:function(e,t){1&e&&(m.ec(0,"div",0),m.ec(1,"div",1),m.ec(2,"div",2),m.dd(3,"Chargement"),m.dc(),m.dc(),m.ec(4,"div",3),m.ec(5,"p",4),m.dd(6,"Modification du mot de passe"),m.dc(),m.dc(),m.ec(7,"div",5),m.ec(8,"form",6),m.qc("ngSubmit",(function(){return t.onSubmit()})),m.ec(9,"div",7),m.ec(10,"label"),m.dd(11,"Ancien Mot de passe"),m.dc(),m.Zb(12,"input",8),m.bd(13,Ne,2,1,"div",9),m.dc(),m.ec(14,"div",7),m.ec(15,"label"),m.dd(16,"Nouveau mot de passe"),m.dc(),m.Zb(17,"input",10),m.bd(18,xe,3,2,"div",9),m.dc(),m.ec(19,"div",7),m.ec(20,"label"),m.dd(21,"Confirmer mot de passe"),m.dc(),m.Zb(22,"input",11),m.bd(23,Oe,3,2,"div",9),m.dc(),m.ec(24,"div",12),m.ec(25,"button",13),m.dd(26,"Annuler"),m.dc(),m.ec(27,"button",14),m.dd(28,"Modifier"),m.dc(),m.dc(),m.dc(),m.dc(),m.dc()),2&e&&(m.Kb(1),m.Cc("ngClass",t.loading?"active":""),m.Kb(7),m.Cc("formGroup",t.resetForm),m.Kb(1),m.Cc("ngClass",t.submitted&&"INVALID"===t.f.old.status?"error":""),m.Kb(3),m.Cc("type",t.showPassword?"text":"password"),m.Kb(1),m.Cc("ngIf",t.submitted&&t.f.old.errors),m.Kb(1),m.Cc("ngClass",t.submitted&&"INVALID"===t.f.new.status?"error":""),m.Kb(3),m.Cc("type",t.showPassword?"text":"password"),m.Kb(1),m.Cc("ngIf",t.submitted&&t.f.new.errors),m.Kb(1),m.Cc("ngClass",t.submitted&&"INVALID"===t.f.confirm.status?"error":""),m.Kb(3),m.Cc("type",t.showPassword?"text":"password"),m.Kb(1),m.Cc("ngIf",t.f.confirm.errors&&t.submitted))},directives:[n.p,l.h,w.z,w.o,w.h,w.c,w.n,w.f,n.r,l.d],styles:[""]}),Pe),Le=i("Qu3c");function Ve(e,t){1&e&&(m.ec(0,"div",2),m.ec(1,"div",3),m.dd(2,"Chargement"),m.dc(),m.dc())}function Fe(e,t){if(1&e){var i=m.fc();m.ec(0,"div",40),m.ec(1,"i",41),m.qc("click",(function(){return m.Tc(i),m.tc(2).editing=!0})),m.dc(),m.dc()}}function Re(e,t){1&e&&(m.ec(0,"div",43),m.dd(1,"Ce champ est requis."),m.dc())}function Ae(e,t){1&e&&(m.ec(0,"div",43),m.dd(1,"Ce champ doit contenir au moins 2 caract\xe8res."),m.dc())}function _e(e,t){if(1&e&&(m.ec(0,"div"),m.bd(1,Re,2,0,"div",42),m.bd(2,Ae,2,0,"div",42),m.dc()),2&e){var i=m.tc(2);m.Kb(1),m.Cc("ngIf",i.f.firstName.errors.required),m.Kb(1),m.Cc("ngIf",i.f.firstName.errors.minlength)}}function Ue(e,t){1&e&&(m.ec(0,"div",43),m.dd(1,"Ce champ est requis."),m.dc())}function je(e,t){1&e&&(m.ec(0,"div",43),m.dd(1,"Ce champ doit contenir au moins 2 caract\xe8res."),m.dc())}function He(e,t){if(1&e&&(m.ec(0,"div"),m.bd(1,Ue,2,0,"div",42),m.bd(2,je,2,0,"div",42),m.dc()),2&e){var i=m.tc(2);m.Kb(1),m.Cc("ngIf",i.f.lastName.errors.required),m.Kb(1),m.Cc("ngIf",i.f.lastName.errors.minlength)}}function ze(e,t){1&e&&(m.ec(0,"div",43),m.dd(1,"Ce champ est requis."),m.dc())}function Ye(e,t){1&e&&(m.ec(0,"div",43),m.dd(1,"Ce champ doit contenir au moins 6 caract\xe8res."),m.dc())}function Xe(e,t){1&e&&(m.ec(0,"div",43),m.dd(1,"Ce champ ne peut contenir plus de 20 caract\xe8res."),m.dc())}function Ze(e,t){if(1&e&&(m.ec(0,"div"),m.bd(1,ze,2,0,"div",42),m.bd(2,Ye,2,0,"div",42),m.bd(3,Xe,2,0,"div",42),m.dc()),2&e){var i=m.tc(2);m.Kb(1),m.Cc("ngIf",i.f.username.errors.required),m.Kb(1),m.Cc("ngIf",i.f.username.errors.minlength),m.Kb(1),m.Cc("ngIf",i.f.username.errors.maxlength)}}function Be(e,t){1&e&&(m.ec(0,"div",43),m.dd(1,"Ce champ ne peut contenir plus de 200 caract\xe8res."),m.dc())}function Ge(e,t){1&e&&(m.ec(0,"div",43),m.dd(1,"Le format de votre email est invalide."),m.dc())}function $e(e,t){if(1&e&&(m.ec(0,"div"),m.bd(1,Be,2,0,"div",42),m.bd(2,Ge,2,0,"div",42),m.dc()),2&e){var i=m.tc(2);m.Kb(1),m.Cc("ngIf",i.f.email.errors.maxlength),m.Kb(1),m.Cc("ngIf",i.f.email.errors.email)}}function Je(e,t){if(1&e&&m.Zb(0,"input",44),2&e){var i=m.tc(2);m.Cc("value",i.getIdType())}}function We(e,t){1&e&&(m.ec(0,"select",45),m.ec(1,"option",46),m.dd(2,"S\xe9l\xe9ctionner"),m.dc(),m.ec(3,"option",47),m.dd(4,"Carte Nationale d'identit\xe9"),m.dc(),m.ec(5,"option",48),m.dd(6,"Passport"),m.dc(),m.dc()),2&e&&(m.Kb(1),m.Cc("value",null))}function Qe(e,t){1&e&&(m.ec(0,"div",43),m.dd(1,"Ce champ ne peut contenir que des chiffres."),m.dc())}function et(e,t){if(1&e&&(m.ec(0,"div"),m.bd(1,Qe,2,0,"div",42),m.dc()),2&e){var i=m.tc(2);m.Kb(1),m.Cc("ngIf",i.f.postalCode.errors.pattern)}}function tt(e,t){if(1&e&&(m.Zb(0,"input",44),m.uc(1,"titlecase")),2&e){var i=m.tc(2);m.Cc("value",m.vc(1,1,i.getCountry()))}}function it(e,t){if(1&e&&(m.ec(0,"option",51),m.dd(1),m.dc()),2&e){var i=t.$implicit;m.Cc("value",i.code),m.Kb(1),m.ed(i.name)}}function ct(e,t){if(1&e&&(m.ec(0,"select",49),m.bd(1,it,2,2,"option",50),m.dc()),2&e){var i=m.tc(2);m.Kb(1),m.Cc("ngForOf",i.countries)}}function nt(e,t){1&e&&(m.ec(0,"div",43),m.dd(1,"Ce champ est requis."),m.dc())}function rt(e,t){if(1&e&&(m.ec(0,"div"),m.bd(1,nt,2,0,"div",42),m.dc()),2&e){var i=m.tc(2);m.Kb(1),m.Cc("ngIf",i.f.countryCode.errors.required)}}function dt(e,t){if(1&e&&m.Zb(0,"input",52),2&e){var i=m.tc(2);m.Cc("value",i.formatNumber())}}function ot(e,t){if(1&e){var i=m.fc();m.ec(0,"input",53),m.qc("keyup",(function(){return m.Tc(i),m.tc(2).formatNumber()})),m.dc()}}function at(e,t){1&e&&(m.ec(0,"div",43),m.dd(1,"Ce champ est requis."),m.dc())}function st(e,t){1&e&&(m.ec(0,"div",43),m.dd(1,"Le format de votre num\xe9ro de t\xe9l\xe9phone est invalide. "),m.dc())}function ut(e,t){1&e&&(m.ec(0,"div",43),m.dd(1,"Ce champ ne peut contenir que des chiffres."),m.dc())}function lt(e,t){if(1&e&&(m.ec(0,"div"),m.bd(1,at,2,0,"div",42),m.bd(2,st,2,0,"div",42),m.bd(3,ut,2,0,"div",42),m.dc()),2&e){var i=m.tc(2);m.Kb(1),m.Cc("ngIf",i.f.telephone.errors.required),m.Kb(1),m.Cc("ngIf",i.f.telephone.errors.validPhone),m.Kb(1),m.Cc("ngIf",i.f.telephone.errors.pattern)}}function ft(e,t){if(1&e){var i=m.fc();m.ec(0,"button",54),m.qc("click",(function(){return m.Tc(i),m.tc(2).updatePassword()})),m.dd(1,"Modifier mot de passe"),m.dc()}}function ht(e,t){if(1&e){var i=m.fc();m.ec(0,"button",55),m.qc("click",(function(){return m.Tc(i),m.tc(2).resetForm()})),m.dd(1,"Annuler"),m.dc()}}function bt(e,t){1&e&&(m.ec(0,"button",56),m.dd(1,"Enregistrer"),m.dc())}function gt(e,t){if(1&e){var i=m.fc();m.ec(0,"div",4),m.ec(1,"div",5),m.ec(2,"div",6),m.bd(3,Fe,2,0,"div",7),m.ec(4,"h1",8),m.dd(5,"Mon compte"),m.dc(),m.dc(),m.ec(6,"div",6),m.ec(7,"h3",9),m.dd(8,"Information"),m.dc(),m.ec(9,"form",10),m.qc("ngSubmit",(function(){return m.Tc(i),m.tc().onSubmit()})),m.ec(10,"div",11),m.ec(11,"div",12),m.ec(12,"label"),m.dd(13,"Pr\xe9nom"),m.dc(),m.Zb(14,"input",13),m.bd(15,_e,3,2,"div",14),m.dc(),m.ec(16,"div",12),m.ec(17,"label"),m.dd(18,"Nom"),m.dc(),m.Zb(19,"input",15),m.bd(20,He,3,2,"div",14),m.dc(),m.dc(),m.ec(21,"div",11),m.ec(22,"div",12),m.ec(23,"label"),m.dd(24,"Nom d'utilisateur"),m.dc(),m.ec(25,"input",16),m.qc("keyup",(function(){m.Tc(i);var e=m.tc();return e.f.username.setValue(e.f.username.value.toLowerCase())})),m.dc(),m.bd(26,Ze,4,3,"div",14),m.dc(),m.ec(27,"div",17),m.ec(28,"label"),m.dd(29,"Email"),m.dc(),m.Zb(30,"input",18),m.bd(31,$e,3,2,"div",14),m.dc(),m.dc(),m.ec(32,"div",11),m.ec(33,"div",19),m.ec(34,"label"),m.dd(35,"Type d'identification"),m.dc(),m.bd(36,Je,1,1,"input",20),m.bd(37,We,7,1,"select",21),m.dc(),m.ec(38,"div",19),m.ec(39,"label"),m.dd(40,"Num\xe9ro d'identification"),m.dc(),m.Zb(41,"input",22),m.dc(),m.dc(),m.ec(42,"div",23),m.ec(43,"label"),m.dd(44,"Adresse"),m.dc(),m.Zb(45,"input",24),m.dc(),m.ec(46,"div",25),m.ec(47,"div",26),m.ec(48,"label"),m.dd(49,"Ville"),m.dc(),m.Zb(50,"input",27),m.dc(),m.ec(51,"div",26),m.ec(52,"label"),m.dd(53,"D\xe9partement"),m.dc(),m.Zb(54,"input",28),m.dc(),m.ec(55,"div",29),m.ec(56,"label"),m.dd(57,"Code postal"),m.dc(),m.Zb(58,"input",30),m.bd(59,et,2,1,"div",14),m.dc(),m.dc(),m.ec(60,"div",31),m.ec(61,"div",12),m.ec(62,"label"),m.dd(63,"Pays"),m.dc(),m.bd(64,tt,2,3,"input",20),m.bd(65,ct,2,1,"select",32),m.bd(66,rt,2,1,"div",14),m.dc(),m.ec(67,"div",12),m.ec(68,"label"),m.dd(69,"T\xe9l\xe9phone"),m.dc(),m.ec(70,"div",33),m.ec(71,"div",34),m.Zb(72,"i"),m.uc(73,"lowercase"),m.dd(74),m.dc(),m.bd(75,dt,1,1,"input",35),m.bd(76,ot,1,0,"input",36),m.dc(),m.bd(77,lt,4,3,"div",14),m.dc(),m.dc(),m.ec(78,"div"),m.bd(79,ft,2,0,"button",37),m.bd(80,ht,2,0,"button",38),m.bd(81,bt,2,0,"button",39),m.dc(),m.dc(),m.dc(),m.dc(),m.dc()}if(2&e){var c=m.tc();m.Kb(3),m.Cc("ngIf",!c.editing),m.Kb(6),m.Cc("formGroup",c.userForm),m.Kb(2),m.Mb(c.editing?"required field":"field"),m.Cc("ngClass",c.submitted&&"INVALID"===c.f.firstName.status?"error":""),m.Kb(3),m.Cc("readonly",!c.editing),m.Kb(1),m.Cc("ngIf",c.submitted&&c.f.firstName.errors),m.Kb(1),m.Mb(c.editing?"required field":"field"),m.Cc("ngClass",c.submitted&&"INVALID"===c.f.lastName.status?"error":""),m.Kb(3),m.Cc("readonly",!c.editing),m.Kb(1),m.Cc("ngIf",c.submitted&&c.f.lastName.errors),m.Kb(2),m.Mb(c.editing?"required field":"field"),m.Cc("ngClass",c.submitted&&"INVALID"===c.f.username.status?"error":""),m.Kb(3),m.Cc("readonly",!c.editing),m.Kb(1),m.Cc("ngIf",c.submitted&&c.f.username.errors),m.Kb(1),m.Cc("ngClass",c.submitted&&"INVALID"===c.f.email.status?"error":""),m.Kb(3),m.Cc("readonly",!c.editing),m.Kb(1),m.Cc("ngIf",c.submitted&&c.f.email.errors),m.Kb(5),m.Cc("ngIf",!c.editing),m.Kb(1),m.Cc("ngIf",c.editing),m.Kb(4),m.Cc("readonly",!c.editing),m.Kb(4),m.Cc("readonly",!c.editing),m.Kb(5),m.Cc("readonly",!c.editing),m.Kb(4),m.Cc("readonly",!c.editing),m.Kb(1),m.Cc("ngClass",c.submitted&&c.f.postalCode.errors?"error":""),m.Kb(3),m.Cc("readonly",!c.editing),m.Kb(1),m.Cc("ngIf",c.submitted&&c.f.postalCode.errors),m.Kb(2),m.Mb(c.editing?"required field":"field"),m.Cc("ngClass",c.submitted&&c.f.countryCode.errors?"error":""),m.Kb(3),m.Cc("ngIf",!c.editing),m.Kb(1),m.Cc("ngIf",c.editing),m.Kb(1),m.Cc("ngIf",c.submitted&&c.f.countryCode.errors),m.Kb(1),m.Mb(c.editing?"required field":"field"),m.Cc("ngClass",c.submitted&&c.f.telephone.errors?"error":""),m.Kb(5),m.Nb("",m.vc(73,53,c.f.countryCode.value)," flag"),m.Kb(2),m.fd("",c.getDialCode()," "),m.Kb(1),m.Cc("ngIf",!c.editing),m.Kb(1),m.Cc("ngIf",c.editing),m.Kb(1),m.Cc("ngIf",c.submitted&&c.f.telephone.errors),m.Kb(2),m.Cc("ngIf",!c.editing),m.Kb(1),m.Cc("ngIf",c.editing),m.Kb(1),m.Cc("ngIf",c.editing)}}var vt,pt,mt,Ct=[{path:"mytickets",component:ke},{path:"myaccount",component:(vt=function(){function e(t,i,c,n,r,o){_classCallCheck(this,e),this.userService=t,this.dialog=i,this.fb=c,this.router=n,this.authService=r,this.errorHandler=o,this.editing=!1,this.loading=!0,this.countries=(new f.a).countries,this.submitted=!1,this.scavenger=new d.Scavenger(this)}return _createClass(e,[{key:"ngOnDestroy",value:function(){}},{key:"ngOnInit",value:function(){this.getUser()}},{key:"updatePassword",value:function(){var e=this;this.dialog.open(De,{width:"360px",height:"max-content",id:"user-details-ticket-dialog",hasBackdrop:!0,disableClose:!0,closeOnNavigation:!0,data:{username:this.user.credential.username}}).afterClosed().subscribe((function(t){t&&e.router.navigate(["/"])}))}},{key:"getIdType",value:function(){return void 0===this.user.idType||null===this.f.idType.value?"":"cni"===this.f.idType.value.toLowerCase()?"Carte National d'Identit\xe9":"passport"===this.f.idType.value.toLowerCase()?"Passeport":""}},{key:"formatNumber",value:function(){return Object(h.b)(this.f.telephone.value,this.f.countryCode.value.toUpperCase())}},{key:"getCountry",value:function(){var e=this;return this.countries.find((function(t){return t.code===e.user.countryCode})).name}},{key:"resetForm",value:function(){this.loading=!0,this.submitted=!1,this.userForm.reset(),this.createForm(),this.editing=!1,this.loading=!1}},{key:"getDialCode",value:function(){var e=this;return this.countries.find((function(t){return t.code===e.f.countryCode.value})).dial_code}},{key:"onSubmit",value:function(){var e=this;if(this.submitted=!0,!this.userForm.invalid){this.loading=!0;var t=new Ie.b;t=Object.assign(t,this.userForm.value),this.userService.updateUser(t).pipe(this.scavenger.collect(),Object(v.a)(2)).subscribe((function(t){t.ok&&(e.user.credential.username===e.f.username.value?g.a.fire("Done","La modification du profile a reussi","success").then((function(e){e&&location.reload()})):g.a.fire("Done","La modification du profil a r\xe9ussi. En raison de la modification de votre nom d'utilisateur, vous serez d\xe9connect\xe9. Veuillez vous reconnecter avec votre nouveau nom d'utilisateur.","success").then((function(t){t&&e.authService.logout()})))}),(function(t){e.errorHandler.handleError(t),e.loading=!1}))}}},{key:"createForm",value:function(){this.userForm=this.fb.group({firstName:[this.user.firstName,[w.x.required,w.x.minLength(2)]],lastName:[this.user.lastName,[w.x.required,w.x.minLength(2)]],email:[this.user.email,Object(Ke.b)([w.x.maxLength(200),w.x.email])],username:[this.user.credential.username,[w.x.required,w.x.minLength(6),w.x.maxLength(20)]],idType:[this.user.idType],idNumber:[this.user.idNumber],line:[this.user.line],city:[this.user.city],state:[this.user.state],postalCode:[this.user.postalCode,Object(Ke.b)([w.x.pattern(/^[0-9]+$/)])],countryCode:[this.user.countryCode,[w.x.required]],telephone:[this.user.telephone,[w.x.required,w.x.pattern(/^[0-9]+$/)]]},{validator:Object(Ke.c)("countryCode","telephone")})}},{key:"getUser",value:function(){var e=this;this.userService.getUser().pipe(Object(v.a)(2),this.scavenger.collect()).subscribe((function(t){e.user=t,e.createForm()}),(function(e){return g.a.fire("Error","Une erreure s'est produite lors de la recup\xe9ration de votre profile. Veuillez r\xe9\xe9ssayer SVP","error").then((function(e){e&&location.reload()}))}),(function(){return e.loading=!1}))}},{key:"f",get:function(){return this.userForm.controls}}]),e}(),vt.\u0275fac=function(e){return new(e||vt)(m.Yb(ne),m.Yb(l.b),m.Yb(w.d),m.Yb(r.c),m.Yb(Te.a),m.Yb(T.a))},vt.\u0275cmp=m.Sb({type:vt,selectors:[["app-my-account"]],decls:2,vars:2,consts:[["class","ui active dimmer h-100 w-100",4,"ngIf"],["class","ui main container mb-4 mt-4",4,"ngIf"],[1,"ui","active","dimmer","h-100","w-100"],[1,"ui","active","huge","text","inverted","loader"],[1,"ui","main","container","mb-4","mt-4"],[1,"ui","card","fluid"],[1,"content"],["class","right floated meta",4,"ngIf"],[1,"header"],[1,"ui","dividing","sub","header"],["autocomplete","on",1,"ui","form",3,"formGroup","ngSubmit"],[1,"two","equal","width","fields"],[3,"ngClass"],["autocapitalize","words","formControlName","firstName","type","text",3,"readonly"],[4,"ngIf"],["autocapitalize","words","formControlName","lastName","type","text",3,"readonly"],["autocomplete","off","formControlName","username","type","text",3,"readonly","keyup"],[1,"field",3,"ngClass"],["formControlName","email","placeholder","Not set","type","email",3,"readonly"],[1,"field"],["placeholder","Not set","readonly","","type","text",3,"value",4,"ngIf"],["class","ui dropdown selectable","formControlName","idType","name","idType",4,"ngIf"],["formControlName","idNumber","placeholder","Not set","type","text",3,"readonly"],[1,"field","fluid"],["autocapitalize","words","formControlName","line","placeholder","Not set","type","text",3,"readonly"],[1,"three","fields"],[1,"six","wide","field"],["autocapitalize","words","formControlName","city","placeholder","Not set","type","text",3,"readonly"],["autocapitalize","words","formControlName","state","placeholder","Not set","type","text",3,"readonly"],[1,"four","wide","field",3,"ngClass"],["formControlName","postalCode","placeholder","Not set","type","text",3,"readonly"],[1,"ui","two","equal","width","fields"],["class","ui dropdown selection share-tel mr-2  mb-0 h6","formControlName","countryCode",4,"ngIf"],[1,"ui","left","labeled","input"],[1,"ui","olive","label"],["readonly","","type","tel",3,"value",4,"ngIf"],["formControlName","telephone","type","tel",3,"keyup",4,"ngIf"],["class","ui right floated violet button",3,"click",4,"ngIf"],["class","ui right floated red button",3,"click",4,"ngIf"],["class","ui right floated blue button","type","submit",4,"ngIf"],[1,"right","floated","meta"],["matTooltip","Modifier",1,"violet","large","edit","outline","icon","cursor-pointer",3,"click"],["class","invalid-message",4,"ngIf"],[1,"invalid-message"],["placeholder","Not set","readonly","","type","text",3,"value"],["formControlName","idType","name","idType",1,"ui","dropdown","selectable"],["selected","",3,"value"],["value","CNI"],["value","password"],["formControlName","countryCode",1,"ui","dropdown","selection","share-tel","mr-2","mb-0","h6"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["readonly","","type","tel",3,"value"],["formControlName","telephone","type","tel",3,"keyup"],[1,"ui","right","floated","violet","button",3,"click"],[1,"ui","right","floated","red","button",3,"click"],["type","submit",1,"ui","right","floated","blue","button"]],template:function(e,t){1&e&&(m.bd(0,Ve,3,0,"div",0),m.bd(1,gt,82,55,"div",1)),2&e&&(m.Cc("ngIf",t.loading),m.Kb(1),m.Cc("ngIf",!t.loading))},directives:[n.r,w.z,w.o,w.h,n.p,w.c,w.n,w.f,Le.a,w.w,w.r,w.y,n.q],pipes:[n.o,n.A],styles:[""]}),vt)}],yt=((mt=function e(){_classCallCheck(this,e)}).\u0275mod=m.Wb({type:mt}),mt.\u0275inj=m.Vb({factory:function(e){return new(e||mt)},imports:[[r.g.forChild(Ct)],r.g]}),mt),kt=((pt=function e(){_classCallCheck(this,e)}).\u0275mod=m.Wb({type:pt}),pt.\u0275inj=m.Vb({factory:function(e){return new(e||pt)},providers:[],imports:[[n.c,yt,l.f,w.i,Le.b,w.u]]}),pt)}}]);