{"version":3,"file":"angularx-qrcode.js","sources":["ng:/angularx-qrcode/lib/angularx-qrcode.component.ts","ng:/angularx-qrcode/lib/angularx-qrcode.module.ts","ng:/angularx-qrcode/public-api.ts","ng:/angularx-qrcode/angularx-qrcode.ts"],"names":["QRCode.toDataURL","QRCode.toCanvas","tslib_1.__decorate","tslib_1.__param"],"mappings":"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","sourcesContent":["import {\n  AfterViewInit,\n  ChangeDetectionStrategy,\n  Component,\n  ElementRef,\n  Inject,\n  Input,\n  OnChanges,\n  PLATFORM_ID,\n  Renderer2,\n  ViewChild,\n} from '@angular/core';\nimport { isPlatformServer } from '@angular/common';\nimport * as QRCode from 'qrcode';\nimport { QRCodeErrorCorrectionLevel, QRCodeVersion, QRCodeElementType } from './types';\n\n@Component({\n  selector: 'qrcode',\n  changeDetection: ChangeDetectionStrategy.OnPush,\n  template: `<div #qrcElement [class]=\"cssClass\"></div>`,\n})\nexport class QRCodeComponent implements OnChanges, AfterViewInit {\n\n  // Deprecated\n  @Input() public colordark: string = '';\n  @Input() public colorlight: string = '';\n  @Input() public level: string = '';\n  @Input() public hidetitle: boolean = false;\n  @Input() public size: number = 0;\n  @Input() public usesvg: boolean = false;\n\n  // Valid for 1.x and 2.x\n  @Input() public allowEmptyString: boolean = false;\n  @Input() public qrdata: string = '';\n\n  // New fields introduced in 2.0.0\n  @Input() public colorDark: string = '#000000ff';\n  @Input() public colorLight: string = '#ffffffff';\n  @Input() public cssClass: string = 'qrcode';\n  @Input() public elementType: keyof typeof QRCodeElementType = 'canvas';\n  @Input() public errorCorrectionLevel: keyof typeof QRCodeErrorCorrectionLevel = 'M';\n  @Input() public margin: number = 4;\n  @Input() public scale: number = 4;\n  @Input() public version: QRCodeVersion;\n  @Input() public width: number = 10;\n\n  @ViewChild('qrcElement', { static: true }) public qrcElement: ElementRef;\n\n  public qrcode: any = null;\n\n  constructor(\n    private renderer: Renderer2,\n    @Inject(PLATFORM_ID) private readonly platformId: any,\n  ) {\n    // Deprectation warnings\n    if (this.colordark !== '') {\n      console.warn('[angularx-qrcode] colordark is deprecated, use colorDark.');\n    }\n    if (this.colorlight !== '') {\n      console.warn('[angularx-qrcode] colorlight is deprecated, use colorLight.');\n    }\n    if (this.level !== '') {\n      console.warn('[angularx-qrcode] level is deprecated, use errorCorrectionLevel.');\n    }\n    if (this.hidetitle !== false) {\n      console.warn('[angularx-qrcode] hidetitle is deprecated.');\n    }\n    if (this.size !== 0) {\n      console.warn('[angularx-qrcode] size is deprecated, use `width`. Defaults to 10.');\n    }\n    if (this.usesvg !== false) {\n      console.warn(`[angularx-qrcode] usesvg is deprecated, use [elementType]=\"'img'\".`);\n    }\n  }\n\n  public ngAfterViewInit() {\n    if (isPlatformServer(this.platformId)) {\n      return;\n    }\n    // if (!QRCode) {\n    //   QRCode = require('qrcode');\n    // }\n    this.createQRCode();\n  }\n\n  public ngOnChanges() {\n    this.createQRCode();\n  }\n\n  protected isValidQrCodeText = (data: string | null): boolean => {\n    if (this.allowEmptyString === false) {\n      return !(typeof data === 'undefined' || data === '' || data === 'null');\n    }\n    return !(typeof data === 'undefined');\n  }\n\n  private toDataURL() {\n    return new Promise((resolve: (arg: any) => any, reject: (arg: any) => any) => {\n      QRCode.toDataURL(this.qrdata,\n        {\n          color: {\n            dark: this.colorDark,\n            light: this.colorLight\n          },\n          errorCorrectionLevel: this.errorCorrectionLevel,\n          margin: this.margin,\n          scale: this.scale,\n          version: this.version,\n          width: this.width,\n        }, (err, url) => {\n          if (err) {\n            reject(err);\n          } else {\n            resolve(url);\n          }\n        });\n    });\n  }\n\n  private toCanvas(canvas: Element) {\n    return new Promise((resolve: (arg: any) => any, reject: (arg: any) => any) => {\n      QRCode.toCanvas(canvas, this.qrdata, {\n        color: {\n          dark: this.colorDark,\n          light: this.colorLight\n        },\n        errorCorrectionLevel: this.errorCorrectionLevel,\n        margin: this.margin,\n        scale: this.scale,\n        version: this.version,\n        width: this.width,\n      }, (error) => {\n        if (error) {\n          reject(error);\n        } else {\n          resolve('success');\n        }\n      });\n    });\n  }\n\n  private renderElement(element: Element) {\n    for (const node of this.qrcElement.nativeElement.childNodes) {\n      this.renderer.removeChild(this.qrcElement.nativeElement, node);\n    }\n    this.renderer.appendChild(this.qrcElement.nativeElement, element);\n  }\n\n  private createQRCode() {\n\n    // Set sensitive defaults\n    if (this.version && this.version > 40) {\n      console.warn('[angularx-qrcode] max value for `version` is 40');\n      this.version = 40;\n    } else if (this.version && this.version < 1) {\n      console.warn('[angularx-qrcode]`min value for `version` is 1');\n      this.version = 1;\n    } else if (this.version !== undefined && isNaN(this.version)) {\n      console.warn('[angularx-qrcode] version should be a number, defaulting to auto');\n      this.version = undefined;\n    }\n\n    try {\n      if (!this.isValidQrCodeText(this.qrdata)) {\n        throw new Error('[angularx-qrcode] Field `qrdata` is empty');\n      }\n\n      let element: Element;\n\n      switch (this.elementType) {\n        case 'canvas':\n          element = this.renderer.createElement('canvas');\n          this.toCanvas(element).then(() => {\n            this.renderElement(element);\n          }).catch((e) => {\n            console.error('[angularx-qrcode] error: ', e);\n          });\n          break;\n        // case 'svg':\n        //   break;\n        case 'url':\n        case 'img':\n        default:\n          element = this.renderer.createElement('img');\n          this.toDataURL().then((dataUrl: string) => {\n            element.setAttribute('src', dataUrl);\n            this.renderElement(element);\n          }).catch((e) => {\n            console.error('[angularx-qrcode] error: ', e);\n          });\n      }\n\n    } catch (e) {\n      console.error('[angularx-qrcode] Error generating QR Code: ', e.message);\n    }\n\n  }\n\n}\n","import { NgModule } from '@angular/core';\nimport { QRCodeComponent } from './angularx-qrcode.component';\n\n@NgModule({\n  providers: [],\n  declarations: [\n    QRCodeComponent,\n  ],\n  exports: [\n    QRCodeComponent,\n  ]\n})\nexport class QRCodeModule { }\n","/*\n * Public API Surface of angularx-qrcode\n */\n\nexport { QRCodeComponent } from './lib/angularx-qrcode.component';\nexport { QRCodeModule } from './lib/angularx-qrcode.module';\nexport * from './lib/types';\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './public-api';\n"]}